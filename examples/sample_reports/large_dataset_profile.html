<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Data Quality Report - transactions.csv</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/wordcloud@1.2.2/src/wordcloud2.min.js" defer></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            /* ═══════════════════════════════════════════════════════════════
               DARK-ONLY DESIGN TOKENS (v3)
               Single theme - no light mode, no toggle
            ═══════════════════════════════════════════════════════════════ */

            /* Core backgrounds - deep navy/slate palette */
            --dq-color-bg: #020617;
            --dq-color-bg-alt: #020617;
            --dq-color-surface: #0b1120;
            --dq-color-surface-alt: #111827;

            /* Legacy compatibility aliases */
            --bg-main: var(--dq-color-bg);
            --bg-elevated: var(--dq-color-surface);
            --bg-card: linear-gradient(180deg, var(--dq-color-surface) 0%, var(--dq-color-bg) 100%);
            --bg-hover: #1e293b;
            --bg-tertiary: #151d30;
            --card-bg: var(--dq-color-surface);

            /* Borders */
            --dq-color-border-subtle: #1f2937;
            --dq-color-border-strong: #374151;
            --border-subtle: rgba(148, 163, 184, 0.08);
            --border-color: rgba(148, 163, 184, 0.15);
            --border-focus: rgba(96, 165, 250, 0.4);

            /* Text colors */
            --dq-color-text-main: #e5e7eb;
            --dq-color-text-muted: #9ca3af;
            --dq-color-text-subtle: #6b7280;
            --dq-color-text-inverse: #020617;
            --text-primary: var(--dq-color-text-main);
            --text-secondary: #94a3b8;
            --text-tertiary: #64748b;
            --text-muted: var(--dq-color-text-subtle);

            /* Accent colors */
            --dq-color-accent: #60a5fa;
            --dq-color-accent-soft: rgba(37, 99, 235, 0.18);
            --dq-color-accent-strong: #3b82f6;
            --accent: var(--dq-color-accent);
            --accent-soft: var(--dq-color-accent-soft);
            --accent-gradient: linear-gradient(135deg, #3b82f6, #8b5cf6);
            --primary: #8b5cf6;

            /* Status colors */
            --dq-color-good: #22c55e;
            --dq-color-good-soft: rgba(34, 197, 94, 0.18);
            --dq-color-caution: #fbbf24;
            --dq-color-caution-soft: rgba(251, 191, 36, 0.18);
            --dq-color-danger: #f97373;
            --dq-color-danger-soft: rgba(248, 113, 113, 0.20);
            --good: var(--dq-color-good);
            --good-soft: var(--dq-color-good-soft);
            --warning: var(--dq-color-caution);
            --warning-soft: var(--dq-color-caution-soft);
            --critical: var(--dq-color-danger);
            --critical-soft: var(--dq-color-danger-soft);
            --info: var(--dq-color-accent-strong);
            --info-soft: rgba(59, 130, 246, 0.12);

            /* Shadows */
            --dq-shadow-soft: 0 1px 3px rgba(15, 23, 42, 0.50);
            --dq-shadow-medium: 0 8px 16px rgba(15, 23, 42, 0.70);
            --shadow-card: var(--dq-shadow-medium);
            --shadow-glow: 0 0 40px rgba(96, 165, 250, 0.08);

            /* Border radius */
            --dq-radius-sm: 4px;
            --dq-radius-md: 8px;
            --dq-radius-lg: 12px;
            --radius-sm: var(--dq-radius-sm);
            --radius-md: var(--dq-radius-md);
            --radius-lg: var(--dq-radius-lg);
            --radius-xl: 20px;

            /* Spacing */
            --dq-space-1: 4px;
            --dq-space-2: 8px;
            --dq-space-3: 12px;
            --dq-space-4: 16px;
            --dq-space-5: 20px;
            --dq-space-6: 24px;

            /* Typography */
            --dq-font-family-sans: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            --dq-font-size-xs: 11px;
            --dq-font-size-sm: 13px;
            --dq-font-size-md: 15px;
            --dq-font-size-lg: 18px;
            --dq-font-size-xl: 22px;
            --dq-line-height-tight: 1.15;
            --dq-line-height-normal: 1.4;
            --dq-line-height-relaxed: 1.6;

            /* Transitions */
            --transition-fast: 0.15s ease-out;
            --transition-med: 0.25s ease-out;

            /* Layout */
            --dq-sidebar-width: 260px;
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: radial-gradient(ellipse at top left, #111827 0%, #030712 50%, #030712 100%);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.5;
        }

        .top-nav {
            background: rgba(11, 16, 32, 0.85);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border-subtle);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .top-inner {
            max-width: 1600px;
            margin: 0 auto;
            padding: 14px 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 24px;
            flex-wrap: wrap;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 14px;
        }

        .brand-mark {
            width: 42px;
            height: 42px;
            background: var(--accent-gradient);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.1em;
            color: #fff;
            box-shadow: 0 4px 16px rgba(59, 130, 246, 0.3);
        }

        .brand-text {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .brand-text span:first-child {
            font-weight: 700;
            font-size: 1.05em;
            color: var(--text-primary);
        }

        .brand-text span:last-child {
            font-size: 0.75em;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .file-meta {
            display: flex;
            align-items: center;
            gap: 20px;
            font-size: 0.85em;
            color: var(--text-secondary);
            flex-wrap: wrap;
        }

        .file-name-pill {
            background: var(--accent-soft);
            color: var(--accent);
            padding: 6px 14px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85em;
            border: 1px solid rgba(96, 165, 250, 0.2);
        }

        .pill-dot {
            display: inline-block;
            width: 6px;
            height: 6px;
            background: var(--text-muted);
            border-radius: 50%;
            margin-right: 8px;
        }

        .page {
            max-width: 1600px;
            margin: 0 auto;
            padding: 32px;
        }

        .page-header {
            margin-bottom: 32px;
        }

        .page-title-block h1 {
            font-size: 1.4em;
            font-weight: 700;
            margin-bottom: 6px;
            background: linear-gradient(135deg, #f1f5f9 0%, #94a3b8 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .page-title-block p {
            color: var(--text-secondary);
            font-size: 0.95em;
        }

        /* Elegant Expandable Section Accordions */
        .section-accordion {
            margin: 24px 0;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid var(--border-subtle);
            background: var(--bg-card);
        }
        .section-accordion-header {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px 20px;
            background: linear-gradient(135deg, var(--bg-card) 0%, rgba(30,41,59,0.95) 100%);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: background 0.2s ease;
        }
        .section-accordion-header:hover {
            background: linear-gradient(135deg, rgba(51,65,85,0.5) 0%, rgba(30,41,59,1) 100%);
        }
        .section-accordion-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--section-accent, #3b82f6);
        }
        .section-accordion-header::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 200px;
            height: 100%;
            background: linear-gradient(90deg, transparent 0%, var(--section-accent, #3b82f6) 100%);
            opacity: 0.06;
            pointer-events: none;
        }
        .section-accordion-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--section-accent, #3b82f6) 0%, var(--section-accent-dark, #1d4ed8) 100%);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            flex-shrink: 0;
        }
        .section-accordion-icon svg {
            width: 20px;
            height: 20px;
            color: white;
        }
        .section-accordion-content-wrap {
            flex: 1;
            min-width: 0;
        }
        .section-accordion-title {
            margin: 0;
            font-size: 1.05em;
            font-weight: 600;
            color: var(--text-primary);
        }
        .section-accordion-subtitle {
            margin: 3px 0 0 0;
            font-size: 0.8em;
            color: var(--text-muted);
        }
        .section-accordion-meta {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .section-accordion-badge {
            background: rgba(255,255,255,0.06);
            padding: 5px 12px;
            border-radius: 6px;
            font-size: 0.7em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--section-accent, #3b82f6);
            border: 1px solid rgba(255,255,255,0.08);
        }
        .section-accordion-chevron {
            color: var(--text-muted);
            font-size: 0.9em;
            transition: transform 0.3s ease;
        }
        .section-accordion.expanded .section-accordion-chevron {
            transform: rotate(180deg);
        }
        .section-accordion-content {
            /* Safari-compatible hide/show using height + overflow */
            max-height: 0;
            overflow: hidden;
            padding: 0 20px;
            padding-left: 24px;
            background: rgba(15,23,42,0.3);
            border-top: 1px solid var(--border-subtle);
            border-left: 4px solid var(--section-accent, #3b82f6);
            margin-left: 0;
            opacity: 0;
            visibility: hidden;
            transition: max-height 0.3s ease-out, opacity 0.2s ease-out, padding 0.2s ease-out, visibility 0s linear 0.3s;
        }
        .section-accordion.expanded .section-accordion-content {
            max-height: none;
            overflow: visible;
            padding: 20px;
            padding-left: 24px;
            opacity: 1;
            visibility: visible;
            transition: max-height 0.3s ease-out, opacity 0.2s ease-out, padding 0.2s ease-out, visibility 0s linear 0s;
        }

        .kpi-belt {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 32px;
        }

        @media (max-width: 768px) {
            .kpi-belt {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .kpi-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-lg);
            padding: 20px;
            text-align: center;
        }

        .kpi-label {
            font-size: 0.75em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-muted);
            margin-bottom: 8px;
        }

        .kpi-value {
            font-size: 1.5em;
            font-weight: 700;
            color: var(--text-primary);
        }

        .kpi-value.critical {
            color: var(--critical);
        }

        .kpi-trend {
            font-size: 0.75em;
            margin-top: 8px;
        }

        .kpi-trend.good { color: var(--good); }
        .kpi-trend.warning { color: var(--warning); }
        .kpi-trend.critical { color: var(--critical); }

        .sampling-bar {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-lg);
            padding: 16px 24px;
            margin-bottom: 24px;
            display: flex;
            flex-wrap: wrap;
            gap: 24px;
            align-items: center;
        }

        .sampling-bar-title {
            font-weight: 600;
            color: var(--text-primary);
        }

        .sampling-stat {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .sampling-stat-label {
            font-size: 0.7em;
            text-transform: uppercase;
            color: var(--text-muted);
        }

        .sampling-stat-value {
            font-size: 0.9em;
            color: var(--text-secondary);
        }

        .sampling-stat-value.highlight {
            color: var(--accent);
            font-weight: 600;
        }

        .hint-box {
            background: var(--bg-elevated);
            border-left: 3px solid var(--accent);
            padding: 12px 16px;
            border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
            font-size: 0.82em;
            color: var(--text-secondary);
            margin-bottom: 16px;
        }

        /* FIBO Section Styles */
        .fibo-section {
            background: linear-gradient(135deg, #1e1b4b 0%, var(--bg-card) 100%);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin: 16px 0;
        }

        .fibo-header {
            display: flex;
            align-items: center;
            gap: 14px;
            margin-bottom: 16px;
        }

        .fibo-icon {
            font-size: 2em;
        }

        .fibo-title h3 {
            color: #c4b5fd;
            font-size: 1.1em;
            margin: 0;
        }

        .fibo-title p {
            color: var(--text-muted);
            font-size: 0.85em;
            margin: 2px 0 0 0;
        }

        .fibo-content {
            font-size: 0.9em;
        }

        .fibo-description {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 16px;
        }

        .fibo-description strong {
            color: #a5b4fc;
        }

        .fibo-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
            margin-bottom: 16px;
        }

        .fibo-stat {
            background: var(--bg-elevated);
            padding: 14px;
            border-radius: var(--radius-md);
            text-align: center;
        }

        .fibo-stat-value {
            font-size: 1.2em;
            font-weight: 600;
            color: #c4b5fd;
        }

        .fibo-stat-label {
            font-size: 0.75em;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: 4px;
        }

        .fibo-stat-note {
            font-size: 0.7em;
            color: var(--text-muted);
            margin-top: 2px;
        }

        .fibo-categories {
            margin-bottom: 8px;
        }

        .fibo-categories-label {
            font-size: 0.8em;
            color: var(--text-muted);
            margin-right: 8px;
        }

        .fibo-category-tag {
            display: inline-block;
            background: rgba(139, 92, 246, 0.15);
            color: #c4b5fd;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8em;
            margin: 2px;
        }

        .layout-grid {
            display: block;
            max-width: 100%;
            overflow: hidden;
        }

        .main-column {
            min-width: 0;
        }

        /* Quality Alerts */
        .quality-alert-item {
            display: grid;
            grid-template-columns: auto auto 1fr;
            gap: 12px;
            padding: 10px 14px;
            border-radius: var(--radius-sm);
            align-items: center;
            font-size: 0.9em;
        }

        .quality-alert-item.critical {
            background: rgba(239, 68, 68, 0.1);
            border-left: 3px solid var(--critical);
        }

        .quality-alert-item.warning {
            background: rgba(245, 158, 11, 0.08);
            border-left: 3px solid var(--warning);
        }

        .quality-alert-item.info {
            background: rgba(59, 130, 246, 0.08);
            border-left: 3px solid var(--info);
        }

        .alert-icon { font-size: 1.1em; }
        .alert-column { font-weight: 600; color: var(--text-primary); min-width: 100px; }
        .alert-issue { color: var(--text-secondary); font-weight: 500; }
        .alert-detail { color: var(--text-muted); font-size: 0.9em; grid-column: 2 / -1; }

        @media (max-width: 768px) {
            .quality-alert-item {
                grid-template-columns: auto 1fr;
            }
            .alert-detail {
                grid-column: 1 / -1;
                margin-top: 4px;
            }
        }

        /* CSV Format Warning Banner */
        .csv-format-warning {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.12), rgba(239, 68, 68, 0.08));
            border: 1px solid rgba(245, 158, 11, 0.4);
            border-left: 4px solid #f59e0b;
            border-radius: var(--radius-md);
            padding: 16px 20px;
            margin-bottom: 20px;
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .csv-format-warning-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }
        .csv-format-warning-header svg {
            width: 20px;
            height: 20px;
            color: #f59e0b;
            flex-shrink: 0;
        }
        .csv-format-warning-title {
            font-weight: 600;
            color: #f59e0b;
            font-size: 1em;
        }
        .csv-format-warning-body {
            color: var(--text-secondary);
            font-size: 0.9em;
            line-height: 1.5;
        }
        .csv-format-warning-details {
            margin-top: 12px;
            padding: 12px;
            background: rgba(0, 0, 0, 0.15);
            border-radius: var(--radius-sm);
            font-family: monospace;
            font-size: 0.85em;
        }
        .csv-format-warning-row {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        .csv-format-warning-row:last-child {
            border-bottom: none;
        }
        .csv-format-warning-row-label {
            color: var(--text-muted);
        }
        .csv-format-warning-row-value {
            color: var(--text-primary);
        }
        .csv-format-warning-issues {
            margin-top: 10px;
        }
        .csv-format-warning-issue {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            padding: 6px 0;
            color: var(--text-secondary);
            font-size: 0.9em;
        }
        .csv-format-warning-issue-icon {
            color: #ef4444;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .accordion {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-lg);
            margin-bottom: 16px;
            overflow: hidden;
        }

        .accordion-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            cursor: pointer;
            transition: background var(--transition-fast);
        }

        .accordion-header:hover {
            background: var(--bg-hover);
        }

        .accordion-title-group {
            display: flex;
            align-items: center;
            gap: 14px;
        }

        .accordion-icon {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1em;
            color: white;
        }
        .accordion-icon svg {
            width: 20px;
            height: 20px;
        }

        .accordion-icon.overview { background: var(--info-soft); }
        .accordion-icon.quality { background: var(--good-soft); }
        .accordion-icon.columns { background: var(--accent-soft); }
        .accordion-icon.issues { background: var(--critical-soft); }
        .accordion-icon.ml { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .accordion-icon.semantics { background: linear-gradient(135deg, #8b5cf6, #3b82f6); }

        .accordion-title {
            font-weight: 600;
            color: var(--text-primary);
        }

        .accordion-subtitle {
            font-size: 0.8em;
            color: var(--text-muted);
        }

        .accordion-meta {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .accordion-badge {
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.7em;
            font-weight: 600;
            text-transform: uppercase;
        }

        .accordion-badge.good { background: var(--good-soft); color: var(--good); }
        .accordion-badge.warning { background: var(--warning-soft); color: var(--warning); }
        .accordion-badge.critical { background: var(--critical-soft); color: var(--critical); }
        .accordion-badge.info { background: var(--info-soft); color: var(--info); }

        .accordion-chevron {
            color: var(--text-muted);
            transition: transform var(--transition-fast);
        }

        .accordion.open .accordion-chevron {
            transform: rotate(180deg);
        }

        /* Accordion content - visible by default, hidden when collapsed */
        .accordion-body {
            display: block;
            border-top: 1px solid var(--border-subtle);
        }

        .accordion > .accordion-content {
            display: block;
            border-top: 1px solid var(--border-subtle);
        }

        /* Hide content when accordion has 'collapsed' class - Safari compatible */
        .accordion.collapsed .accordion-body {
            height: 0;
            overflow: hidden;
            padding: 0;
            border-top: none;
        }

        .accordion.collapsed > .accordion-content {
            height: 0;
            overflow: hidden;
            padding: 0;
            border-top: none;
        }

        .accordion.collapsed .accordion-chevron {
            transform: rotate(-90deg);
        }

        .accordion-content {
            padding: 20px;
        }

        .overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .overview-stat {
            background: var(--bg-elevated);
            padding: 16px;
            border-radius: var(--radius-md);
        }

        .overview-stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .overview-stat-label {
            font-size: 0.8em;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        .overview-stat-value {
            font-size: 1.5em;
            font-weight: 700;
            color: var(--text-primary);
        }

        .overview-stat-bar {
            height: 6px;
            background: var(--bg-main);
            border-radius: 3px;
            overflow: hidden;
            margin-top: 8px;
        }

        .overview-stat-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.5s ease;
        }

        .overview-stat-fill.good { background: var(--good); }
        .overview-stat-fill.warning { background: var(--warning); }
        .overview-stat-fill.critical { background: var(--critical); }

        .overview-stat-hint {
            font-size: 0.75em;
            color: var(--text-muted);
            margin-top: 8px;
        }

        .chart-container {
            background: var(--bg-elevated);
            padding: 20px;
            border-radius: var(--radius-md);
            margin-bottom: 16px;
            overflow: hidden;
            position: relative;
        }
        .chart-container canvas {
            max-width: 100%;
            height: auto !important;
        }

        .chart-title {
            font-size: 0.9em;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 16px;
        }

        .column-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .column-row {
            background: var(--bg-elevated);
            border-radius: var(--radius-md);
            overflow: hidden;
        }

        .column-row-header {
            display: grid;
            grid-template-columns: auto auto 1fr auto auto auto;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            cursor: pointer;
            transition: background var(--transition-fast);
        }

        @media (min-width: 1200px) {
            .column-row-header {
                grid-template-columns: auto auto minmax(200px, 1fr) minmax(150px, auto) minmax(200px, auto) auto;
            }
        }

        @media (max-width: 768px) {
            .column-row-header {
                grid-template-columns: auto auto 1fr auto;
                grid-template-rows: auto auto auto auto;
                padding: 12px;
            }
            .column-quick-stats {
                grid-column: 3 / -1;
                grid-row: 2;
                justify-self: start;
            }
            .column-tags {
                grid-column: 1 / -1;
                grid-row: 3;
                margin-top: 8px;
                padding-top: 8px;
                border-top: 1px solid var(--border-subtle);
            }
            .column-quality-score {
                grid-column: 1 / -1;
                grid-row: 4;
                justify-self: end;
                margin-top: 8px;
            }
            .column-tag {
                font-size: 0.7em;
                padding: 4px 10px;
            }
            .column-tag.fibo {
                font-size: 0.65em;
                max-width: 100%;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }
        }

        .column-row-header:hover {
            background: var(--bg-hover);
        }

        .column-expand-icon {
            color: var(--text-muted);
            font-size: 0.7em;
            transition: transform var(--transition-fast);
        }

        .column-row.expanded .column-expand-icon {
            transform: rotate(90deg);
        }

        .column-type-icon {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9em;
        }

        .column-type-icon.string { background: rgba(139, 92, 246, 0.2); }
        .column-type-icon.number { background: rgba(59, 130, 246, 0.2); }
        .column-type-icon.date { background: rgba(245, 158, 11, 0.2); }

        .column-info {
            flex: 1;
            min-width: 0;
        }

        .column-name {
            font-weight: 600;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .column-type {
            font-size: 0.75em;
            color: var(--text-muted);
        }

        .column-quick-stats {
            display: flex;
            gap: 16px;
            font-size: 0.75em;
            color: var(--text-secondary);
        }

        .column-tags {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .column-tag {
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.65em;
            font-weight: 600;
            text-transform: uppercase;
        }

        .column-tag.pii { background: var(--critical-soft); color: var(--critical); }
        .column-tag.temporal { background: var(--warning-soft); color: var(--warning); }
        .column-tag.semantic { background: var(--info-soft); color: var(--info); }
        .column-tag.sparse { background: rgba(239, 68, 68, 0.2); color: #f87171; border: 1px solid rgba(239, 68, 68, 0.4); }
        .column-tag.incomplete { background: rgba(245, 158, 11, 0.15); color: #fbbf24; }
        .column-tag.duplicate-risk { background: rgba(168, 85, 247, 0.15); color: #c084fc; }
        .column-tag.fibo {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.15) 0%, rgba(59, 130, 246, 0.15) 100%);
            color: #7c3aed;
            border: 1px solid rgba(139, 92, 246, 0.3);
        }
        .column-tag.fibo .fibo-icon { margin-right: 4px; }
        .column-tag.fibo-domain {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
            font-size: 0.6em;
        }

        .column-quality-score {
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: 600;
        }

        .column-quality-score.good { background: var(--good-soft); color: var(--good); }
        .column-quality-score.warning { background: var(--warning-soft); color: var(--warning); }
        .column-quality-score.critical { background: var(--critical-soft); color: var(--critical); }

        .column-details {
            display: none;
            border-top: 1px solid var(--border-subtle);
        }

        .column-row.expanded .column-details {
            display: block;
        }

        .column-details-content {
            padding: 16px;
        }

        .column-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 12px;
        }

        .column-stat {
            background: var(--bg-main);
            padding: 10px;
            border-radius: var(--radius-sm);
        }

        .column-stat-label {
            font-size: 0.7em;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        .column-stat-value {
            font-size: 0.9em;
            color: var(--text-primary);
            font-weight: 500;
        }

        .top-values-section {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--border-subtle);
        }

        .top-values-title {
            font-size: 0.75em;
            color: var(--text-muted);
            text-transform: uppercase;
            margin-bottom: 8px;
        }

        .top-values-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 6px;
        }

        .top-value-item {
            background: var(--bg-main);
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            display: flex;
            justify-content: space-between;
            font-size: 0.8em;
        }

        .top-value-name {
            color: var(--text-secondary);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: 100px;
        }

        .top-value-count {
            color: var(--text-muted);
        }

        .sampled-note {
            font-size: 0.7em;
            color: var(--text-muted);
            font-style: italic;
            margin-top: 6px;
        }

        .suggestion-card {
            background: var(--bg-elevated);
            border-radius: var(--radius-md);
            padding: 16px;
            margin-bottom: 12px;
            border-left: 3px solid var(--info);
        }

        .suggestion-card.high-priority {
            border-left-color: #8b5cf6;
        }

        .suggestion-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .suggestion-type {
            font-weight: 600;
            color: var(--text-primary);
        }

        .suggestion-confidence {
            font-size: 0.75em;
            color: var(--text-muted);
        }

        .suggestion-reason {
            font-size: 0.85em;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .suggestion-field {
            font-size: 0.8em;
            color: var(--text-muted);
            margin-bottom: 6px;
            padding: 4px 8px;
            background: var(--bg-card);
            border-radius: var(--radius-sm);
            display: inline-block;
        }

        .suggestion-field strong {
            color: var(--accent);
        }

        .suggestion-yaml-container {
            display: flex;
            gap: 8px;
            align-items: flex-start;
            margin-top: 8px;
        }

        .suggestion-yaml {
            flex: 1;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            padding: 10px 12px;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
            font-size: 0.75em;
            color: var(--text-secondary);
            margin: 0;
            white-space: pre-wrap;
            word-break: break-word;
            overflow-x: auto;
        }

        .copy-yaml-btn {
            background: var(--accent-soft);
            color: var(--accent);
            border: 1px solid rgba(96, 165, 250, 0.3);
            padding: 6px 12px;
            border-radius: var(--radius-sm);
            font-size: 0.75em;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .copy-yaml-btn:hover {
            background: var(--accent);
            color: #fff;
        }

        /* Full Config Section */
        .full-config-container {
            margin-top: 12px;
        }

        .config-actions {
            margin-bottom: 10px;
        }

        .copy-config-btn {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: #fff;
            border: none;
            padding: 10px 20px;
            border-radius: var(--radius-md);
            font-size: 0.85em;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .copy-config-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .full-config-yaml {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 16px;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
            font-size: 0.8em;
            color: var(--text-secondary);
            margin: 0;
            white-space: pre;
            overflow-x: auto;
            max-height: 500px;
            overflow-y: auto;
        }

        .pii-risk-card {
            background: var(--critical-soft);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: var(--radius-md);
            padding: 16px;
            margin-bottom: 16px;
        }

        .pii-risk-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .pii-risk-score {
            font-size: 1.5em;
            font-weight: 700;
            color: var(--critical);
        }

        .pii-risk-level {
            font-size: 0.85em;
            color: var(--critical);
        }

        .pii-column-item {
            background: var(--bg-elevated);
            padding: 12px;
            border-radius: var(--radius-sm);
            margin-top: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .pii-column-name {
            font-weight: 600;
            color: var(--text-primary);
        }

        .pii-type-badge {
            background: var(--critical-soft);
            color: var(--critical);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.7em;
            font-weight: 600;
        }

        .pii-frameworks {
            display: flex;
            gap: 6px;
        }

        .pii-framework-tag {
            background: var(--warning-soft);
            color: var(--warning);
            padding: 2px 6px;
            border-radius: 6px;
            font-size: 0.65em;
            font-weight: 600;
        }

        /* ML Analysis Section Styles */
        .beta-badge {
            background: linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%);
            color: white;
            font-size: 0.6em;
            padding: 2px 6px;
            border-radius: 4px;
            margin-left: 8px;
            font-weight: 600;
            vertical-align: middle;
        }

        .accordion-icon.ml {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, rgba(99, 102, 241, 0.1) 100%);
            color: #8b5cf6;
        }

        .ml-summary-card {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, rgba(99, 102, 241, 0.05) 100%);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 20px;
        }

        .ml-summary-header {
            text-align: center;
            margin-bottom: 16px;
        }

        .ml-summary-count {
            font-size: 1.6em;
            font-weight: 700;
            color: #8b5cf6;
            line-height: 1;
        }

        .ml-summary-label {
            font-size: 0.9em;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        .ml-findings-list {
            border-top: 1px solid rgba(139, 92, 246, 0.15);
            padding-top: 12px;
        }

        .ml-finding-item {
            padding: 8px 0;
            color: var(--text-secondary);
            font-size: 0.9em;
            border-bottom: 1px solid rgba(139, 92, 246, 0.08);
        }

        .ml-finding-item:last-child {
            border-bottom: none;
        }

        .ml-detail-section {
            background: var(--bg-elevated);
            border-radius: var(--radius-md);
            padding: 16px;
            margin-bottom: 16px;
        }

        .ml-detail-header {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
            font-size: 1em;
        }

        .ml-hint {
            background: var(--bg-tertiary);
            border-left: 3px solid #0ea5e9;
            padding: 10px 14px;
            margin-bottom: 12px;
            border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
            font-size: 0.9em;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .ml-hint em {
            font-style: normal;
            font-weight: 600;
            color: #38bdf8;
        }

        /* Collapsible ML hints */
        .ml-hint-collapse {
            margin-bottom: 14px;
        }

        .ml-hint-collapse summary {
            cursor: pointer;
            color: var(--text-secondary);
            font-size: 0.85em;
            padding: 8px 0;
            list-style: none;
        }

        .ml-hint-collapse summary::-webkit-details-marker {
            display: none;
        }

        .ml-hint-collapse summary::before {
            content: '▶ ';
            font-size: 0.7em;
            margin-right: 4px;
            color: var(--text-muted);
        }

        .ml-hint-collapse[open] summary::before {
            content: '▼ ';
        }

        .ml-hint-content {
            background: var(--bg-tertiary);
            border-left: 3px solid #0ea5e9;
            padding: 10px 14px;
            border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
            margin-top: 8px;
            font-size: 0.85em;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .ml-detail-item {
            display: grid;
            grid-template-columns: 150px 100px 1fr;
            gap: 12px;
            padding: 10px;
            background: var(--bg-main);
            border-radius: var(--radius-sm);
            margin-bottom: 8px;
            align-items: center;
        }

        .ml-detail-col {
            color: var(--text-primary);
        }

        .ml-detail-count {
            color: #8b5cf6;
            font-weight: 600;
            font-size: 0.85em;
        }

        .ml-detail-desc {
            color: var(--text-secondary);
            font-size: 0.85em;
        }

        @media (max-width: 768px) {
            .ml-detail-item {
                grid-template-columns: 1fr;
                gap: 6px;
            }
        }

        /* Mobile-friendly sample rows */
        .sample-rows-container {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            max-width: 100%;
        }
        .sample-row-card {
            background: var(--bg-elevated);
            border-radius: 6px;
            padding: 8px 12px;
            margin-bottom: 6px;
            font-size: 11px;
        }
        .sample-row-card div {
            display: flex;
            justify-content: space-between;
            padding: 2px 0;
            border-bottom: 1px solid var(--border);
        }
        .sample-row-card div:last-child {
            border-bottom: none;
        }
        .sample-row-card .field-name {
            color: var(--text-secondary);
            font-weight: 500;
        }
        .sample-row-card .field-value {
            color: var(--text-primary);
            text-align: right;
            word-break: break-all;
        }

        .ml-charts-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }

        .ml-chart-card {
            background: var(--bg-elevated);
            border-radius: var(--radius-md);
            padding: 16px;
        }

        .ml-chart-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
            font-size: 0.9em;
        }

        .ml-chart-container {
            position: relative;
            height: 200px;
        }

        .freshness-content {
            padding: 0;
        }

        .freshness-timeline {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .freshness-item {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .freshness-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

        .freshness-dot.good { background: var(--good); box-shadow: 0 0 8px var(--good); }
        .freshness-dot.warning { background: var(--warning); box-shadow: 0 0 8px var(--warning); }

        .freshness-info {
            flex: 1;
        }

        .freshness-label {
            font-size: 0.75em;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        .freshness-value {
            font-size: 0.9em;
            color: var(--text-primary);
        }

        .column-search {
            margin-bottom: 12px;
        }

        .column-search input {
            width: 100%;
            padding: 10px 14px;
            background: var(--bg-main);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-size: 0.9em;
        }

        .column-search input:focus {
            outline: none;
            border-color: var(--accent);
        }

        /* ======================================================
           SIDEBAR NAVIGATION (v3 Layout)
           ====================================================== */
        .dq-main-layout {
            display: flex;
            min-height: calc(100vh - 60px);
        }

        .dq-sidebar {
            width: var(--dq-sidebar-width);
            flex-shrink: 0;
            background: var(--dq-color-surface);
            border-right: 1px solid var(--dq-color-border-subtle);
            position: sticky;
            top: 60px;
            height: calc(100vh - 60px);
            overflow-y: auto;
            overflow-x: hidden;
            scrollbar-width: thin;
            scrollbar-color: var(--dq-color-border-strong) transparent;
        }

        .dq-sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .dq-sidebar::-webkit-scrollbar-track {
            background: transparent;
        }

        .dq-sidebar::-webkit-scrollbar-thumb {
            background: var(--dq-color-border-strong);
            border-radius: 3px;
        }

        .dq-sidebar-inner {
            padding: var(--dq-space-4);
        }

        .dq-sidebar-section {
            margin-bottom: var(--dq-space-5);
        }

        .dq-sidebar-label {
            font-size: var(--dq-font-size-xs);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--dq-color-text-subtle);
            padding: var(--dq-space-2) var(--dq-space-3);
            margin-bottom: var(--dq-space-1);
        }

        .dq-nav-list {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .dq-nav-item {
            margin: 0;
        }

        .dq-nav-link {
            display: flex;
            align-items: center;
            gap: var(--dq-space-2);
            padding: var(--dq-space-2) var(--dq-space-3);
            color: var(--dq-color-text-muted);
            text-decoration: none;
            font-size: var(--dq-font-size-sm);
            border-radius: var(--dq-radius-sm);
            transition: all var(--transition-fast);
            cursor: pointer;
            border: none;
            background: transparent;
            width: 100%;
            text-align: left;
        }

        .dq-nav-link:hover {
            background: var(--bg-hover);
            color: var(--dq-color-text-main);
        }

        .dq-nav-link.active {
            background: var(--dq-color-accent-soft);
            color: var(--dq-color-accent);
            font-weight: 500;
        }

        .dq-nav-link.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 3px;
            height: 16px;
            background: var(--dq-color-accent);
            border-radius: 0 2px 2px 0;
        }

        .dq-nav-link .nav-icon {
            width: 18px;
            height: 18px;
            opacity: 0.7;
            flex-shrink: 0;
            margin-right: 10px;
        }
        .dq-nav-link:hover .nav-icon,
        .dq-nav-link.active .nav-icon {
            opacity: 1;
        }

        .dq-nav-link .nav-num {
            font-size: var(--dq-font-size-xs);
            color: var(--dq-color-text-subtle);
            width: 18px;
            text-align: right;
            flex-shrink: 0;
        }

        .dq-sidebar-actions {
            padding: var(--dq-space-4);
            border-top: 1px solid var(--dq-color-border-subtle);
            display: flex;
            flex-direction: column;
            gap: var(--dq-space-2);
        }

        .dq-main {
            flex: 1;
            min-width: 0;
            max-width: calc(100% - var(--dq-sidebar-width));
        }

        /* Mobile: hide sidebar, show mobile nav toggle */
        .dq-mobile-nav-toggle {
            display: none;
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--dq-color-accent);
            color: white;
            border: none;
            cursor: pointer;
            box-shadow: var(--dq-shadow-medium);
            font-size: 1.5em;
            align-items: center;
            justify-content: center;
        }

        @media (max-width: 1024px) {
            .dq-sidebar {
                position: fixed;
                left: 0;
                top: 60px;
                z-index: 200;
                transform: translateX(-100%);
                transition: transform var(--transition-med);
            }

            .dq-sidebar.open {
                transform: translateX(0);
            }

            .dq-main {
                max-width: 100%;
            }

            .dq-mobile-nav-toggle {
                display: flex;
            }

            .dq-sidebar-backdrop {
                position: fixed;
                inset: 0;
                top: 60px;
                background: rgba(0, 0, 0, 0.5);
                z-index: 199;
                opacity: 0;
                visibility: hidden;
                transition: all var(--transition-med);
            }

            .dq-sidebar-backdrop.open {
                opacity: 1;
                visibility: visible;
            }
        }

        /* Legacy sticky-nav kept for backwards compatibility but hidden by default */
        .sticky-nav {
            display: none;
        }

        /* Action buttons in sidebar */
        .expand-all-btn {
            background: transparent;
            border: 1px solid var(--border-subtle);
            color: var(--text-muted);
            padding: 8px 12px;
            border-radius: var(--radius-md);
            font-size: var(--dq-font-size-sm);
            font-weight: 400;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.2s ease;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .expand-all-btn:hover {
            border-color: var(--accent);
            color: var(--text-secondary);
            background: var(--bg-hover);
        }

        .expand-all-btn.expanded {
            background: rgba(74, 144, 226, 0.1);
            border-color: var(--accent);
            color: var(--accent);
        }

        .expand-all-btn .expand-icon {
            font-weight: 600;
        }

        .export-pdf-btn {
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
            border: none;
            color: white;
            padding: 8px 14px;
            border-radius: var(--radius-md);
            font-size: var(--dq-font-size-sm);
            font-weight: 500;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            width: 100%;
        }

        .export-pdf-btn:hover {
            background: linear-gradient(135deg, #047857 0%, #059669 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(5, 150, 105, 0.3);
        }

        .export-pdf-btn:active {
            transform: translateY(0);
        }

        .export-pdf-btn.exporting {
            opacity: 0.7;
            pointer-events: none;
        }

        .pdf-icon {
            font-size: 1.1em;
        }

        /* Print/PDF styles */
        @media print {
            .top-nav, .sticky-nav, .export-pdf-btn, .expand-all-btn,
            .dq-sidebar, .dq-sidebar-backdrop, .dq-mobile-nav-toggle {
                display: none !important;
            }
            .dq-main-layout {
                display: block !important;
            }
            .dq-main {
                max-width: 100% !important;
            }
            .page {
                padding: 0 !important;
                margin: 0 !important;
            }
            .accordion, .column-row, details, .insight-technical {
                break-inside: avoid;
            }
            .accordion.open .accordion-content,
            .column-row.expanded .column-details,
            details[open] summary ~ *,
            .insight-technical.open {
                display: block !important;
                max-height: none !important;
                overflow: visible !important;
            }
        }

        /* ======================================================
           EXECUTIVE SUMMARY
           ====================================================== */
        .executive-summary {
            background: linear-gradient(135deg, var(--bg-card) 0%, rgba(74, 144, 226, 0.08) 100%);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-lg);
            padding: 24px;
            margin-bottom: 24px;
            display: grid;
            grid-template-columns: 1fr auto;
            grid-template-rows: auto auto;
            gap: 20px;
        }

        .summary-verdict {
            grid-column: 1 / -1;
            padding: 16px 20px;
            border-radius: var(--radius-md);
            border-left: 4px solid;
        }

        .summary-verdict.good {
            background: rgba(16, 185, 129, 0.1);
            border-left-color: var(--good);
        }

        .summary-verdict.warning {
            background: rgba(251, 191, 36, 0.1);
            border-left-color: var(--warning);
        }

        .summary-verdict.critical {
            background: rgba(239, 68, 68, 0.1);
            border-left-color: var(--critical);
        }

        .verdict-text {
            font-size: 1.25em;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .verdict-detail {
            font-size: 0.9em;
            color: var(--text-secondary);
        }

        .summary-stats {
            display: flex;
            gap: 24px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5em;
            font-weight: 700;
            color: var(--text-primary);
            line-height: 1.2;
        }

        .stat-label {
            font-size: 0.75em;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .priority-actions {
            grid-column: 1;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .actions-header {
            font-size: 0.8em;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .action-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 14px;
            background: var(--bg-main);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.9em;
            transition: all 0.2s ease;
        }

        .action-item:hover {
            background: var(--bg-hover);
            border-color: var(--accent);
            color: var(--text-primary);
        }

        .action-icon {
            font-size: 1.1em;
        }

        .action-text {
            flex: 1;
        }

        .action-arrow {
            color: var(--accent);
            font-weight: bold;
        }

        .summary-tools {
            display: flex;
            align-items: flex-end;
        }

        .export-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: var(--radius-md);
            font-size: 0.9em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .export-btn:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
        }

        /* ======================================================
           EXEC1 COMPACT EXECUTIVE SUMMARY (Reconstructed)
           ====================================================== */
        .exec1-summary-header {
            margin-bottom: 20px;
        }
        .exec1-summary-title {
            font-size: 1.75em;
            font-weight: 400;
            color: var(--text-primary);
            margin: 0 0 6px 0;
        }
        .exec1-summary-top {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }
        .exec1-status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 16px;
            font-size: 0.75em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .exec1-status-badge.complete {
            background: rgba(16, 185, 129, 0.15);
            color: #10b981;
        }
        .exec1-status-badge.sampled {
            background: rgba(59, 130, 246, 0.15);
            color: #3b82f6;
        }
        .exec1-status-badge svg {
            width: 12px;
            height: 12px;
        }

        /* Main Quality Widget - Dial + Breakdown Bars */
        .exec1-quality-widget {
            display: flex;
            gap: 24px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 12px;
        }
        .exec1-quality-dial-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-width: 140px;
        }
        .exec1-quality-dial {
            width: 100px;
            height: 100px;
        }
        .exec1-quality-dial-bg {
            fill: none;
            stroke: rgba(255,255,255,0.08);
            stroke-width: 6;
        }
        .exec1-quality-dial-fill {
            fill: none;
            stroke-width: 6;
            stroke-linecap: round;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
            transition: stroke-dasharray 0.8s ease;
        }
        .exec1-quality-dial-text {
            fill: var(--text-primary);
            font-size: 22px;
            font-weight: 600;
            text-anchor: middle;
            dominant-baseline: middle;
        }
        .exec1-quality-dial-subtext {
            fill: var(--text-muted);
            font-size: 9px;
            font-weight: 500;
            letter-spacing: 1px;
            text-anchor: middle;
        }
        .exec1-quality-dial-label {
            font-size: 0.9em;
            color: var(--text-secondary);
            margin-top: 8px;
            font-weight: 500;
        }

        /* Quality Breakdown Bars */
        .exec1-quality-breakdown {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 10px;
        }
        .exec1-breakdown-item {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .exec1-breakdown-label {
            font-size: 0.85em;
            color: var(--text-secondary);
            min-width: 100px;
        }
        .exec1-breakdown-bar-container {
            flex: 1;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            overflow: hidden;
        }
        .exec1-breakdown-bar {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        .exec1-breakdown-value {
            font-size: 0.85em;
            font-weight: 600;
            color: var(--text-primary);
            min-width: 45px;
            text-align: right;
        }
        .exec1-breakdown-weight {
            font-size: 0.7em;
            color: var(--text-muted);
            min-width: 35px;
        }

        /* Compact Stats Row */
        .exec1-compact-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            align-items: stretch;
        }
        .exec1-compact-stat {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 14px;
        }
        .exec1-compact-value {
            font-size: 1.6em;
            font-weight: 300;
            color: var(--text-primary);
            line-height: 1.1;
        }
        .exec1-compact-label {
            font-size: 0.85em;
            color: var(--text-secondary);
            margin-top: 2px;
        }
        .exec1-compact-meta {
            font-size: 0.7em;
            color: var(--text-muted);
            margin-top: 6px;
        }
        .exec1-compact-pills {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            margin-top: 6px;
        }

        /* Collapsed Info Lines */
        .exec1-info-line {
            margin-top: 6px;
        }
        .exec1-info-line summary {
            font-size: 0.8em;
            color: var(--text-muted);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            list-style: none;
        }
        .exec1-info-line summary::-webkit-details-marker {
            display: none;
        }
        .exec1-info-line summary::after {
            content: '›';
            font-size: 1.2em;
            margin-left: auto;
            opacity: 0.5;
            transition: transform 0.2s, opacity 0.2s;
        }
        .exec1-info-line[open] summary::after {
            transform: rotate(90deg);
            opacity: 0.8;
        }
        .exec1-info-line summary:hover {
            color: var(--text-secondary);
        }
        .exec1-info-line summary:hover::after {
            opacity: 0.8;
        }
        .exec1-info-detail {
            margin-top: 6px;
            padding: 10px 12px;
            background: rgba(255,255,255,0.03);
            border-radius: 6px;
            font-size: 0.8em;
            color: var(--text-secondary);
        }
        .exec1-detail-row {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .exec1-detail-row:last-child {
            border-bottom: none;
        }
        .exec1-detail-label {
            color: var(--text-muted);
            min-width: 70px;
        }
        .exec1-detail-section {
            padding: 6px 0;
            font-size: 0.95em;
            line-height: 1.4;
        }
        .exec1-detail-note {
            padding: 6px 0;
            font-size: 0.85em;
            color: var(--text-muted);
            font-style: italic;
        }

        /* Circular Dial Widgets */
        .exec1-dial-widget {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 10px;
            padding: 14px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .exec1-dial {
            width: 70px;
            height: 70px;
        }
        .exec1-dial-bg {
            fill: none;
            stroke: rgba(255,255,255,0.1);
            stroke-width: 3;
        }
        .exec1-dial-fill {
            fill: none;
            stroke: #3b82f6;
            stroke-width: 3;
            stroke-linecap: round;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
            transition: stroke-dasharray 0.5s ease;
        }
        .exec1-dial-text {
            fill: var(--text-primary);
            font-size: 7px;
            font-weight: 600;
            text-anchor: middle;
        }
        .exec1-dial-label {
            font-size: 0.8em;
            color: var(--text-secondary);
            margin-top: 6px;
            text-align: center;
        }

        /* Responsive - Stack on smaller screens */
        @media (max-width: 768px) {
            .exec1-quality-widget {
                flex-direction: column;
                align-items: center;
            }
            .exec1-quality-dial-section {
                min-width: auto;
            }
            .exec1-breakdown-label {
                min-width: 80px;
            }
            .exec1-compact-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* ======================================================
           COLUMN QUALITY HEATMAP
           ====================================================== */
        .column-heatmap {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-lg);
            padding: 20px;
            margin-bottom: 20px;
        }

        .heatmap-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .heatmap-title {
            font-size: 1em;
            font-weight: 600;
            color: var(--text-primary);
        }

        .heatmap-legend {
            display: flex;
            gap: 16px;
            font-size: 0.8em;
            color: var(--text-muted);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }

        .heatmap-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
            gap: 8px;
        }

        .heatmap-cell {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 10px 6px;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: transform 0.15s ease, box-shadow 0.15s ease;
        }

        .heatmap-cell:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .heatmap-name {
            font-size: 0.75em;
            color: rgba(255,255,255,0.9);
            text-align: center;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: 100%;
        }

        .heatmap-score {
            font-size: 1.1em;
            font-weight: 700;
            color: white;
        }

        .heatmap-good, .legend-dot.heatmap-good { background: linear-gradient(135deg, #10b981, #059669); }
        .heatmap-ok, .legend-dot.heatmap-ok { background: linear-gradient(135deg, #3b82f6, #2563eb); }
        .heatmap-warning, .legend-dot.heatmap-warning { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .heatmap-critical, .legend-dot.heatmap-critical { background: linear-gradient(135deg, #ef4444, #dc2626); }

        /* ======================================================
           COLUMN SEARCH AND FILTER CONTROLS
           ====================================================== */
        .column-controls {
            display: flex;
            gap: 16px;
            margin-bottom: 16px;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-box {
            position: relative;
            flex: 1;
            min-width: 200px;
        }

        .search-input {
            width: 100%;
            padding: 10px 14px 10px 36px;
            background: var(--bg-main);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-size: 0.9em;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            font-size: 0.9em;
        }

        .filter-buttons {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .filter-btn {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            color: var(--text-secondary);
            padding: 8px 12px;
            border-radius: var(--radius-sm);
            font-size: 0.8em;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .filter-btn:hover {
            background: var(--bg-hover);
            border-color: var(--accent);
        }

        .filter-btn.active {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
        }

        .sort-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .sort-select {
            padding: 8px 12px;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            font-size: 0.85em;
            cursor: pointer;
        }

        /* ======================================================
           MOBILE RESPONSIVE STYLES
           ====================================================== */
        @media (max-width: 768px) {
            .page { padding: 16px; }
            .top-inner { padding: 12px 16px; }
            .file-meta { display: none; }
            .column-quick-stats { display: none; }
            .column-tags { display: none; }

            /* Sticky nav adjustments */
            .sticky-nav {
                margin: 0 -16px;
                padding: 0 16px;
                top: 56px;
            }

            .nav-btn {
                padding: 6px 12px;
                font-size: 0.8em;
            }

            /* Executive summary mobile */
            .executive-summary {
                display: flex;
                flex-direction: column;
                padding: 16px;
            }

            .summary-stats {
                flex-wrap: wrap;
                justify-content: space-around;
                gap: 16px;
            }

            .stat-value {
                font-size: 1.25em;
            }

            .priority-actions {
                width: 100%;
            }

            .summary-tools {
                width: 100%;
                justify-content: center;
            }

            .export-btn {
                width: 100%;
            }

            /* Heatmap mobile */
            .heatmap-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .heatmap-grid {
                grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
            }

            .heatmap-cell {
                padding: 8px 4px;
            }

            .heatmap-name {
                font-size: 0.65em;
            }

            .heatmap-score {
                font-size: 0.95em;
            }

            /* Column controls mobile */
            .column-controls {
                flex-direction: column;
                align-items: stretch;
            }

            .search-box {
                width: 100%;
            }

            .filter-buttons {
                justify-content: flex-start;
            }

            .sort-controls {
                width: 100%;
            }

            .sort-select {
                width: 100%;
            }
        }

        /* Tablet adjustments */
        @media (min-width: 769px) and (max-width: 1024px) {
            .executive-summary {
                grid-template-columns: 1fr;
            }

            .summary-tools {
                justify-content: flex-start;
            }
        }

        /* ======================================================
           v2 SAMPLING COVERAGE BANNER
           ====================================================== */
        .sampling-banner {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            border: 1px solid rgba(148, 163, 184, 0.15);
            border-radius: 16px;
            padding: 20px 24px;
            margin-bottom: 24px;
        }

        .sampling-banner-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .sampling-banner-icon {
            font-size: 1.5em;
        }

        .sampling-banner-title {
            font-size: 1em;
            font-weight: 600;
            color: var(--text-primary);
        }

        .sampling-progress-container {
            margin-bottom: 16px;
        }

        .sampling-progress-bar {
            height: 10px;
            background: rgba(30, 41, 59, 0.8);
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .sampling-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6 0%, #8b5cf6 100%);
            border-radius: 5px;
            transition: width 0.5s ease;
        }

        .sampling-progress-label {
            font-size: 0.9em;
            color: var(--text-secondary);
            text-align: center;
        }

        .sampling-progress-label strong {
            color: var(--accent);
        }

        .sampling-methods-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
        }

        .sampling-method {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 14px;
            background: rgba(15, 23, 42, 0.6);
            border-radius: 8px;
            font-size: 0.85em;
        }

        .sampling-method-icon {
            font-size: 1.1em;
        }

        .sampling-method.full .sampling-method-icon { color: #10b981; }
        .sampling-method.sampled .sampling-method-icon { color: #f59e0b; }

        .sampling-method-text {
            color: var(--text-secondary);
        }

        .sampling-method-text strong {
            color: var(--text-primary);
            font-weight: 500;
        }

        /* Sample Size Explanation (Collapsible) */
        .sample-size-explanation {
            margin-top: 16px;
            background: rgba(15, 23, 42, 0.4);
            border-radius: 8px;
            border: 1px solid rgba(148,163,184,0.05);
        }

        .sample-size-summary {
            cursor: pointer;
            padding: 12px 16px;
            font-size: 0.85em;
            color: var(--accent);
            display: flex;
            align-items: center;
            gap: 8px;
            list-style: none;
        }

        .sample-size-summary::-webkit-details-marker { display: none; }

        .sample-size-summary::after {
            content: '▸';
            margin-left: auto;
            transition: transform 0.2s;
        }

        .sample-size-explanation[open] .sample-size-summary::after {
            transform: rotate(90deg);
        }

        .sample-size-content {
            padding: 0 16px 16px;
            color: var(--text-secondary);
            font-size: 0.85em;
            line-height: 1.6;
        }

        .sample-size-content p {
            margin: 0 0 12px 0;
        }

        .sample-size-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin: 16px 0;
        }

        .sample-stat {
            text-align: center;
            padding: 12px;
            background: rgba(15, 23, 42, 0.6);
            border-radius: 8px;
        }

        .sample-stat-value {
            display: block;
            font-size: 1.4em;
            font-weight: 700;
            color: var(--accent);
        }

        .sample-stat-label {
            font-size: 0.75em;
            color: var(--text-muted);
            margin-top: 4px;
            display: block;
        }

        .sample-size-table {
            width: 100%;
            border-collapse: collapse;
            margin: 12px 0;
            font-size: 0.9em;
        }

        .sample-size-table th, .sample-size-table td {
            padding: 8px 12px;
            text-align: left;
            border-bottom: 1px solid rgba(148,163,184,0.08);
        }

        .sample-size-table th {
            color: var(--text-muted);
            font-weight: 500;
            font-size: 0.85em;
        }

        .sample-size-table .value-highlight {
            color: #10b981;
        }

        .sample-size-note {
            font-style: italic;
            color: var(--text-muted);
            border-left: 2px solid var(--accent);
            padding-left: 12px;
            margin: 16px 0 0 0;
        }

        @media (max-width: 640px) {
            .sample-size-stats {
                grid-template-columns: 1fr;
            }
        }

        /* FIBO Semantic Categories Summary */
        .fibo-summary {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.08) 0%, rgba(59, 130, 246, 0.05) 100%);
            border: 1px solid rgba(139, 92, 246, 0.15);
            border-radius: 12px;
            padding: 16px 20px;
            margin-bottom: 20px;
        }

        .fibo-summary-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 14px;
        }

        .fibo-summary-icon {
            font-size: 1.3em;
        }

        .fibo-summary-title {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.95em;
        }

        .fibo-summary-count {
            margin-left: auto;
            font-size: 0.8em;
            color: var(--text-muted);
            background: rgba(139, 92, 246, 0.15);
            padding: 4px 10px;
            border-radius: 12px;
        }

        .fibo-categories-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .fibo-category-chip {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(15, 23, 42, 0.6);
            padding: 8px 14px;
            border-radius: 20px;
            border: 1px solid rgba(148,163,184,0.08);
            transition: all 0.2s;
        }

        .fibo-category-chip:hover {
            background: rgba(15, 23, 42, 0.8);
            border-color: rgba(139, 92, 246, 0.3);
        }

        .fibo-icon {
            font-size: 1em;
        }

        .fibo-label {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.85em;
        }

        .fibo-count {
            background: var(--accent);
            color: white;
            font-size: 0.7em;
            font-weight: 700;
            padding: 2px 7px;
            border-radius: 10px;
            min-width: 18px;
            text-align: center;
        }

        .fibo-tags {
            font-size: 0.75em;
            color: var(--text-muted);
            max-width: 150px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        @media (max-width: 640px) {
            .fibo-categories-grid {
                flex-direction: column;
            }
            .fibo-tags {
                display: none;
            }
        }

        /* Semantic Classification Chips (unified FIBO + Schema.org) */
        .semantic-chip {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 0.85em;
            transition: all 0.2s;
        }

        .semantic-chip.fibo {
            background: rgba(5, 150, 105, 0.15);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .semantic-chip.fibo:hover {
            background: rgba(5, 150, 105, 0.25);
        }

        .semantic-chip.schema-org {
            background: rgba(59, 130, 246, 0.15);
            border: 1px solid rgba(99, 102, 241, 0.3);
        }

        .semantic-chip.schema-org:hover {
            background: rgba(59, 130, 246, 0.25);
        }

        .semantic-chip .chip-icon {
            font-size: 1em;
        }

        .semantic-chip .chip-label {
            font-weight: 600;
            color: var(--text-primary);
        }

        .semantic-chip .chip-count {
            background: rgba(255,255,255,0.2);
            color: var(--text-primary);
            font-size: 0.75em;
            font-weight: 700;
            padding: 1px 6px;
            border-radius: 8px;
        }

        .semantic-chip .chip-source {
            font-size: 0.7em;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .source-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75em;
            font-weight: 600;
        }

        .source-badge.fibo {
            background: linear-gradient(135deg, #059669 0%, #10b981 100%);
            color: white;
        }

        .source-badge.schema {
            background: linear-gradient(135deg, #3b82f6 0%, #6366f1 100%);
            color: white;
        }

        /* FIBO Badge - Inline with column name (for mobile visibility) */
        .column-name-row {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }

        .fibo-badge-mobile {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            background: rgba(139, 92, 246, 0.12);
            color: var(--text-secondary);
            font-size: 0.7em;
            padding: 2px 8px;
            border-radius: 12px;
            border: 1px solid rgba(139, 92, 246, 0.2);
            white-space: nowrap;
        }

        @media (min-width: 1024px) {
            /* Hide mobile badge on desktop - shown in expanded details instead */
            .fibo-badge-mobile {
                display: none;
            }
        }

        @media (max-width: 640px) {
            .fibo-badge-mobile {
                font-size: 0.65em;
                padding: 2px 6px;
            }
        }

        /* ======================================================
           v2 METRICS DASHBOARD GRID
           ====================================================== */
        .metrics-dashboard {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-bottom: 24px;
        }

        .metrics-row {
            display: grid;
            gap: 12px;
        }

        .metrics-row.core {
            grid-template-columns: repeat(4, 1fr);
        }

        .metrics-row.quality {
            grid-template-columns: repeat(4, 1fr);
        }

        .metrics-row.types {
            grid-template-columns: repeat(4, 1fr);
        }

        @media (max-width: 768px) {
            .metrics-row.core,
            .metrics-row.quality,
            .metrics-row.types {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .metric-widget {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .metric-widget:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        }

        .metric-widget-label {
            font-size: 0.7em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-muted);
            margin-bottom: 6px;
        }

        .metric-widget-value {
            font-size: 1.6em;
            font-weight: 700;
            color: var(--text-primary);
            line-height: 1.2;
        }

        .metric-widget-trend {
            font-size: 0.75em;
            margin-top: 6px;
            color: var(--text-secondary);
        }

        .metric-widget-trend.good { color: var(--good); }
        .metric-widget-trend.warning { color: var(--warning); }
        .metric-widget-trend.critical { color: var(--critical); }

        /* Quality gauge styling */
        .metric-gauge {
            position: relative;
            width: 60px;
            height: 60px;
            margin: 0 auto 8px auto;
        }

        .metric-gauge svg {
            transform: rotate(-90deg);
        }

        .metric-gauge-value {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 0.9em;
            font-weight: 700;
            color: var(--text-primary);
        }

        /* ======================================================
           v2 INSIGHT WIDGET (Masterpiece Design)
           ====================================================== */
        .insight-widget {
            background: linear-gradient(180deg, #0f172a 0%, #0a0f1a 100%);
            border: 1px solid rgba(148, 163, 184, 0.08);
            border-radius: 16px;
            padding: 0;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            overflow: hidden;
        }

        .insight-widget-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px 24px;
            border-bottom: 1px solid rgba(148, 163, 184, 0.1);
            background: rgba(15, 23, 42, 0.5);
            cursor: pointer;
        }

        .insight-widget-header:hover {
            background: rgba(30, 41, 59, 0.5);
        }

        /* Add chevron to insight widget */
        .insight-widget-chevron {
            color: var(--text-muted);
            font-size: 0.8em;
            transition: transform 0.2s ease;
            margin-left: 12px;
        }

        .insight-widget.collapsed .insight-widget-chevron {
            transform: rotate(-90deg);
        }

        .insight-widget-title-group {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .insight-widget-icon {
            font-size: 1.3em;
        }

        .insight-widget-title {
            font-size: 1.05em;
            font-weight: 600;
            color: var(--text-primary);
        }

        .insight-widget-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.75em;
            font-weight: 600;
            background: rgba(139, 92, 246, 0.15);
            color: #a78bfa;
        }

        .insight-widget-badge.critical { background: rgba(239, 68, 68, 0.15); color: #f87171; }
        .insight-widget-badge.warning { background: rgba(245, 158, 11, 0.15); color: #fbbf24; }
        .insight-widget-badge.info { background: rgba(59, 130, 246, 0.15); color: #60a5fa; }
        .insight-widget-badge.good { background: rgba(16, 185, 129, 0.15); color: #34d399; }

        /* ML Model Badge */
        .insight-ml-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.7em;
            font-weight: 500;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(59, 130, 246, 0.2));
            color: #a78bfa;
            border: 1px solid rgba(139, 92, 246, 0.3);
            margin-left: 8px;
        }

        .insight-widget-body {
            padding: 24px;
            overflow: hidden;
            max-height: 2000px;
            transition: max-height 0.3s ease;
        }

        .insight-widget.collapsed .insight-widget-body {
            height: 0;
            overflow: hidden;
            padding: 0 24px;
        }

        /* Plain English Summary Section */
        .insight-summary {
            margin-bottom: 24px;
        }

        .insight-summary-label {
            font-size: 0.85em;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .insight-summary-label svg {
            color: var(--info-color);
        }

        .insight-summary-text {
            font-size: 0.95em;
            line-height: 1.6;
            color: var(--text-secondary);
            padding: 14px 16px;
            background: rgba(var(--info-color-rgb), 0.08);
            border-radius: 0 8px 8px 0;
            border-left: 3px solid var(--info-color);
        }

        /* Example Table Section */
        .insight-examples {
            margin-bottom: 20px;
        }

        .insight-examples-label {
            font-size: 0.85em;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .insight-examples-label svg {
            color: var(--text-muted);
        }

        .insight-examples-table {
            width: 100%;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            overflow: hidden;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
            font-size: 0.85em;
        }

        .insight-examples-table thead {
            background: rgba(15, 23, 42, 0.8);
        }

        .insight-examples-table th {
            padding: 12px 16px;
            text-align: left;
            font-weight: 600;
            color: var(--text-primary);
            border-bottom: 1px solid rgba(148, 163, 184, 0.1);
        }

        .insight-examples-table td {
            padding: 10px 16px;
            color: var(--text-secondary);
            border-bottom: 1px solid rgba(148, 163, 184, 0.05);
        }

        .insight-examples-table tr:last-child td {
            border-bottom: none;
        }

        .insight-examples-table tr:hover {
            background: rgba(96, 165, 250, 0.05);
        }

        .insight-examples-table .value-highlight {
            color: #f87171;
            font-weight: 600;
        }

        .insight-examples-table .value-normal {
            color: #94a3b8;
        }

        .insight-examples-table .row-id {
            color: var(--text-muted);
            font-size: 0.9em;
        }

        /* Technical Details Collapsible */
        .insight-technical {
            border-top: 1px solid rgba(148, 163, 184, 0.1);
            margin-top: 4px;
        }

        .insight-technical-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            width: 100%;
            padding: 14px 0;
            background: transparent;
            border: none;
            cursor: pointer;
            color: var(--text-secondary);
            font-size: 0.85em;
            transition: color 0.2s ease;
        }

        .insight-technical-toggle:hover {
            color: var(--accent);
        }

        .insight-technical-toggle::before {
            content: '🔬';
            font-size: 1.1em;
        }

        .insight-technical-toggle .toggle-arrow {
            margin-left: auto;
            transition: transform 0.2s ease;
        }

        .insight-technical.open .toggle-arrow {
            transform: rotate(180deg);
        }

        .insight-technical-content {
            display: none;
            padding: 16px;
            background: rgba(15, 23, 42, 0.6);
            border-radius: 10px;
            margin-bottom: 8px;
        }

        .insight-technical.open .insight-technical-content {
            display: block;
        }

        .insight-technical-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .insight-technical-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .insight-technical-item-label {
            font-size: 0.7em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-muted);
        }

        .insight-technical-item-value {
            font-size: 0.9em;
            color: var(--text-secondary);
            font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
        }

        .insight-technical-context {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid rgba(148, 163, 184, 0.08);
        }

        .insight-technical-context-title {
            font-size: 0.75em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-muted);
            margin-bottom: 10px;
        }

        .insight-technical-context-list {
            list-style: none;
            font-size: 0.85em;
            color: var(--text-secondary);
        }

        .insight-technical-context-list li {
            padding: 4px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .insight-technical-context-list li::before {
            content: '•';
            color: var(--accent);
        }

        /* ======================================================
           DUAL-LAYER EXPLANATIONS (Details/Summary)
           ====================================================== */
        .dual-layer-explanation {
            margin-top: 16px;
        }

        .dual-layer-summary {
            background: rgba(245, 158, 11, 0.12);
            border-left: 3px solid #f59e0b;
            padding: 12px 16px;
            border-radius: 0 8px 8px 0;
            margin-bottom: 12px;
        }

        .dual-layer-summary-label {
            font-size: 0.8em;
            font-weight: 600;
            color: #fbbf24;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .dual-layer-summary-label svg {
            color: #f59e0b;
        }

        .dual-layer-summary-text {
            font-size: 0.95em;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .dual-layer-technical {
            background: var(--bg-card);
            border-radius: 8px;
            border: 1px solid var(--border-subtle);
        }

        .dual-layer-technical summary {
            cursor: pointer;
            padding: 10px 14px;
            font-size: 0.8em;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 8px;
            user-select: none;
            list-style: none;
        }
        .dual-layer-technical summary::-webkit-details-marker {
            display: none;
        }
        .dual-layer-technical summary svg {
            flex-shrink: 0;
            width: 14px;
            height: 14px;
        }

        .dual-layer-technical summary:hover {
            color: var(--text-secondary);
            background: rgba(255, 255, 255, 0.02);
        }

        .dual-layer-technical summary::marker {
            color: var(--accent);
        }

        .dual-layer-technical[open] summary {
            border-bottom: 1px solid var(--border-subtle);
        }

        .dual-layer-technical-content {
            padding: 14px;
        }

        .dual-layer-technical-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 12px;
        }

        .dual-layer-technical-item {
            background: rgba(0, 0, 0, 0.2);
            padding: 8px 12px;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .dual-layer-technical-item-label {
            font-size: 0.75em;
            color: var(--text-muted);
        }

        .dual-layer-technical-item-value {
            font-size: 0.85em;
            font-weight: 500;
            color: var(--text-primary);
            font-family: 'SF Mono', monospace;
        }

        .dual-layer-technical-context {
            font-size: 0.8em;
            color: var(--text-muted);
            padding-top: 10px;
            border-top: 1px solid var(--border-subtle);
        }

        .dual-layer-technical-context ul {
            margin: 0;
            padding-left: 18px;
        }

        .dual-layer-technical-context li {
            margin-bottom: 4px;
        }

        /* ======================================================
           v2 SECTION HEADERS (Observation framing)
           ====================================================== */
        .section-header-v2 {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            border: 1px solid rgba(148, 163, 184, 0.1);
            border-radius: 12px;
            padding: 16px 20px;
            margin: 28px 0 16px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .section-header-v2-icon {
            font-size: 1.3em;
            margin-right: 12px;
        }

        .section-header-v2-title {
            font-size: 1.1em;
            font-weight: 600;
            color: var(--text-primary);
        }

        .section-header-v2-subtitle {
            font-size: 0.85em;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        .section-header-v2-badge {
            padding: 6px 14px;
            border-radius: 8px;
            font-size: 0.75em;
            font-weight: 600;
            text-transform: uppercase;
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
        }

        .section-header-v2-badge.observations { background: rgba(139, 92, 246, 0.15); color: #a78bfa; }
        .section-header-v2-badge.patterns { background: rgba(59, 130, 246, 0.15); color: #60a5fa; }
        .section-header-v2-badge.info { background: rgba(16, 185, 129, 0.15); color: #34d399; }
    </style>
</head>
<body>
    <!-- Feather Icons SVG Definitions (MIT License - https://feathericons.com) -->
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <defs>
        <symbol id="icon-bar-chart" viewBox="0 0 24 24"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></symbol><symbol id="icon-pie-chart" viewBox="0 0 24 24"><path d="M21.21 15.89A10 10 0 1 1 8 2.83"/><path d="M22 12A10 10 0 0 0 12 2v10z"/></symbol><symbol id="icon-activity" viewBox="0 0 24 24"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></symbol><symbol id="icon-trending-up" viewBox="0 0 24 24"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></symbol><symbol id="icon-trending-down" viewBox="0 0 24 24"><polyline points="23 18 13.5 8.5 8.5 13.5 1 6"/><polyline points="17 18 23 18 23 12"/></symbol><symbol id="icon-alert-triangle" viewBox="0 0 24 24"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></symbol><symbol id="icon-alert-circle" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></symbol><symbol id="icon-check-circle" viewBox="0 0 24 24"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></symbol><symbol id="icon-x-circle" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></symbol><symbol id="icon-check" viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></symbol><symbol id="icon-x" viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></symbol><symbol id="icon-info" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></symbol><symbol id="icon-help-circle" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></symbol><symbol id="icon-chevron-down" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></symbol><symbol id="icon-chevron-up" viewBox="0 0 24 24"><polyline points="18 15 12 9 6 15"/></symbol><symbol id="icon-chevron-right" viewBox="0 0 24 24"><polyline points="9 18 15 12 9 6"/></symbol><symbol id="icon-arrow-up" viewBox="0 0 24 24"><line x1="12" y1="19" x2="12" y2="5"/><polyline points="5 12 12 5 19 12"/></symbol><symbol id="icon-arrow-down" viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><polyline points="19 12 12 19 5 12"/></symbol><symbol id="icon-arrow-right" viewBox="0 0 24 24"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></symbol><symbol id="icon-maximize" viewBox="0 0 24 24"><polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" y1="3" x2="14" y2="10"/><line x1="3" y1="21" x2="10" y2="14"/></symbol><symbol id="icon-minimize" viewBox="0 0 24 24"><polyline points="4 14 10 14 10 20"/><polyline points="20 10 14 10 14 4"/><line x1="14" y1="10" x2="21" y2="3"/><line x1="3" y1="21" x2="10" y2="14"/></symbol><symbol id="icon-database" viewBox="0 0 24 24"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></symbol><symbol id="icon-file-text" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></symbol><symbol id="icon-folder" viewBox="0 0 24 24"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/></symbol><symbol id="icon-package" viewBox="0 0 24 24"><line x1="16.5" y1="9.4" x2="7.5" y2="4.21"/><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></symbol><symbol id="icon-box" viewBox="0 0 24 24"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></symbol><symbol id="icon-layers" viewBox="0 0 24 24"><polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/><polyline points="2 12 12 17 22 12"/></symbol><symbol id="icon-grid" viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></symbol><symbol id="icon-copy" viewBox="0 0 24 24"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></symbol><symbol id="icon-download" viewBox="0 0 24 24"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></symbol><symbol id="icon-search" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></symbol><symbol id="icon-eye" viewBox="0 0 24 24"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></symbol><symbol id="icon-settings" viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></symbol><symbol id="icon-sliders" viewBox="0 0 24 24"><line x1="4" y1="21" x2="4" y2="14"/><line x1="4" y1="10" x2="4" y2="3"/><line x1="12" y1="21" x2="12" y2="12"/><line x1="12" y1="8" x2="12" y2="3"/><line x1="20" y1="21" x2="20" y2="16"/><line x1="20" y1="12" x2="20" y2="3"/><line x1="1" y1="14" x2="7" y2="14"/><line x1="9" y1="8" x2="15" y2="8"/><line x1="17" y1="16" x2="23" y2="16"/></symbol><symbol id="icon-filter" viewBox="0 0 24 24"><polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/></symbol><symbol id="icon-target" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></symbol><symbol id="icon-edit" viewBox="0 0 24 24"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></symbol><symbol id="icon-plus" viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></symbol><symbol id="icon-minus" viewBox="0 0 24 24"><line x1="5" y1="12" x2="19" y2="12"/></symbol><symbol id="icon-clock" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></symbol><symbol id="icon-calendar" viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></symbol><symbol id="icon-user" viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></symbol><symbol id="icon-shield" viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></symbol><symbol id="icon-lock" viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></symbol><symbol id="icon-key" viewBox="0 0 24 24"><path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/></symbol><symbol id="icon-mail" viewBox="0 0 24 24"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></symbol><symbol id="icon-link" viewBox="0 0 24 24"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></symbol><symbol id="icon-globe" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></symbol><symbol id="icon-map-pin" viewBox="0 0 24 24"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></symbol><symbol id="icon-dollar-sign" viewBox="0 0 24 24"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></symbol><symbol id="icon-credit-card" viewBox="0 0 24 24"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/></symbol><symbol id="icon-briefcase" viewBox="0 0 24 24"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></symbol><symbol id="icon-percent" viewBox="0 0 24 24"><line x1="19" y1="5" x2="5" y2="19"/><circle cx="6.5" cy="6.5" r="2.5"/><circle cx="17.5" cy="17.5" r="2.5"/></symbol><symbol id="icon-tag" viewBox="0 0 24 24"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></symbol><symbol id="icon-hash" viewBox="0 0 24 24"><line x1="4" y1="9" x2="20" y2="9"/><line x1="4" y1="15" x2="20" y2="15"/><line x1="10" y1="3" x2="8" y2="21"/><line x1="16" y1="3" x2="14" y2="21"/></symbol><symbol id="icon-star" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></symbol><symbol id="icon-zap" viewBox="0 0 24 24"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></symbol><symbol id="icon-book-open" viewBox="0 0 24 24"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></symbol><symbol id="icon-thumbs-up" viewBox="0 0 24 24"><path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"/></symbol><symbol id="icon-thumbs-down" viewBox="0 0 24 24"><path d="M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"/></symbol><symbol id="icon-cpu" viewBox="0 0 24 24"><rect x="4" y="4" width="16" height="16" rx="2" ry="2"/><rect x="9" y="9" width="6" height="6"/><line x1="9" y1="1" x2="9" y2="4"/><line x1="15" y1="1" x2="15" y2="4"/><line x1="9" y1="20" x2="9" y2="23"/><line x1="15" y1="20" x2="15" y2="23"/><line x1="20" y1="9" x2="23" y2="9"/><line x1="20" y1="14" x2="23" y2="14"/><line x1="1" y1="9" x2="4" y2="9"/><line x1="1" y1="14" x2="4" y2="14"/></symbol><symbol id="icon-layout-grid" viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></symbol><symbol id="icon-table" viewBox="0 0 24 24"><path d="M3 3h18v18H3z"/><path d="M3 9h18M9 3v18"/></symbol><symbol id="icon-layout-list" viewBox="0 0 24 24"><path d="M4 4h16v4H4zM4 10h16v4H4zM4 16h16v4H4z"/></symbol><symbol id="icon-check-square" viewBox="0 0 24 24"><path d="M9 11l3 3 8-8"/><path d="M20 12v6a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h9"/></symbol><symbol id="icon-sun" viewBox="0 0 24 24"><path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/></symbol><symbol id="icon-brain" viewBox="0 0 24 24"><path d="M12 18V5"/><path d="M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4"/><path d="M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5"/><path d="M17.997 5.125a4 4 0 0 1 2.526 5.77"/><path d="M18 18a4 4 0 0 0 2-7.464"/><path d="M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517"/><path d="M6 18a4 4 0 0 1-2-7.464"/><path d="M6.003 5.125a4 4 0 0 0-2.526 5.77"/></symbol><symbol id="icon-brain-circuit" viewBox="0 0 24 24"><path d="M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"/><path d="M9 13a4.5 4.5 0 0 0 3-4"/><path d="M6.003 5.125A3 3 0 0 0 6.401 6.5"/><path d="M3.477 10.896a4 4 0 0 1 .585-.396"/><path d="M6 18a4 4 0 0 1-1.967-.516"/><path d="M12 13h4"/><path d="M12 18h6a2 2 0 0 1 2 2v1"/><path d="M12 8h8"/><path d="M16 8V5a2 2 0 0 1 2-2"/><circle cx="16" cy="13" r=".5"/><circle cx="18" cy="3" r=".5"/><circle cx="20" cy="21" r=".5"/><circle cx="20" cy="8" r=".5"/></symbol><symbol id="icon-network" viewBox="0 0 24 24"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/></symbol><symbol id="icon-aperture" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="14.31" y1="8" x2="20.05" y2="17.94"/><line x1="9.69" y1="8" x2="21.17" y2="8"/><line x1="7.38" y1="12" x2="13.12" y2="2.06"/><line x1="9.69" y1="16" x2="3.95" y2="6.06"/><line x1="14.31" y1="16" x2="2.83" y2="16"/><line x1="16.62" y1="12" x2="10.88" y2="21.94"/></symbol><symbol id="icon-git-branch" viewBox="0 0 24 24"><line x1="6" y1="3" x2="6" y2="15"/><circle cx="18" cy="6" r="3"/><circle cx="6" cy="18" r="3"/><path d="M18 9a9 9 0 0 1-9 9"/></symbol>
    </defs>
</svg>

    <!-- Top Navigation -->
    <header class="top-nav">
        <div class="top-inner">
            <div class="brand">
                <div class="brand-mark">DK9</div>
                <div class="brand-text">
                    <span>DataK9</span>
                    <span>Data Profiler</span>
                </div>
            </div>
            <div class="file-meta">
                <span class="file-name-pill">transactions.csv</span>
                <span><span class="pill-dot"></span>1,000 rows</span>
                <span><span class="pill-dot"></span>39.97 KB</span>
                <span><span class="pill-dot"></span>1.1s</span>
                <span><span class="pill-dot"></span>2025-12-02 12:51</span>
            </div>
        </div>
    </header>

    <!-- Sidebar Backdrop (mobile) -->
    <div class="dq-sidebar-backdrop" id="sidebarBackdrop" onclick="toggleSidebar()"></div>

    <!-- Main Layout with Sidebar -->
    <div class="dq-main-layout">
        <!-- Sidebar Navigation -->
        <aside class="dq-sidebar" id="dqSidebar">
            <div class="dq-sidebar-inner">
                <div class="dq-sidebar-section">
                    <div class="dq-sidebar-label">Navigation</div>
                    <ul class="dq-nav-list">
                        <li class="dq-nav-item"><button class="dq-nav-link active" data-section="overview"><svg class="nav-icon" style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-layout-grid"/></svg>Overview</button></li>
                        <li class="dq-nav-item"><button class="dq-nav-link" data-section="structure"><svg class="nav-icon" style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-table"/></svg>Structure</button></li>
                        <li class="dq-nav-item"><button class="dq-nav-link" data-section="missingness"><svg class="nav-icon" style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-check-circle"/></svg>Quality</button></li>
                        <li class="dq-nav-item"><button class="dq-nav-link" data-section="distributions"><svg class="nav-icon" style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-bar-chart"/></svg>Distributions</button></li>
                        <li class="dq-nav-item"><button class="dq-nav-link" data-section="temporal"><svg class="nav-icon" style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-clock"/></svg>Time Series</button></li>
                        <li class="dq-nav-item"><button class="dq-nav-link" data-section="predictive-ml"><svg class="nav-icon" style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-target"/></svg>ML Ready</button></li>
                        <li class="dq-nav-item"><button class="dq-nav-link" data-section="anomalies"><svg class="nav-icon" style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-activity"/></svg>Anomalies</button></li>
                        <li class="dq-nav-item"><button class="dq-nav-link" data-section="correlations"><svg class="nav-icon" style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-network"/></svg>Correlations</button></li>
                        <li class="dq-nav-item"><button class="dq-nav-link" data-section="columns"><svg class="nav-icon" style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-layout-list"/></svg>Fields</button></li>
                        <li class="dq-nav-item"><button class="dq-nav-link" data-section="validations"><svg class="nav-icon" style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-check-square"/></svg>Validations</button></li>
                        <li class="dq-nav-item"><button class="dq-nav-link" data-section="yaml"><svg class="nav-icon" style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-file-text"/></svg>YAML Config</button></li>
                        <li class="dq-nav-item"><button class="dq-nav-link" data-section="lineage"><svg class="nav-icon" style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-git-branch"/></svg>Lineage</button></li>
                        <li class="dq-nav-item"><button class="dq-nav-link" data-section="glossary"><svg class="nav-icon" style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-book-open"/></svg>Glossary</button></li>
                    </ul>
                </div>
            </div>
            <div class="dq-sidebar-actions">
                <button class="expand-all-btn" id="expandAllBtn" onclick="toggleExpandAll()" title="Expand/Collapse all sections">
                    <span class="expand-icon">+</span> Expand All
                </button>
                <button class="export-pdf-btn" id="exportPdfBtn" onclick="exportToPDF()" title="Export report to PDF">
                    <span class="pdf-icon"><svg style="width: 14px; height: 14px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-file-text"/></svg></span> Export PDF
                </button>
            </div>
        </aside>

        <!-- Mobile Nav Toggle -->
        <button class="dq-mobile-nav-toggle" id="mobileNavToggle" onclick="toggleSidebar()" aria-label="Toggle navigation">
            ☰
        </button>

        <!-- Main Content Area -->
        <main class="dq-main page">
        <!-- CSV Format Warning Banner (if issues detected) -->
        

        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- 1. EXECUTIVE SUMMARY WITH DIAL WIDGETS                          -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        
        <section class="executive-summary" id="section-overview">
            <!-- Data Profiling Header with Status Badge -->
            <div class="exec1-summary-header">
                <div class="exec1-summary-top">
                    <h1 class="exec1-summary-title">Data Profiling</h1>
                    <span class="exec1-status-badge complete"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:12px;height:12px"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>All Data Analysed</span>
                </div>
                <details class="exec1-info-line">
                    <summary>
                        <svg style="width: 14px; height: 14px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
                        transactions.csv • 02 Dec 2025 • 12:51
                    </summary>
                    <div class="exec1-info-detail">
                        <div class="exec1-detail-row">
                            <span class="exec1-detail-label">Analysis</span>
                            <span>Complete: All 1,000 rows analyzed</span>
                        </div>
                        <div class="exec1-detail-row">
                            <span class="exec1-detail-label">Source</span>
                            <span>transactions.csv</span>
                        </div>
                        <div class="exec1-detail-row">
                            <span class="exec1-detail-label">Profiled</span>
                            <span>02 Dec 2025 • 12:51</span>
                        </div>
                        <div class="exec1-detail-row" style="margin-top: 8px; padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.1);">
                            <span class="exec1-detail-label">Hash</span>
                            <span style="font-family: monospace; color: #a78bfa;" title="063c42ff6ad12a30c1b069f2c6eda517fea491dccf40a784e7ed27cf4d54ab3f">063c42ff6ad1...</span>
                        </div>
                        <div class="exec1-detail-row">
                            <span class="exec1-detail-label">Version</span>
                            <span>DataK9 v1.55</span>
                        </div>
                        <div class="exec1-detail-row">
                            <span class="exec1-detail-label">Host</span>
                            <span>open-codeserver</span>
                        </div>
                        <div class="exec1-detail-section" style="margin-top: 8px;">
                            <div style="color: var(--text-muted); font-size: 0.85em; margin-bottom: 6px;">Analyses Applied:</div>
                            <div style="display: flex; flex-wrap: wrap; gap: 4px;"><span style="background: rgba(167,139,250,0.15); color: #a78bfa; padding: 2px 6px; border-radius: 3px; font-size: 0.85em; margin-right: 4px; margin-bottom: 4px; display: inline-block;">Basic Statistics</span><span style="background: rgba(167,139,250,0.15); color: #a78bfa; padding: 2px 6px; border-radius: 3px; font-size: 0.85em; margin-right: 4px; margin-bottom: 4px; display: inline-block;">Type Inference</span><span style="background: rgba(167,139,250,0.15); color: #a78bfa; padding: 2px 6px; border-radius: 3px; font-size: 0.85em; margin-right: 4px; margin-bottom: 4px; display: inline-block;">Pattern Detection</span><span style="background: rgba(167,139,250,0.15); color: #a78bfa; padding: 2px 6px; border-radius: 3px; font-size: 0.85em; margin-right: 4px; margin-bottom: 4px; display: inline-block;">Temporal Analysis</span><span style="background: rgba(167,139,250,0.15); color: #a78bfa; padding: 2px 6px; border-radius: 3px; font-size: 0.85em; margin-right: 4px; margin-bottom: 4px; display: inline-block;">Pii Detection</span><span style="background: rgba(167,139,250,0.15); color: #a78bfa; padding: 2px 6px; border-radius: 3px; font-size: 0.85em; margin-right: 4px; margin-bottom: 4px; display: inline-block;">Ml Analysis</span><span style="color: var(--text-muted); font-size: 0.85em;">+1 more</span></div>
                        </div>
                    </div>
                </details>
            </div>

            <!-- Quality Widget: Large dial on left, breakdown bars on right -->
            <div class="exec1-quality-widget">
                <div class="exec1-quality-dial-section">
                    <svg class="exec1-quality-dial" viewBox="0 0 100 100">
                        <circle class="exec1-quality-dial-bg" cx="50" cy="50" r="42"/>
                        <circle class="exec1-quality-dial-fill" cx="50" cy="50" r="42"
                            style="stroke-dasharray: 242.66924500000002 264; stroke-dashoffset: 66; stroke: #10b981;"/>
                        <text x="50" y="48" class="exec1-quality-dial-text">92%</text>
                        <text x="50" y="62" class="exec1-quality-dial-subtext">QUALITY</text>
                    </svg>
                    <div class="exec1-quality-dial-label">Overall Score</div>
                </div>
                <div class="exec1-quality-breakdown">
                    <div class="exec1-breakdown-item">
                        <span class="exec1-breakdown-label">Completeness</span>
                        <div class="exec1-breakdown-bar-container">
                            <div class="exec1-breakdown-bar" style="width: 99.5%; background: #10b981;"></div>
                        </div>
                        <span class="exec1-breakdown-value">100%</span>
                        <span class="exec1-breakdown-weight">40%</span>
                    </div>
                    <div class="exec1-breakdown-item">
                        <span class="exec1-breakdown-label">Validity</span>
                        <div class="exec1-breakdown-bar-container">
                            <div class="exec1-breakdown-bar" style="width: 100.0%; background: #10b981;"></div>
                        </div>
                        <span class="exec1-breakdown-value">100%</span>
                        <span class="exec1-breakdown-weight">30%</span>
                    </div>
                    <div class="exec1-breakdown-item">
                        <span class="exec1-breakdown-label">Consistency</span>
                        <div class="exec1-breakdown-bar-container">
                            <div class="exec1-breakdown-bar" style="width: 87.25%; background: #f59e0b;"></div>
                        </div>
                        <span class="exec1-breakdown-value">87%</span>
                        <span class="exec1-breakdown-weight">20%</span>
                    </div>
                    <div class="exec1-breakdown-item">
                        <span class="exec1-breakdown-label">Uniqueness</span>
                        <div class="exec1-breakdown-bar-container">
                            <div class="exec1-breakdown-bar" style="width: 73.275%; background: #f59e0b;"></div>
                        </div>
                        <span class="exec1-breakdown-value">73%</span>
                        <span class="exec1-breakdown-weight">10%</span>
                    </div>
                </div>
            </div>

            <!-- Compact Stats Row -->
            <div class="exec1-compact-grid">
                <!-- Records -->
                <div class="exec1-compact-stat">
                    <div class="exec1-compact-value">1,000</div>
                    <div class="exec1-compact-label">Records</div>
                    <div class="exec1-compact-meta">62 anomalies</div>
                </div>
                <!-- Columns -->
                <div class="exec1-compact-stat">
                    <div class="exec1-compact-value">4</div>
                    <div class="exec1-compact-label">Columns</div>
                    <div class="exec1-compact-pills"><span class="type-pill">Mixed types</span></div>
                </div>
                <!-- Completeness -->
                <div class="exec1-compact-stat">
                    <div class="exec1-compact-value" style="color: #10b981;">100%</div>
                    <div class="exec1-compact-label">Completeness</div>
                    <div class="exec1-compact-meta">Non-null values</div>
                </div>
                <!-- Validity -->
                <div class="exec1-compact-stat">
                    <div class="exec1-compact-value" style="color: #10b981;">100%</div>
                    <div class="exec1-compact-label">Validity</div>
                    <div class="exec1-compact-meta">Type conformance</div>
                </div>
            </div>
        </section>

        <!-- AI-Generated Executive Summary (only with --beta-llm flag) -->
        

        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- 3. DATA QUALITY OVERVIEW - High-level metrics first             -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <div class="section-accordion expanded" id="section-structure" style="--section-accent: #3b82f6; --section-accent-dark: #1d4ed8;">
            <div class="section-accordion-header" onclick="toggleSectionAccordion(this)">
                <div class="section-accordion-icon">
                    <svg style="width: 20px; height: 20px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-table"/></svg>
                </div>
                <div class="section-accordion-content-wrap">
                    <h2 class="section-accordion-title">Structure</h2>
                    <p class="section-accordion-subtitle">Column types, meanings, and inferred patterns</p>
                </div>
                <div class="section-accordion-meta">
                    <div class="section-accordion-badge">Structure</div>
                    <span class="section-accordion-chevron"><svg style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-chevron-down"/></svg></span>
                </div>
            </div>
            <div class="section-accordion-content">
                <!-- Data Types Accordion -->
                
                <div class="dual-layer-explanation" style="margin-bottom: 20px;">
                    <div class="dual-layer-summary">
                        <div class="dual-layer-summary-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M12 2a7 7 0 0 0-4 12.7V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.3A7 7 0 0 0 12 2z"/></svg> What this means</div>
                        <div class="dual-layer-summary-text">Your dataset has 4 columns. Most columns (3) contain text data like names, categories, or descriptions. </div>
                    </div>
                    <details class="dual-layer-technical">
                        <summary>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
                            Technical Details
                        </summary>
                        <div class="dual-layer-technical-content">
                            <div class="dual-layer-technical-grid">
                                <div class="dual-layer-technical-item">
                                    <span class="dual-layer-technical-item-label">Integer</span>
                                    <span class="dual-layer-technical-item-value">0 columns</span>
                                </div>
                                <div class="dual-layer-technical-item">
                                    <span class="dual-layer-technical-item-label">Float</span>
                                    <span class="dual-layer-technical-item-value">1 columns</span>
                                </div>
                                <div class="dual-layer-technical-item">
                                    <span class="dual-layer-technical-item-label">String</span>
                                    <span class="dual-layer-technical-item-value">3 columns</span>
                                </div>
                                <div class="dual-layer-technical-item">
                                    <span class="dual-layer-technical-item-label">Datetime</span>
                                    <span class="dual-layer-technical-item-value">0 columns</span>
                                </div>
                            </div>
                            <div class="dual-layer-technical-context">
                                <ul>
                                    <li>Integer: Whole numbers (counts, IDs, quantities)</li>
                                    <li>Float: Decimal numbers (prices, percentages, measurements)</li>
                                    <li>String: Text data (names, categories, codes)</li>
                                    <li>Datetime: Date/time values for temporal analysis</li>
                                </ul>
                            </div>
                        </div>
                    </details>
                </div>
                <div class="chart-container" style="max-width: 500px;">
                    <div class="chart-title">Data Type Distribution</div>
                    <canvas id="typeChart" height="60"></canvas>
                </div>

                <!-- Semantic Classification Accordion (unified FIBO + Schema.org) -->
                
                <div class="accordion" data-accordion="semantics">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <div class="accordion-title-group">
                            <div class="accordion-icon"><svg style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; color: #64748b;"><use href="#icon-tag"/></svg></div>
                            <div>
                                <div class="accordion-title">Semantic Classification</div>
                                <div class="accordion-subtitle">What type of data is in each column?</div>
                            </div>
                        </div>
                        <div class="accordion-meta">
                            <span class="accordion-badge info">4/4 classified</span>
                            <span class="accordion-chevron"><svg style="width: 14px; height: 14px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-chevron-down"/></svg></span>
                        </div>
                    </div>
                    <div class="accordion-body">
                        <div class="accordion-content">
                            <!-- Plain English Summary (consistent with other sections) -->
                            <div class="dual-layer-summary">
                                <div class="dual-layer-summary-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M12 2a7 7 0 0 0-4 12.7V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.3A7 7 0 0 0 12 2z"/></svg> What this means</div>
                                <div class="dual-layer-summary-text">DataK9 successfully identified all 4 columns in your data. 3 columns match financial data patterns including Fibo-Fbc-Pas-Caa:Transaction, Fibo-Fnd-Pty-Pty:Partyidentifier, Fibo-Fnd-Acc-Cur:Monetaryamount. 1 column(s) match general data patterns (schema:CategoryCode).</div>
                            </div>

                            <!-- Classification Results - Visual Summary -->
                            <div style="display: flex; gap: 16px; flex-wrap: wrap; margin: 16px 0;">
                                <div style="background: var(--bg-tertiary); padding: 12px 16px; border-radius: 8px; text-align: center;">
                                    <div style="font-size: 1.5em; font-weight: 700; color: var(--success-color);">4</div>
                                    <div style="font-size: 0.75em; color: var(--text-muted);">Classified</div>
                                </div>
                                <div style="background: var(--bg-tertiary); padding: 12px 16px; border-radius: 8px; text-align: center;"><div style="font-size: 1.5em; font-weight: 700; color: #10b981;">3</div><div style="font-size: 0.75em; color: var(--text-muted);">FIBO</div></div>
                                <div style="background: var(--bg-tertiary); padding: 12px 16px; border-radius: 8px; text-align: center;"><div style="font-size: 1.5em; font-weight: 700; color: #6366f1;">1</div><div style="font-size: 0.75em; color: var(--text-muted);">Schema.org</div></div>
                                
                            </div>

                            

                            <!-- Technical Details (collapsed by default) -->
                            <details class="dual-layer-technical">
                                <summary>
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
                                    Technical Details
                                </summary>
                                <div class="dual-layer-technical-content">
                                    <!-- Classification breakdown by ontology -->
                                    <div style="margin-bottom: 16px;">
                                        <div style="font-size: 0.8em; color: var(--text-muted); margin-bottom: 8px; display: flex; align-items: center; gap: 6px;">
                                            <span style="background: linear-gradient(135deg, #059669 0%, #10b981 100%); color: white; padding: 2px 8px; border-radius: 4px; font-weight: 600;">FIBO</span>
                                            Financial patterns
                                        </div>
                                        <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                                            
                <div class="semantic-chip fibo" title="FIBO: fibo-fbc-pas-caa:Transaction - 1 column(s)">
                    <span class="chip-icon">📋</span>
                    <span class="chip-label">Fibo-Fbc-Pas-Caa:Transaction</span>
                    <span class="chip-count">1</span>
                    <span class="chip-source">FIBO</span>
                </div>
                <div class="semantic-chip fibo" title="FIBO: fibo-fnd-pty-pty:PartyIdentifier - 1 column(s)">
                    <span class="chip-icon">📋</span>
                    <span class="chip-label">Fibo-Fnd-Pty-Pty:Partyidentifier</span>
                    <span class="chip-count">1</span>
                    <span class="chip-source">FIBO</span>
                </div>
                <div class="semantic-chip fibo" title="FIBO: fibo-fnd-acc-cur:MonetaryAmount - 1 column(s)">
                    <span class="chip-icon">📋</span>
                    <span class="chip-label">Fibo-Fnd-Acc-Cur:Monetaryamount</span>
                    <span class="chip-count">1</span>
                    <span class="chip-source">FIBO</span>
                </div>
                                        </div>
                                    </div>

                                    <div style="margin-bottom: 16px;">
                                        <div style="font-size: 0.8em; color: var(--text-muted); margin-bottom: 8px; display: flex; align-items: center; gap: 6px;">
                                            <span style="background: linear-gradient(135deg, #3b82f6 0%, #6366f1 100%); color: white; padding: 2px 8px; border-radius: 4px; font-weight: 600;">Schema.org</span>
                                            General patterns
                                        </div>
                                        <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                                            
                <div class="semantic-chip schema-org" title="Schema.org: schema:CategoryCode - 1 column(s)">
                    <span class="chip-icon">📋</span>
                    <span class="chip-label">schema:CategoryCode</span>
                    <span class="chip-count">1</span>
                    <span class="chip-source">Schema.org</span>
                </div>
                                        </div>
                                    </div>

                                    <!-- Column mappings table -->
                                    <div style="margin-top: 16px; overflow-x: auto;">
                                        <div style="font-size: 0.8em; color: var(--text-muted); margin-bottom: 8px;"><svg style="width: 14px; height: 14px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-key"/></svg> Column Mappings</div>
                                        <table style="width: 100%; border-collapse: collapse; font-size: 0.85em;">
                                            <thead>
                                                <tr style="border-bottom: 1px solid var(--border-subtle);">
                                                    <th style="text-align: left; padding: 8px; color: var(--text-muted);">Column</th>
                                                    <th style="text-align: left; padding: 8px; color: var(--text-muted);">Semantic Type</th>
                                                    <th style="text-align: left; padding: 8px; color: var(--text-muted);">Source</th>
                                                    <th style="text-align: left; padding: 8px; color: var(--text-muted);">Confidence</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                
                <tr>
                    <td><code>transaction_id</code></td>
                    <td>Identifier (FIBO:Transaction)</td>
                    <td><span class="source-badge fibo">FIBO</span></td>
                    <td>100%</td>
                </tr>
                <tr>
                    <td><code>customer_id</code></td>
                    <td>Identifier (FIBO:PartyIdentifier)</td>
                    <td><span class="source-badge fibo">FIBO</span></td>
                    <td>100%</td>
                </tr>
                <tr>
                    <td><code>amount</code></td>
                    <td>Monetary amount (FIBO:MonetaryAmount)</td>
                    <td><span class="source-badge fibo">FIBO</span></td>
                    <td>100%</td>
                </tr>
                <tr>
                    <td><code>status</code></td>
                    <td>Category (schema:CategoryCode)</td>
                    <td><span class="source-badge schema">Schema.org</span></td>
                    <td>65%</td>
                </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                    <!-- Ontology explanation -->
                                    <div class="dual-layer-technical-context" style="margin-top: 16px;">
                                        <ul>
                                            <li><strong>FIBO</strong> (Financial Industry Business Ontology) identifies financial domain patterns like accounts, transactions, and monetary values.</li>
                                            <li><strong>Schema.org</strong> provides general web vocabulary for common types like Person, Organization, Email, and Address.</li>
                                            <li>FIBO is checked first; if no strong financial match is found, Schema.org provides a general classification.</li>
                                        </ul>
                                    </div>
                                </div>
                            </details>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- 3B. DATA QUALITY - Quality metrics and missingness              -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <div class="section-accordion expanded" id="section-missingness" style="--section-accent: #f59e0b; --section-accent-dark: #d97706;">
            <div class="section-accordion-header" onclick="toggleSectionAccordion(this)">
                <div class="section-accordion-icon">
                    <svg style="width: 20px; height: 20px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-check-circle"/></svg>
                </div>
                <div class="section-accordion-content-wrap">
                    <h2 class="section-accordion-title">Quality</h2>
                    <p class="section-accordion-subtitle">Completeness, validity, and data health scores</p>
                </div>
                <div class="section-accordion-meta">
                    <div class="section-accordion-badge">Quality</div>
                    <span class="section-accordion-chevron"><svg style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-chevron-down"/></svg></span>
                </div>
            </div>
            <div class="section-accordion-content">
                <!-- Quality Metrics Accordion -->
                
                <div class="dual-layer-explanation" style="margin-bottom: 20px;">
                    <div class="dual-layer-summary">
                        <div class="dual-layer-summary-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M12 2a7 7 0 0 0-4 12.7V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.3A7 7 0 0 0 12 2z"/></svg> What this means</div>
                        <div class="dual-layer-summary-text">Your data quality is excellent. All columns have good data coverage with minimal missing values. </div>
                    </div>
                    <details class="dual-layer-technical">
                        <summary>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
                            Technical Details
                        </summary>
                        <div class="dual-layer-technical-content">
                            <div class="dual-layer-technical-grid">
                                <div class="dual-layer-technical-item">
                                    <span class="dual-layer-technical-item-label">Overall Score</span>
                                    <span class="dual-layer-technical-item-value">92.0%</span>
                                </div>
                                <div class="dual-layer-technical-item">
                                    <span class="dual-layer-technical-item-label">Avg Completeness</span>
                                    <span class="dual-layer-technical-item-value">99.5%</span>
                                </div>
                                <div class="dual-layer-technical-item">
                                    <span class="dual-layer-technical-item-label">Avg Validity</span>
                                    <span class="dual-layer-technical-item-value">100.0%</span>
                                </div>
                                <div class="dual-layer-technical-item">
                                    <span class="dual-layer-technical-item-label">Columns Below 90%</span>
                                    <span class="dual-layer-technical-item-value">0</span>
                                </div>
                            </div>
                            <div class="dual-layer-technical-context">
                                <ul>
                                    <li><strong>Quality Score Formula:</strong> (0.4 × Completeness) + (0.3 × Validity) + (0.2 × Consistency) + (0.1 × Uniqueness)</li>
                                    <li>Completeness (40% weight): Percentage of non-null values</li>
                                    <li>Validity (30% weight): Values matching expected type/format</li>
                                    <li>Consistency (20% weight): Pattern uniformity across column</li>
                                    <li>Uniqueness (10% weight): Cardinality relative to column type</li>
                                </ul>
                            </div>
                        </div>
                    </details>
                </div>
                <div class="chart-container" style="max-width: 600px;">
                    <div class="chart-title">Quality Score by Column</div>
                    <canvas id="qualityChart" height="80"></canvas>
                </div>
                
                <div class="accordion" style="margin-top: 16px;">
                    <div class="accordion-header" onclick="this.parentElement.classList.toggle('expanded')">
                        <div class="accordion-icon" style="color: var(--good);"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:20px;height:20px"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg></div>
                        <div>
                            <div class="accordion-title">Duplicate Analysis</div>
                            <div class="accordion-subtitle">Exact and fuzzy duplicate detection</div>
                        </div>
                        <div class="accordion-meta">
                            <span class="accordion-badge" style="background: var(--good)22; color: var(--good);">No duplicates found</span>
                            <span class="accordion-chevron"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:16px;height:16px"><polyline points="6 9 12 15 18 9"/></svg></span>
                        </div>
                    </div>
                    <div class="accordion-content">
                        <div class="dual-layer-explanation">
                            <div class="dual-layer-summary">
                                <div class="dual-layer-summary-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M12 2a7 7 0 0 0-4 12.7V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.3A7 7 0 0 0 12 2z"/></svg> What this means</div>
                                <div class="dual-layer-summary-text">No duplicate records detected. Data appears to be properly deduplicated.</div>
                            </div>
                            <details class="dual-layer-technical">
                                <summary>
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
                                    Technical Details
                                </summary>
                                <div class="dual-layer-technical-content">
                                    <div class="dual-layer-technical-grid">
                                        <div class="dual-layer-technical-item">
                                            <span class="dual-layer-technical-item-label">Exact Duplicates</span>
                                            <span class="dual-layer-technical-item-value">0 (0.00%)</span>
                                        </div>
                                        <div class="dual-layer-technical-item">
                                            <span class="dual-layer-technical-item-label">Fuzzy Duplicates</span>
                                            <span class="dual-layer-technical-item-value">0 (0.00%)</span>
                                        </div>
                                    </div>
                                    <div class="dual-layer-technical-context" style="margin-top: 12px;">
                                        <p style="margin: 0; font-size: 0.85em; color: var(--text-muted);">Duplicate detection finds records that are identical or nearly identical. Exact duplicates are perfect copies. Fuzzy duplicates are almost the same (like 'John Smith' vs 'John  Smith' with extra space). Both can indicate data entry errors, failed deduplication, or merge issues.</p>
                                    </div>
                                    
                <div style="margin-top: 12px;">
                    <div style="font-size: 0.75em; color: var(--text-muted); margin-bottom: 4px;">Potential Key Columns:</div>
                    <div style="display: flex; flex-wrap: wrap; gap: 4px;"><span style="display: inline-block; padding: 2px 8px; background: rgba(59, 130, 246, 0.15); color: #3b82f6; border-radius: 4px; font-size: 0.75em; margin: 2px;">transaction_id: 100.0%</span><span style="display: inline-block; padding: 2px 8px; background: rgba(59, 130, 246, 0.15); color: #3b82f6; border-radius: 4px; font-size: 0.75em; margin: 2px;">customer_id: 98.0%</span></div>
                </div>
                                </div>
                            </details>
                        </div>
                    </div>
                </div>

                <div class="accordion" style="margin-top: 16px;">
                    <div class="accordion-header" onclick="this.parentElement.classList.toggle('expanded')">
                        <div class="accordion-icon" style="color: #8b5cf6;"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:20px;height:20px"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg></div>
                        <div>
                            <div class="accordion-title">Referential Integrity</div>
                            <div class="accordion-subtitle">Foreign key and relationship analysis</div>
                        </div>
                        <div class="accordion-meta">
                            <span class="accordion-badge">2 potential FKs</span>
                            <span class="accordion-chevron"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:16px;height:16px"><polyline points="6 9 12 15 18 9"/></svg></span>
                        </div>
                    </div>
                    <div class="accordion-content">
                        <div class="dual-layer-explanation">
                            <div class="dual-layer-summary">
                                <div class="dual-layer-summary-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M12 2a7 7 0 0 0-4 12.7V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.3A7 7 0 0 0 12 2z"/></svg> What this means</div>
                                <div class="dual-layer-summary-text">Identified 2 potential foreign key columns. Provide reference data to check for orphan records.</div>
                            </div>
                            <details class="dual-layer-technical">
                                <summary>
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
                                    Technical Details
                                </summary>
                                <div class="dual-layer-technical-content">
                                    <div class="dual-layer-technical-context">
                                        <p style="margin: 0 0 12px 0; font-size: 0.85em; color: var(--text-muted);">Referential integrity ensures that references between tables are valid. Like if you have an 'employee_id' in the orders table, that employee should actually exist in the employees table. Orphan records are those pointing to non-existent references - they often indicate data sync issues or deletions.</p>
                                    </div>
                                </div>
                            </details>
                        </div>
                    </div>
                </div>

                <!-- Overview Visualizations - Quality Radar (relocated from Advanced Visualizations) -->
                
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- 3C. DISTRIBUTIONS - Value distributions and patterns            -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <div class="section-accordion expanded" id="section-distributions" style="--section-accent: #06b6d4; --section-accent-dark: #0891b2;">
            <div class="section-accordion-header" onclick="toggleSectionAccordion(this)">
                <div class="section-accordion-icon">
                    <svg style="width: 20px; height: 20px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-bar-chart"/></svg>
                </div>
                <div class="section-accordion-content-wrap">
                    <h2 class="section-accordion-title">Distributions</h2>
                    <p class="section-accordion-subtitle">How values spread across your columns</p>
                </div>
                <div class="section-accordion-meta">
                    <div class="section-accordion-badge">1 Categorical</div>
                    <span class="section-accordion-chevron"><svg style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-chevron-down"/></svg></span>
                </div>
            </div>
            <div class="section-accordion-content">
                <!-- Value Distribution Accordion -->
                
                <div class="dual-layer-explanation" style="margin-bottom: 20px;">
                    <div class="dual-layer-summary">
                        <div class="dual-layer-summary-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M12 2a7 7 0 0 0-4 12.7V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.3A7 7 0 0 0 12 2z"/></svg> What this means</div>
                        <div class="dual-layer-summary-text">Your data has 1 categorical column (status) with only a few distinct values, typical of label or code fields.</div>
                    </div>
                    <details class="dual-layer-technical">
                        <summary>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
                            Technical Details
                        </summary>
                        <div class="dual-layer-technical-content">
                            <div class="dual-layer-technical-grid">
                                <div class="dual-layer-technical-item">
                                    <span class="dual-layer-technical-item-label">Categorical Columns</span>
                                    <span class="dual-layer-technical-item-value">1</span>
                                </div>
                                <div class="dual-layer-technical-item">
                                    <span class="dual-layer-technical-item-label">Chart X-Axis</span>
                                    <span class="dual-layer-technical-item-value">Uniqueness</span>
                                </div>
                                <div class="dual-layer-technical-item">
                                    <span class="dual-layer-technical-item-label">Completeness Range</span>
                                    <span class="dual-layer-technical-item-value">2.0%</span>
                                </div>
                                <div class="dual-layer-technical-item">
                                    <span class="dual-layer-technical-item-label">Uniqueness Range</span>
                                    <span class="dual-layer-technical-item-value">99.9%</span>
                                </div>
                            </div>
                            <div class="dual-layer-technical-context">
                                <ul>
                                    <li>Bubble chart: Each bubble represents a column; size = unique value count</li>
                                    <li>Word cloud: Larger words appear more frequently in your data</li>
                                    <li>Use these patterns to build ValidValuesCheck validations</li>
                                </ul>
                            </div>
                        </div>
                    </details>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 20px;">
                    <div class="chart-container" style="min-width: 280px;">
                        <div class="chart-title">Column Quality: Uniqueness vs Validity</div>
                        <canvas id="bubbleChart" height="180"></canvas>
                    </div>
                    <div class="chart-container">
                        <div class="chart-title">Categorical Values Word Cloud</div>
                        <div style="color: var(--text-muted); font-size: 0.85em; margin-bottom: 8px;">Showing top values from: ['status']</div>
                        <div id="wordCloudContainer" style="width: 100%; height: 350px; background: var(--bg-elevated); border-radius: var(--radius-md);"></div>
                    </div>
                </div>
                <style>
                    @media (max-width: 900px) {
                        #section-distributions .section-accordion-content > div:last-child {
                            grid-template-columns: 1fr !important;
                        }
                    }
                </style>

                <!-- Distribution Visualizations (relocated from Advanced Visualizations) -->
                
                    <div class="accordion" data-accordion="viz-amounts">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <div class="accordion-title-group">
                                <div class="accordion-icon"><svg style="width:16px;height:16px;color:#64748b;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3v16a2 2 0 0 0 2 2h16"/><path d="M7 16h8"/><path d="M7 11h12"/><path d="M7 6h3"/></svg></div>
                                <div>
                                    <div class="accordion-title">Amount Distributions (Log Scale)</div>
                                    <div class="accordion-subtitle">Visualize skewed numeric data distributions</div>
                                </div>
                            </div>
                            <div class="accordion-meta">
                                <span class="accordion-badge info">1 Fields</span>
                                <span class="accordion-chevron"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:14px;height:14px"><polyline points="6 9 12 15 18 9"/></svg></span>
                            </div>
                        </div>
                        <div class="accordion-content">
                            <div class="dual-layer-explanation">
                                <div class="dual-layer-summary">
                                    <div class="dual-layer-summary-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M12 2a7 7 0 0 0-4 12.7V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.3A7 7 0 0 0 12 2z"/></svg> What this means</div>
                                    <div class="dual-layer-summary-text">
                                        Distribution of values in numeric fields using log-scale histograms. This reveals patterns in skewed data where values span multiple orders of magnitude - common in financial, count, and measurement data.
                                        
                                    </div>
                                </div>
                                <details class="dual-layer-technical">
                                    <summary><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg> Technical Details</summary>
                                    <div class="dual-layer-technical-content" style="padding: 12px;">
                                        <ul style="margin: 0; padding-left: 20px; color: var(--text-secondary); font-size: 0.85em;">
                                            <li>Log-transformed bins handle heavy-tailed distributions</li>
                                            <li>Useful for detecting multimodality, gaps, and concentration points</li>
                                            <li>Consider log-transform or Box-Cox for modeling if highly skewed</li>
                                        </ul>
                                    </div>
                                </details>
                            </div>
                            <div style="display: flex; flex-wrap: wrap; gap: 16px; margin-top: 16px;">
                                
                    <div style="flex: 1; min-width: 300px; background: var(--bg-card); border-radius: 8px; padding: 16px; border: 1px solid var(--border-subtle);">
                        <h4 style="margin: 0 0 8px 0; font-size: 0.95em; color: var(--text-primary);">amount</h4>
                        <div style="font-size: 0.8em; color: var(--text-muted); margin-bottom: 4px;">
                            Min: 5.00 | Max: 500.00 | Median: 100.53
                        </div>
                        
                        <div style="height: 180px;">
                            <canvas id="amountLogHist_0"></canvas>
                        </div>
                    </div>
                            </div>
                            <script>
                            document.addEventListener('DOMContentLoaded', function() {
                                const amountCharts = [{"id": "amountLogHist_0", "labels": ["5", "6", "7", "8", "9", "11", "13", "15", "17", "20", "23", "27", "32", "37", "43", "50", "58", "68", "79", "92", "108", "126", "146", "171", "199", "232", "271", "315", "368", "429"], "data": [5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 3, 6, 33, 91, 219, 301, 236, 90, 9, 1, 0, 0, 0, 0, 0, 5]}];
                                amountCharts.forEach(chart => {
                                    const ctx = document.getElementById(chart.id);
                                    if (ctx) {
                                        new Chart(ctx, {
                                            type: 'bar',
                                            data: {
                                                labels: chart.labels,
                                                datasets: [{
                                                    label: 'Frequency',
                                                    data: chart.data,
                                                    backgroundColor: 'rgba(16, 185, 129, 0.6)',
                                                    borderColor: 'rgba(16, 185, 129, 1)',
                                                    borderWidth: 1
                                                }]
                                            },
                                            options: {
                                                responsive: true,
                                                maintainAspectRatio: false,
                                                plugins: { legend: { display: false } },
                                                scales: {
                                                    x: {
                                                        title: { display: true, text: 'Value (log scale)', color: '#64748b' },
                                                        ticks: { display: false },
                                                        grid: { color: 'rgba(148, 163, 184, 0.1)' }
                                                    },
                                                    y: {
                                                        title: { display: true, text: 'Count', color: '#64748b' },
                                                        grid: { color: 'rgba(148, 163, 184, 0.1)' },
                                                        ticks: { color: '#64748b' }
                                                    }
                                                }
                                            }
                                        });
                                    }
                                });
                            });
                            </script>
                        </div>
                    </div>
                    <div class="accordion" data-accordion="viz-box-plots">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <div class="accordion-title-group">
                                <div class="accordion-icon"><svg style="width:16px;height:16px;color:#64748b;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z"/><path d="M12 22V12"/><polyline points="3.29 7 12 12 20.71 7"/></svg></div>
                                <div>
                                    <div class="accordion-title">Numeric Distribution Summary</div>
                                    <div class="accordion-subtitle">Quartiles and outlier bounds at a glance</div>
                                </div>
                            </div>
                            <div class="accordion-meta">
                                <span class="accordion-badge info">1 Fields</span>
                                <span class="accordion-chevron"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:14px;height:14px"><polyline points="6 9 12 15 18 9"/></svg></span>
                            </div>
                        </div>
                        <div class="accordion-content">
                            
            <div class="dual-layer-explanation">
                <div class="dual-layer-summary">
                    <div class="dual-layer-summary-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M12 2a7 7 0 0 0-4 12.7V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.3A7 7 0 0 0 12 2z"/></svg> What this means</div>
                    <div class="dual-layer-summary-text">Outlier rates are low across all 1 number columns (averaging 0.00%). This means the data is well-behaved with very few extreme values. Most numbers fall in a normal-looking range. Note: this view uses only traditional box-plot rules (IQR). It may show zero classic outliers even when the ML-based anomaly detectors highlight unusual patterns.</div>
                </div>
                
                <details class="dual-layer-technical">
                    <summary><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg> Technical Details</summary>
                    <div class="dual-layer-technical-content">
                        <div class="dual-layer-technical-grid">
                    <div class="dual-layer-technical-item">
                        <span class="dual-layer-technical-item-label">Method</span>
                        <span class="dual-layer-technical-item-value">IQR (Tukey's Fences)</span>
                    </div>
                    <div class="dual-layer-technical-item">
                        <span class="dual-layer-technical-item-label">Fields Analyzed</span>
                        <span class="dual-layer-technical-item-value">1</span>
                    </div>
                    <div class="dual-layer-technical-item">
                        <span class="dual-layer-technical-item-label">Avg Outlier Rate</span>
                        <span class="dual-layer-technical-item-value">0.00%</span>
                    </div>
                    <div class="dual-layer-technical-item">
                        <span class="dual-layer-technical-item-label">Highest</span>
                        <span class="dual-layer-technical-item-value">amount (0.00%)</span>
                    </div>
                    <div class="dual-layer-technical-item">
                        <span class="dual-layer-technical-item-label">Lowest</span>
                        <span class="dual-layer-technical-item-value">amount (0.00%)</span>
                    </div></div>
                        
                <div class="dual-layer-technical-context">
                    <ul><li>Lower bound: Q1 - 1.5 × IQR</li><li>Upper bound: Q3 + 1.5 × IQR</li><li>IQR = Q3 - Q1 (interquartile range)</li><li>Values outside bounds are flagged as outliers</li></ul>
                </div>
                    </div>
                </details>
            </div>
                            <div style="background: var(--bg-card); border-radius: 8px; padding: 16px; height: 300px;">
                                <canvas id="boxPlotChart"></canvas>
                            </div>
                            <script>
                            document.addEventListener('DOMContentLoaded', function() {
                                const boxCtx = document.getElementById('boxPlotChart');
                                if (boxCtx) {
                                    const boxData = [{"col": "amount", "min": 0.0, "q1": 0, "median": 0.0, "q3": 0, "max": 0.0, "outlier_pct": 0}];
                                    const labels = boxData.map(d => d.col.length > 15 ? d.col.slice(0, 12) + '...' : d.col);

                                    // Normalize data for comparison (show relative positions)
                                    const normalizedData = boxData.map(d => {
                                        const range = d.max - d.min;
                                        if (range === 0) return { q1: 0.25, median: 0.5, q3: 0.75, min: 0, max: 1 };
                                        return {
                                            min: 0,
                                            q1: (d.q1 - d.min) / range,
                                            median: (d.median - d.min) / range,
                                            q3: (d.q3 - d.min) / range,
                                            max: 1
                                        };
                                    });

                                    new Chart(boxCtx, {
                                        type: 'bar',
                                        data: {
                                            labels: labels,
                                            datasets: [
                                                {
                                                    label: 'IQR',
                                                    data: normalizedData.map(d => d.q3 - d.q1),
                                                    backgroundColor: 'rgba(6, 182, 212, 0.6)',
                                                    borderColor: 'rgba(6, 182, 212, 1)',
                                                    borderWidth: 1
                                                }
                                            ]
                                        },
                                        options: {
                                            responsive: true,
                                            maintainAspectRatio: false,
                                            plugins: {
                                                legend: { display: false },
                                                tooltip: {
                                                    callbacks: {
                                                        label: function(ctx) {
                                                            const d = boxData[ctx.dataIndex];
                                                            return [
                                                                `Q1: ${d.q1.toLocaleString()}`,
                                                                `Median: ${d.median.toLocaleString()}`,
                                                                `Q3: ${d.q3.toLocaleString()}`,
                                                                `Outliers: ${d.outlier_pct.toFixed(1)}%`
                                                            ];
                                                        }
                                                    }
                                                }
                                            },
                                            scales: {
                                                x: {
                                                    grid: { display: false },
                                                    ticks: { color: '#94a3b8', font: { size: 10 }, maxRotation: 45 }
                                                },
                                                y: {
                                                    display: false
                                                }
                                            }
                                        }
                                    });
                                }
                            });
                            </script>
                        </div>
                    </div>
                <div class="accordion" data-accordion="viz-outlier-comparison">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <div class="accordion-title-group">
                            <div class="accordion-icon"><svg style="width:16px;height:16px;color:#64748b;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3v16a2 2 0 0 0 2 2h16"/><path d="M7 16h8"/><path d="M7 11h12"/><path d="M7 6h3"/></svg></div>
                            <div>
                                <div class="accordion-title">Outlier Comparison</div>
                                <div class="accordion-subtitle">Compare outlier rates across numeric fields</div>
                            </div>
                        </div>
                        <div class="accordion-meta">
                            <span class="accordion-badge neutral">Not Available</span>
                            <span class="accordion-chevron"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:14px;height:14px"><polyline points="6 9 12 15 18 9"/></svg></span>
                        </div>
                    </div>
                    <div class="accordion-content">
                        <div style="padding: 24px; background: var(--bg-card); border-radius: 8px; text-align: center;">
                            <div style="margin-bottom: 12px;"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:48px;height:48px;color:var(--text-muted)"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg></div>
                            <h4 style="margin: 0 0 8px 0; color: var(--text-primary);">Insufficient Numeric Fields</h4>
                            <p style="color: var(--text-muted); margin: 0; max-width: 500px; margin: 0 auto;">
                                Only 1 numeric field(s) available (need at least 2 for comparison). This chart compares outlier rates across multiple numeric columns to help identify which fields have unusual distributions.
                            </p>
                            <p style="color: var(--text-muted); font-size: 0.85em; margin-top: 12px;">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:14px;height:14px;vertical-align:-2px;color:#f59e0b"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg> <strong>Tip:</strong> Datasets with monetary amounts, measurements, or counts typically have more numeric fields suitable for this analysis.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- 3D. TEMPORAL ANALYSIS - Date/time patterns and trends           -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <div class="section-accordion" id="section-temporal" style="--section-accent: #f59e0b; --section-accent-dark: #d97706;">
            <div class="section-accordion-header" onclick="toggleSectionAccordion(this)">
                <div class="section-accordion-icon">
                    <svg style="width: 20px; height: 20px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-clock"/></svg>
                </div>
                <div class="section-accordion-content-wrap">
                    <h2 class="section-accordion-title">Time Series</h2>
                    <p class="section-accordion-subtitle">Date patterns, trends, and gaps over time</p>
                </div>
                <div class="section-accordion-meta">
                    <div class="section-accordion-badge">0 Fields</div>
                    <span class="section-accordion-chevron"><svg style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-chevron-down"/></svg></span>
                </div>
            </div>
            <div class="section-accordion-content">
                <p style="color: var(--text-muted); padding: 20px;">No date/time columns detected in this dataset.</p>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- 3E. PREDICTIVE ML - Target variable analysis                    -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <div class="section-accordion expanded" id="section-predictive-ml" style="--section-accent: #ec4899; --section-accent-dark: #db2777;">
            <div class="section-accordion-header" onclick="toggleSectionAccordion(this)">
                <div class="section-accordion-icon">
                    <svg style="width: 20px; height: 20px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-target"/></svg>
                </div>
                <div class="section-accordion-content-wrap">
                    <h2 class="section-accordion-title">ML Ready</h2>
                    <p class="section-accordion-subtitle">Target variables and features for modeling</p>
                </div>
                <div class="section-accordion-meta">
                    <div class="section-accordion-badge">1 Fields</div>
                    <span class="section-accordion-chevron"><svg style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-chevron-down"/></svg></span>
                </div>
            </div>
            <div class="section-accordion-content">
                <!-- Predictive ML Section -->
                
                    <div class="dual-layer-explanation" style="margin-bottom: 20px;">
                        <div class="dual-layer-summary">
                            <div class="dual-layer-summary-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M12 2a7 7 0 0 0-4 12.7V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.3A7 7 0 0 0 12 2z"/></svg> What this means</div>
                            <div class="dual-layer-summary-text">
                                We've identified columns that look like ML prediction targets (what you'd try to predict). The charts show how the classes are distributed - if one class is much rarer than others, your model may struggle to predict it accurately without special handling.
                                
                            </div>
                        </div>
                        <details class="dual-layer-technical">
                            <summary>
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
                                Technical Details
                            </summary>
                            <div class="dual-layer-technical-content" style="padding: 12px;">
                                <p style="font-weight: 600; margin-bottom: 8px; color: var(--text-secondary);">Target Detection</p>
                                <ul style="margin: 0 0 12px 0; padding-left: 20px; color: var(--text-secondary); font-size: 0.85em;">
                                    <li><strong>Keywords:</strong> target, label, class, outcome, churn, fraud, survived</li>
                                    <li><strong>Patterns:</strong> is_*, has_*, *_flag, *_indicator</li>
                                    <li><strong>Binary/low cardinality:</strong> 2-5 unique values with target-like name</li>
                                </ul>
                                <p style="font-weight: 600; margin-bottom: 8px; color: var(--text-secondary);">Class Imbalance</p>
                                <ul style="margin: 0; padding-left: 20px; color: var(--text-secondary); font-size: 0.85em;">
                                    <li>Minority class &lt;10% = critical imbalance requiring intervention</li>
                                    <li><strong>Solutions:</strong> SMOTE oversampling, class weights, stratified sampling</li>
                                    <li><strong>Metrics:</strong> Use F1-score, precision-recall AUC instead of accuracy</li>
                                </ul>
                            </div>
                        </details>
                    </div>
                    
                    <div style="margin-bottom: 16px;">
                        <div style="font-size: 0.75em; text-transform: uppercase; letter-spacing: 0.5px; color: #f59e0b; font-weight: 600; margin-bottom: 8px;">Detected ML Target</div>
                        <div style="display: flex; flex-wrap: wrap; gap: 16px;">
                    <div style="flex: 1; min-width: 280px; background: var(--bg-card); border-radius: 8px; padding: 16px; border: 2px solid #f59e0b; position: relative;">
                        <div style="position: absolute; top: -10px; left: 12px; background: linear-gradient(135deg, #f59e0b, #d97706); color: white; font-size: 0.7em; font-weight: 600; padding: 2px 8px; border-radius: 4px;"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:10px;height:10px;vertical-align:-1px;margin-right:2px"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg> ML TARGET</div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; margin-top: 4px;">
                            <h4 style="margin: 0; font-size: 0.95em; color: var(--text-primary);">status</h4>
                            <span class="accordion-badge info">1 classes</span>
                        </div>
                        <div style="height: 200px;">
                            <canvas id="classImbalance_0"></canvas>
                        </div>
                        <div style="font-size: 0.8em; color: var(--text-muted); margin-top: 8px; text-align: center;">
                            Total: 1,000
                        </div>
                    </div>
                    <div style="flex: 1; min-width: 280px; background: var(--bg-card); border-radius: 8px; padding: 16px; border: 2px solid #10b981; position: relative;">
                        <div style="position: absolute; top: -10px; left: 12px; background: linear-gradient(135deg, #10b981, #10b981dd); color: white; font-size: 0.7em; font-weight: 600; padding: 2px 8px; border-radius: 4px;">🔬 ML READY</div>
                        <div style="margin-top: 8px;">
                            <div style="font-size: 0.85em; color: var(--text-primary); margin-bottom: 10px; font-weight: 500;">Data Quality for ML</div>
                            <div style="font-size: 0.8em; color: #10b981; margin-bottom: 4px;">✓ Sample size: <span style="color: var(--text-muted);">1,000 rows sufficient</span></div>
                            <div style="margin-top: 10px; padding-top: 8px; border-top: 1px solid var(--border-color);">
                                <div style="font-size: 0.7em; color: var(--text-muted);">Suggested: Multi-class Classifier</div>
                            </div>
                        </div>
                    </div></div>
                    </div>
                    <script>
                    document.addEventListener('DOMContentLoaded', function() {
                        const imbalanceCharts = [{"id": "classImbalance_0", "labels": ["COMPLETED"], "data": [1000], "percentages": [100.0]}];
                        const colors = ['rgba(139, 92, 246, 0.8)', 'rgba(59, 130, 246, 0.8)', 'rgba(16, 185, 129, 0.8)',
                                       'rgba(245, 158, 11, 0.8)', 'rgba(239, 68, 68, 0.8)', 'rgba(236, 72, 153, 0.8)'];
                        imbalanceCharts.forEach(chart => {
                            const ctx = document.getElementById(chart.id);
                            if (ctx) {
                                new Chart(ctx, {
                                    type: 'bar',
                                    data: {
                                        labels: chart.labels,
                                        datasets: [{
                                            label: 'Count',
                                            data: chart.data,
                                            backgroundColor: colors.slice(0, chart.labels.length),
                                            borderWidth: 0,
                                            borderRadius: 4
                                        }]
                                    },
                                    options: {
                                        responsive: true,
                                        maintainAspectRatio: false,
                                        plugins: {
                                            legend: { display: false },
                                            tooltip: {
                                                callbacks: {
                                                    label: function(context) {
                                                        const pct = chart.percentages[context.dataIndex];
                                                        return `Count: ${context.raw.toLocaleString()} (${pct}%)`;
                                                    }
                                                }
                                            }
                                        },
                                        scales: {
                                            x: {
                                                grid: { display: false },
                                                ticks: { color: '#94a3b8', font: { size: 11 } }
                                            },
                                            y: {
                                                grid: { color: 'rgba(148, 163, 184, 0.1)' },
                                                ticks: { color: '#64748b' }
                                            }
                                        }
                                    }
                                });
                            }
                        });
                    });
                    </script>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- 4. DATA INSIGHTS - ML-powered patterns & anomalies              -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <div class="section-accordion expanded" id="section-anomalies" style="--section-accent: #ef4444; --section-accent-dark: #dc2626;">
            <div class="section-accordion-header" onclick="toggleSectionAccordion(this)">
                <div class="section-accordion-icon">
                    <svg style="width: 20px; height: 20px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-activity"/></svg>
                </div>
                <div class="section-accordion-content-wrap">
                    <h2 class="section-accordion-title">Anomalies</h2>
                    <p class="section-accordion-subtitle">Outliers, unusual patterns, and notable observations</p>
                </div>
                <div class="section-accordion-meta">
                    <div class="section-accordion-badge">62 Issues</div>
                    <span class="section-accordion-chevron"><svg style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-chevron-down"/></svg></span>
                </div>
            </div>
            <div class="section-accordion-content">
                <!-- PII Risk Section (if detected) - still important to highlight -->
                

                <!-- v2 Insight Widgets (Plain English + Examples + Technical) -->
                
            <div class="insights-summary" style="background: rgba(99, 102, 241, 0.08); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 8px; padding: 12px 16px; margin-bottom: 20px;">
                <p style="margin: 0; font-size: 0.9em; color: var(--text-secondary);">
                    <svg style="width: 16px; height: 16px; vertical-align: -3px; margin-right: 8px;" viewBox="0 0 24 24" fill="none" stroke="#818cf8" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                    Patterns observed from analyzing <strong>1,000 rows</strong> in 0.7s
                </p>
            </div>
            
        <div class="insight-widget">
            <div class="insight-widget-header" onclick="this.closest('.insight-widget').classList.toggle('collapsed')">
                <div class="insight-widget-title-group">
                    <span class="insight-widget-icon"><svg style="width: 18px; height: 18px; vertical-align: -2px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 18V5"/><path d="M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4"/><path d="M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5"/><path d="M17.997 5.125a4 4 0 0 1 2.526 5.77"/><path d="M18 18a4 4 0 0 0 2-7.464"/><path d="M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517"/><path d="M6 18a4 4 0 0 1-2-7.464"/><path d="M6.003 5.125a4 4 0 0 0-2.526 5.77"/></svg></span>
                    <span class="insight-widget-title">Field-Level Outliers</span>
                    <span class="insight-ml-badge"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:12px;height:12px;vertical-align:-1px;margin-right:3px"><path d="M12 18V5"/><path d="M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4"/><path d="M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5"/><path d="M17.997 5.125a4 4 0 0 1 2.526 5.77"/><path d="M18 18a4 4 0 0 0 2-7.464"/><path d="M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517"/><path d="M6 18a4 4 0 0 1-2-7.464"/><path d="M6.003 5.125a4 4 0 0 0-2.526 5.77"/></svg> Isolation Forest</span>
                </div>
                <div style="display: flex; align-items: center;">
                    <span class="insight-widget-badge warning">1.20% of rows</span>
                    <span class="insight-widget-chevron"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:12px;height:12px"><polyline points="6 9 12 15 18 9"/></svg></span>
                </div>
            </div>

            <div class="insight-widget-body">
                <!-- Plain English Summary (always visible) -->
                <div class="insight-summary">
                    <div class="insight-summary-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M12 2a7 7 0 0 0-4 12.7V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.3A7 7 0 0 0 12 2z"/></svg> What this means</div>
                    <div class="insight-summary-text">About 1.20% of values (12 records) stand out as very different
from most other values in their columns. These might be typos, special cases, or simply
unusual but valid entries worth reviewing. These anomalies are based on statistical isolation,
not just being outside the IQR bounds. It is normal for this method to find unusual points
even when IQR outliers are rare.</div>
                </div>

                <!-- Example Table -->
                <div class="insight-examples">
                    <div class="insight-examples-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px"><path d="M3 3v16a2 2 0 0 0 2 2h16"/><path d="M7 16h8"/><path d="M7 11h12"/><path d="M7 6h3"/></svg> Sample data</div>
                    <table class="insight-examples-table">
                        <thead>
                            <tr><th>Column</th><th>Outlier Value</th><th>Typical (Median)</th></tr>
                        </thead>
                        <tbody>
                            
                        <tr>
                            <td>amount</td>
                            <td class="value-highlight">500.00</td>
                            <td class="value-normal">100.53</td>
                        </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Semantic Confidence (if applicable) -->
                
                <div style="display: flex; align-items: center; gap: 6px; margin-top: 8px; padding: 6px 10px; background: rgba(245, 158, 11, 0.1); border-radius: 6px; font-size: 0.8em;">
                    <span style="background: #f59e0b; color: white; padding: 2px 8px; border-radius: 4px; font-weight: 600; font-size: 0.85em;">Interpret with caution</span>
                    <span style="color: var(--text-secondary);">Some columns may not be ideal for outlier detection based on their semantic types.</span>
                </div>

                <!-- Technical Details (Collapsed by default) -->
                <details class="dual-layer-technical">
                    <summary><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg> Technical Details</summary>
                    <div class="dual-layer-technical-content">
                        <div class="dual-layer-technical-grid">
                            
                    <div class="insight-technical-item">
                        <span class="insight-technical-item-label">amount</span>
                        <span class="insight-technical-item-value">12 outliers • isolation_forest • confidence: High</span>
                    </div>
                        </div>
                        <div class="dual-layer-technical-context">
                            <ul>
                                <li>ML Model: Isolation Forest (unsupervised anomaly detection)</li><li>Sample Size: 1,000 rows</li><li>Columns Analyzed: 1</li>
                            </ul>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        
        <div class="insight-widget">
            <div class="insight-widget-header" onclick="this.closest('.insight-widget').classList.toggle('collapsed')">
                <div class="insight-widget-title-group">
                    <span class="insight-widget-icon"><svg style="width: 18px; height: 18px; vertical-align: -2px; color: #10b981;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg></span>
                    <span class="insight-widget-title">Row-Level Anomalies</span>
                    <span class="insight-ml-badge"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:12px;height:12px;vertical-align:-1px;margin-right:3px"><path d="M12 18V5"/><path d="M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4"/><path d="M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5"/><path d="M17.997 5.125a4 4 0 0 1 2.526 5.77"/><path d="M18 18a4 4 0 0 0 2-7.464"/><path d="M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517"/><path d="M6 18a4 4 0 0 1-2-7.464"/><path d="M6.003 5.125a4 4 0 0 0-2.526 5.77"/></svg> Isolation Forest</span>
                </div>
                <div style="display: flex; align-items: center;">
                    <span class="insight-widget-badge good">None detected</span>
                    <span class="insight-widget-chevron"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:12px;height:12px"><polyline points="6 9 12 15 18 9"/></svg></span>
                </div>
            </div>

            <div class="insight-widget-body">
                <!-- Plain English Summary (always visible) -->
                <div class="insight-summary">
                    <div class="insight-summary-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M12 2a7 7 0 0 0-4 12.7V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.3A7 7 0 0 0 12 2z"/></svg> What this means</div>
                    <div class="insight-summary-text">When looking at multiple columns together, all records appear normal.
The values across different fields fit together as expected, with no unusual
combinations that might indicate errors or special cases.</div>
                </div>

                <!-- Example Table -->
                <div class="insight-examples">
                    <div class="insight-examples-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px"><path d="M3 3v16a2 2 0 0 0 2 2h16"/><path d="M7 16h8"/><path d="M7 11h12"/><path d="M7 6h3"/></svg> Sample data</div>
                    <table class="insight-examples-table">
                        <thead>
                            <tr><th>Analysis</th><th>Result</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>Multivariate Isolation Forest</td><td class="value-normal">No anomalies detected</td></tr>
                <tr><td>Rows Analyzed</td><td>1,000</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Semantic Confidence (if applicable) -->
                

                <!-- Technical Details (Collapsed by default) -->
                <details class="dual-layer-technical">
                    <summary><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg> Technical Details</summary>
                    <div class="dual-layer-technical-content">
                        <div class="dual-layer-technical-grid">
                            
                    <div class="insight-technical-item">
                        <span class="insight-technical-item-label">Method</span>
                        <span class="insight-technical-item-value">Isolation Forest (multivariate)</span>
                    </div>
                
                        </div>
                        <div class="dual-layer-technical-context">
                            <ul>
                                <li>Multivariate analysis examines relationships across all numeric columns</li><li>No records showed unusual combinations of values</li><li>This is a positive indicator of data consistency</li>
                            </ul>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        
        

                <!-- Anomaly Visualizations (relocated from Advanced Visualizations) -->
                
                <div class="accordion" data-accordion="viz-anomaly-scores">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <div class="accordion-title-group">
                            <div class="accordion-icon"><svg style="width:16px;height:16px;color:#64748b;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m21 21-4.34-4.34"/><circle cx="11" cy="11" r="8"/></svg></div>
                            <div>
                                <div class="accordion-title">Isolation Forest Anomaly Scores</div>
                                <div class="accordion-subtitle">Statistical outlier detection per numeric field</div>
                            </div>
                        </div>
                        <div class="accordion-meta">
                            <span class="accordion-badge info">1 Fields</span>
                            <span class="accordion-chevron"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:14px;height:14px"><polyline points="6 9 12 15 18 9"/></svg></span>
                        </div>
                    </div>
                    <div class="accordion-content">
                        
            <div class="dual-layer-explanation">
                <div class="dual-layer-summary">
                    <div class="dual-layer-summary-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M12 2a7 7 0 0 0-4 12.7V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.3A7 7 0 0 0 12 2z"/></svg> What this means</div>
                    <div class="dual-layer-summary-text">A small number of records (12, or 1.20%) have values that look unusual. Most of these are likely legitimate edge cases, but they may be worth reviewing.</div>
                </div>
                
                <details class="dual-layer-technical">
                    <summary><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg> Technical Details</summary>
                    <div class="dual-layer-technical-content">
                        <div class="dual-layer-technical-grid">
                    <div class="dual-layer-technical-item">
                        <span class="dual-layer-technical-item-label">Algorithm</span>
                        <span class="dual-layer-technical-item-value">Isolation Forest</span>
                    </div>
                    <div class="dual-layer-technical-item">
                        <span class="dual-layer-technical-item-label">Fields Analyzed</span>
                        <span class="dual-layer-technical-item-value">1</span>
                    </div>
                    <div class="dual-layer-technical-item">
                        <span class="dual-layer-technical-item-label">Total Anomalies</span>
                        <span class="dual-layer-technical-item-value">12</span>
                    </div>
                    <div class="dual-layer-technical-item">
                        <span class="dual-layer-technical-item-label">Anomaly Rate</span>
                        <span class="dual-layer-technical-item-value">1.200%</span>
                    </div>
                    <div class="dual-layer-technical-item">
                        <span class="dual-layer-technical-item-label">Avg Score Range</span>
                        <span class="dual-layer-technical-item-value">-0.132 - -0.026</span>
                    </div></div>
                        
                <div class="dual-layer-technical-context">
                    <ul><li>Isolation Forest scores: lower values = more anomalous (harder to isolate)</li><li>Contamination parameter set to 'auto' (adaptive threshold)</li><li>Each column analyzed independently for outliers</li><li>Anomaly rate = total field anomalies (12) / sample size (1,000)</li></ul>
                </div>
                    </div>
                </details>
            </div>
                        <div style="display: flex; flex-wrap: wrap; gap: 12px; margin-top: 16px;">
                            
                    <div style="flex: 1; min-width: 200px; background: var(--bg-card); border-radius: 8px; padding: 16px; border: 1px solid var(--border-subtle);">
                        <h4 style="margin: 0 0 12px 0; font-size: 0.9em; color: var(--text-primary);">amount</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                            <div style="text-align: center; padding: 8px; background: rgba(139, 92, 246, 0.1); border-radius: 6px;">
                                <div style="font-size: 1.1em; font-weight: bold; color: var(--text-primary);">12</div>
                                <div style="font-size: 0.7em; color: var(--text-muted);">Anomalies</div>
                            </div>
                            <div style="text-align: center; padding: 8px; background: rgba(239, 68, 68, 0.1); border-radius: 6px;">
                                <div style="font-size: 1.1em; font-weight: bold; color: var(--warning);">1.20%</div>
                                <div style="font-size: 0.7em; color: var(--text-muted);">Rate</div>
                            </div>
                        </div>
                        <div style="margin-top: 12px; font-size: 0.75em; color: var(--text-muted);">
                            Score range: -0.132 to -0.026
                        </div>
                    </div>
                        </div>
                    </div>
                </div>
                    <div class="accordion" data-accordion="viz-benford">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            <div class="accordion-title-group">
                                <div class="accordion-icon"><svg style="width:16px;height:16px;color:#64748b;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z"/><path d="M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12"/></svg></div>
                                <div>
                                    <div class="accordion-title">Benford's Law Analysis</div>
                                    <div class="accordion-subtitle">Detect potential data fabrication in numeric columns</div>
                                </div>
                            </div>
                            <div class="accordion-meta">
                                <span class="accordion-badge info">1 Fields</span>
                                <span class="accordion-chevron"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:14px;height:14px"><polyline points="6 9 12 15 18 9"/></svg></span>
                            </div>
                        </div>
                        <div class="accordion-content">
                            
            <div class="dual-layer-explanation">
                <div class="dual-layer-summary">
                    <div class="dual-layer-summary-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M12 2a7 7 0 0 0-4 12.7V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.3A7 7 0 0 0 12 2z"/></svg> What this means</div>
                    <div class="dual-layer-summary-text">First-digit frequencies deviate significantly from the Benford distribution in 1 of 1 columns analyzed. For naturally occurring transactional datasets this may indicate anomalies, but for pricing or tariff tables it can simply reflect business structure.</div>
                </div>
                
                <details class="dual-layer-technical">
                    <summary><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg> Technical Details</summary>
                    <div class="dual-layer-technical-content">
                        <div class="dual-layer-technical-grid">
                    <div class="dual-layer-technical-item">
                        <span class="dual-layer-technical-item-label">Fields Analyzed</span>
                        <span class="dual-layer-technical-item-value">1</span>
                    </div>
                    <div class="dual-layer-technical-item">
                        <span class="dual-layer-technical-item-label">Deviations</span>
                        <span class="dual-layer-technical-item-value">1</span>
                    </div>
                    <div class="dual-layer-technical-item">
                        <span class="dual-layer-technical-item-label">Conforming</span>
                        <span class="dual-layer-technical-item-value">0</span>
                    </div>
                    <div class="dual-layer-technical-item">
                        <span class="dual-layer-technical-item-label">Avg Chi-Square</span>
                        <span class="dual-layer-technical-item-value">1210.4</span>
                    </div></div>
                        
                <div class="dual-layer-technical-context">
                    <ul><li>Benford's Law: Leading digit 1 appears ~30.1% of the time in natural data</li><li>Chi-square test compares observed vs expected distributions</li><li>Higher chi-square values indicate greater deviation from expected</li><li>Works best with data spanning multiple orders of magnitude</li></ul>
                </div>
                    </div>
                </details>
            </div>
                            <div style="display: flex; flex-wrap: wrap; gap: 16px;">
                                
                    <div style="flex: 1; min-width: 280px; background: var(--bg-card); border-radius: 8px; padding: 16px; border: 1px solid var(--border-subtle);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <h4 style="margin: 0; font-size: 0.9em; color: var(--text-primary);">amount</h4>
                            <span class="accordion-badge critical">Benford deviation</span>
                        </div>
                        <div style="height: 180px;">
                            <canvas id="benfordChart_0"></canvas>
                        </div>
                        <div style="font-size: 0.75em; color: var(--text-muted); margin-top: 8px;">
                            Chi-square: 1210.4 | Confidence: Very High
                        </div>
                    </div>
                            </div>
                            <script>
                            document.addEventListener('DOMContentLoaded', function() {
                                const benfordData = [{"id": "benfordChart_0", "observed": [50.6, 0.0, 0.1, 0.3, 2.2, 4.0, 8.9, 16.4, 17.5], "expected": [30.1, 17.6, 12.5, 9.7, 7.9, 6.7, 5.8, 5.1, 4.6]}];
                                benfordData.forEach(chart => {
                                    const ctx = document.getElementById(chart.id);
                                    if (ctx) {
                                        new Chart(ctx, {
                                            type: 'bar',
                                            data: {
                                                labels: ['1', '2', '3', '4', '5', '6', '7', '8', '9'],
                                                datasets: [
                                                    {
                                                        label: 'Observed %',
                                                        data: chart.observed,
                                                        backgroundColor: 'rgba(59, 130, 246, 0.7)',
                                                        borderWidth: 0
                                                    },
                                                    {
                                                        label: 'Expected %',
                                                        data: chart.expected,
                                                        backgroundColor: 'rgba(249, 115, 22, 0.7)',
                                                        borderWidth: 0
                                                    }
                                                ]
                                            },
                                            options: {
                                                responsive: true,
                                                maintainAspectRatio: false,
                                                plugins: {
                                                    legend: { display: true, position: 'top', labels: { boxWidth: 12, font: { size: 10 } } }
                                                },
                                                scales: {
                                                    x: { grid: { display: false }, ticks: { color: '#94a3b8' } },
                                                    y: { grid: { color: 'rgba(148, 163, 184, 0.1)' }, ticks: { color: '#64748b' } }
                                                }
                                            }
                                        });
                                    }
                                });
                            });
                            </script>
                        </div>
                    </div>

                <!-- Missingness Visualizations (relocated from Advanced Visualizations) -->
                
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- 4B. CORRELATIONS - Column relationships                         -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <div class="section-accordion expanded" id="section-correlations" style="--section-accent: #8b5cf6; --section-accent-dark: #7c3aed;">
            <div class="section-accordion-header" onclick="toggleSectionAccordion(this)">
                <div class="section-accordion-icon">
                    <svg style="width: 20px; height: 20px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-network"/></svg>
                </div>
                <div class="section-accordion-content-wrap">
                    <h2 class="section-accordion-title">Correlations</h2>
                    <p class="section-accordion-subtitle">How columns relate to each other</p>
                </div>
                <div class="section-accordion-meta">
                    <div class="section-accordion-badge">0 Pairs</div>
                    <span class="section-accordion-chevron"><svg style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-chevron-down"/></svg></span>
                </div>
            </div>
            <div class="section-accordion-content">
                <!-- Column Relationships / Correlations -->
                <p style="color: var(--text-muted);">No significant correlations detected.</p>

                <!-- Correlation Visualizations (relocated from Advanced Visualizations) -->
                
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- 5. COLUMN-LEVEL QUALITY SUMMARY                                 -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <div class="section-accordion expanded" id="section-columns" style="--section-accent: #6366f1; --section-accent-dark: #4f46e5;">
            <div class="section-accordion-header" onclick="toggleSectionAccordion(this)">
                <div class="section-accordion-icon">
                    <svg style="width: 20px; height: 20px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-layout-list"/></svg>
                </div>
                <div class="section-accordion-content-wrap">
                    <h2 class="section-accordion-title">Fields</h2>
                    <p class="section-accordion-subtitle">Detailed stats and quality for each column</p>
                </div>
                <div class="section-accordion-meta">
                    <div class="section-accordion-badge">4 Fields</div>
                    <span class="section-accordion-chevron"><svg style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-chevron-down"/></svg></span>
                </div>
            </div>
            <div class="section-accordion-content">
                <!-- Column Explorer -->
                
                <!-- Column Quality Heatmap -->
                
        <div class="column-heatmap">
            <div class="heatmap-header">
                <span class="heatmap-title">Column Quality Overview</span>
                <div class="heatmap-legend">
                    <span class="legend-item"><span class="legend-dot heatmap-good"></span>90+</span>
                    <span class="legend-item"><span class="legend-dot heatmap-ok"></span>70-89</span>
                    <span class="legend-item"><span class="legend-dot heatmap-warning"></span>50-69</span>
                    <span class="legend-item"><span class="legend-dot heatmap-critical"></span>&lt;50</span>
                </div>
            </div>
            <div class="heatmap-grid">
                
            <div class="heatmap-cell heatmap-good" title="transaction_id: 100%">
                <span class="heatmap-name">transaction_...</span>
                <span class="heatmap-score">100</span>
            </div>
            <div class="heatmap-cell heatmap-good" title="customer_id: 99%">
                <span class="heatmap-name">customer_id</span>
                <span class="heatmap-score">99</span>
            </div>
            <div class="heatmap-cell heatmap-ok" title="amount: 88%">
                <span class="heatmap-name">amount</span>
                <span class="heatmap-score">88</span>
            </div>
            <div class="heatmap-cell heatmap-ok" title="status: 80%">
                <span class="heatmap-name">status</span>
                <span class="heatmap-score">80</span>
            </div>
            </div>
        </div>

                <div class="accordion column-explorer" data-accordion="columns" id="section-columns">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <div class="accordion-title-group">
                            <div class="accordion-icon columns"><svg style="width:16px;height:16px;color:white;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg></div>
                            <div>
                                <div class="accordion-title">Column Explorer</div>
                                <div class="accordion-subtitle">4 columns with semantic analysis</div>
                            </div>
                        </div>
                        <div class="accordion-meta">
                            <span class="accordion-badge info">4 tagged</span>
                            <span class="accordion-chevron"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:14px;height:14px"><polyline points="6 9 12 15 18 9"/></svg></span>
                        </div>
                    </div>
                    <div class="accordion-body">
                        <div class="accordion-content">
                            <div class="dual-layer-explanation">
                                <div class="dual-layer-summary">
                                    <div class="dual-layer-summary-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M12 2a7 7 0 0 0-4 12.7V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.3A7 7 0 0 0 12 2z"/></svg> What this means</div>
                                    <div class="dual-layer-summary-text">Your dataset has 4 columns. All columns have acceptable quality scores. Click any column in the list below for detailed statistics and patterns.</div>
                                </div>
                                <details class="dual-layer-technical">
                                    <summary><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg> Technical Details</summary>
                                    <div class="dual-layer-technical-content">
                                        <div class="dual-layer-technical-grid">
                                            <div class="dual-layer-technical-item">
                                                <span class="dual-layer-technical-item-label">Total Columns</span>
                                                <span class="dual-layer-technical-item-value">4</span>
                                            </div>
                                            <div class="dual-layer-technical-item">
                                                <span class="dual-layer-technical-item-label">Semantically Tagged</span>
                                                <span class="dual-layer-technical-item-value">4</span>
                                            </div>
                                            <div class="dual-layer-technical-item">
                                                <span class="dual-layer-technical-item-label">PII Detected</span>
                                                <span class="dual-layer-technical-item-value">0</span>
                                            </div>
                                            <div class="dual-layer-technical-item">
                                                <span class="dual-layer-technical-item-label">Quality Concerns</span>
                                                <span class="dual-layer-technical-item-value">0</span>
                                            </div>
                                        </div>
                                        <div class="dual-layer-technical-context">
                                            <ul>
                                                <li><strong>Row Count, Null Count, Min/Max:</strong> Computed from ALL rows (exact values)</li>
                                                <li><strong>Mean, Std Dev, Median, ML Analysis:</strong> Computed from analysis sample</li>
                                                <li><strong>Top Values:</strong> Adaptively tracked per column (low cardinality: all values; high cardinality: capped)</li>
                                                <li><strong>Semantic tags:</strong> MONEY, TIMESTAMP, ACCOUNT_ID, etc. based on FIBO ontology</li>
                                            </ul>
                                        </div>
                                    </div>
                                </details>
                            </div>
                            
        <div class="column-controls">
            <div class="search-box">
                <input type="text" id="columnSearch" placeholder="Search columns..."
                       onkeyup="filterColumns()" class="search-input">
                <span class="search-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:14px;height:14px"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg></span>
            </div>
            <div class="filter-buttons">
                <button class="filter-btn active" onclick="filterByType('all')">All</button>
                <button class="filter-btn" onclick="filterByType('issues')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:12px;height:12px;vertical-align:-1px;color:#f59e0b"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg> With Issues</button>
                <button class="filter-btn" onclick="filterByType('numeric')">Numeric</button>
                <button class="filter-btn" onclick="filterByType('string')">String</button>
                <button class="filter-btn" onclick="filterByType('date')">Date</button>
            </div>
            <div class="sort-controls">
                <select id="columnSort" onchange="sortColumns()" class="sort-select">
                    <option value="name">Sort by Name</option>
                    <option value="quality">Sort by Quality</option>
                    <option value="completeness">Sort by Completeness</option>
                    <option value="issues">Sort by Issues</option>
                </select>
            </div>
        </div>
                            <div class="column-list" id="columnList">
                                
                                <div class="column-row" onclick="toggleColumnRow(this)" data-name="transaction_id" data-type="string" data-quality="100.0" data-completeness="100.0" data-issues="false">
                                    <div class="column-row-header">
                                        <span class="column-expand-icon">▶</span>
                                        <div class="column-type-icon string">💸</div>
                                        <div class="column-info">
                                            <div class="column-name-row">
                                                <span class="column-name">transaction_id</span>
                                                <span class="fibo-badge-mobile" title="Identifier (FIBO:Transaction)">💸 Identifier (FIBO:Transaction)</span>
                                            </div>
                                            <div class="column-type">string (100% confidence)</div>
                                        </div>
                                        <div class="column-quick-stats">
                                            <span>100% complete</span>
                                            <span>100.00% unique</span>
                                        </div>
                                        <div class="column-tags">
                                            <span class="column-tag fibo" title="🏦 Semantic type from FIBO (Financial Industry Business Ontology)">Identifier (FIBO:Transaction)</span>
                                        </div>
                                        <span class="column-quality-score good" title="Overall Quality Score: Combines completeness, validity, consistency, and uniqueness metrics">Quality 100%</span>
                                    </div>
                                    <div class="column-details">
                                        <div class="column-details-content">
                                            
            <div class="semantic-summary" style="padding: 10px 12px; background: var(--card-darker); border-radius: 8px; margin-bottom: 12px; border-left: 3px solid var(--primary);">
                <div style="font-size: 0.75em; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 6px;">
                    Field Meaning (FIBO)
                </div>
                
            <span style="display: inline-flex; align-items: center; gap: 4px; padding: 3px 10px; border-radius: 12px; font-size: 0.85em; background: rgba(102, 126, 234, 0.15); color: #818cf8; border: 1px solid rgba(102, 126, 234, 0.3);">
                🏦 Identifier (FIBO:Transaction)
            </span>
        
                
            </div>
        
                                            <div class="column-stats-grid">
                                            <div class="column-stat">
                                                <div class="column-stat-label">Row Count</div>
                                                <div class="column-stat-value">1,000</div>
                                            </div>
                                            <div class="column-stat">
                                                <div class="column-stat-label">Null Count</div>
                                                <div class="column-stat-value">0</div>
                                            </div>
                                            <div class="column-stat">
                                                <div class="column-stat-label">Unique Values</div>
                                                <div class="column-stat-value">1,000*</div>
                                            </div>
                                            <div class="column-stat">
                                                <div class="column-stat-label">Length</div>
                                                <div class="column-stat-value">5-13 chars</div>
                                            </div>
                                            <div class="column-stat">
                                                <div class="column-stat-label">Pattern</div>
                                                <div class="column-stat-value">AAA9999999999</div>
                                            </div></div>
                                            
                                            <div class="top-values-section">
                                                <div class="top-values-title">Top Values</div>
                                                <div class="top-values-grid">
                                                    <div class="top-value-item">
                                                        <span class="top-value-name">TXN0000000000</span>
                                                        <span class="top-value-count">1</span>
                                                    </div>
                                                    <div class="top-value-item">
                                                        <span class="top-value-name">TXN0000000001</span>
                                                        <span class="top-value-count">1</span>
                                                    </div>
                                                    <div class="top-value-item">
                                                        <span class="top-value-name">TXN0000000002</span>
                                                        <span class="top-value-count">1</span>
                                                    </div>
                                                    <div class="top-value-item">
                                                        <span class="top-value-name">TXN0000000003</span>
                                                        <span class="top-value-count">1</span>
                                                    </div>
                                                    <div class="top-value-item">
                                                        <span class="top-value-name">TXN0000000004</span>
                                                        <span class="top-value-count">1</span>
                                                    </div></div>
                                                <div class="sampled-note">Top 5 of 1,000 distinct values; full column scan used</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="column-row" onclick="toggleColumnRow(this)" data-name="customer_id" data-type="string" data-quality="99.4" data-completeness="98.0" data-issues="false">
                                    <div class="column-row-header">
                                        <span class="column-expand-icon">▶</span>
                                        <div class="column-type-icon string">🏷️</div>
                                        <div class="column-info">
                                            <div class="column-name-row">
                                                <span class="column-name">customer_id</span>
                                                <span class="fibo-badge-mobile" title="Identifier (FIBO:PartyIdentifier)">🏷️ Identifier (FIBO:PartyIdentifier)</span>
                                            </div>
                                            <div class="column-type">string (100% confidence)</div>
                                        </div>
                                        <div class="column-quick-stats">
                                            <span>98.0% complete</span>
                                            <span>100.00% unique</span>
                                        </div>
                                        <div class="column-tags">
                                            <span class="column-tag fibo" title="🏦 Semantic type from FIBO (Financial Industry Business Ontology)">Identifier (FIBO:PartyIdentifier)</span>
                                        </div>
                                        <span class="column-quality-score good" title="Overall Quality Score: Combines completeness, validity, consistency, and uniqueness metrics">Quality 99%</span>
                                    </div>
                                    <div class="column-details">
                                        <div class="column-details-content">
                                            
            <div class="semantic-summary" style="padding: 10px 12px; background: var(--card-darker); border-radius: 8px; margin-bottom: 12px; border-left: 3px solid var(--primary);">
                <div style="font-size: 0.75em; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 6px;">
                    Field Meaning (FIBO)
                </div>
                
            <span style="display: inline-flex; align-items: center; gap: 4px; padding: 3px 10px; border-radius: 12px; font-size: 0.85em; background: rgba(102, 126, 234, 0.15); color: #818cf8; border: 1px solid rgba(102, 126, 234, 0.3);">
                🏦 Identifier (FIBO:PartyIdentifier)
            </span>
        
                
            </div>
        
                                            <div class="column-stats-grid">
                                            <div class="column-stat">
                                                <div class="column-stat-label">Row Count</div>
                                                <div class="column-stat-value">1,000</div>
                                            </div>
                                            <div class="column-stat">
                                                <div class="column-stat-label">Null Count</div>
                                                <div class="column-stat-value">20</div>
                                            </div>
                                            <div class="column-stat">
                                                <div class="column-stat-label">Unique Values</div>
                                                <div class="column-stat-value">980*</div>
                                            </div>
                                            <div class="column-stat">
                                                <div class="column-stat-label">Length</div>
                                                <div class="column-stat-value">10-10 chars</div>
                                            </div>
                                            <div class="column-stat">
                                                <div class="column-stat-label">Pattern</div>
                                                <div class="column-stat-value">AAAA999999</div>
                                            </div>
                                            <div class="column-stat" style="background: rgba(var(--info-color-rgb), 0.1); border: 1px dashed var(--info-color);" title="Unique values tracked for Top Values (memory optimization for high-cardinality columns)">
                                                <div class="column-stat-label" style="color: var(--info-color);"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:12px;height:12px;vertical-align:-1px;margin-right:2px"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg> Values Tracked</div>
                                                <div class="column-stat-value" style="font-size: 0.75em;">980</div>
                                            </div></div>
                                            
                                            <div class="top-values-section">
                                                <div class="top-values-title">Top Values (sampled)</div>
                                                <div class="top-values-grid">
                                                    <div class="top-value-item">
                                                        <span class="top-value-name">CUST000001</span>
                                                        <span class="top-value-count">1</span>
                                                    </div>
                                                    <div class="top-value-item">
                                                        <span class="top-value-name">CUST000002</span>
                                                        <span class="top-value-count">1</span>
                                                    </div>
                                                    <div class="top-value-item">
                                                        <span class="top-value-name">CUST000003</span>
                                                        <span class="top-value-count">1</span>
                                                    </div>
                                                    <div class="top-value-item">
                                                        <span class="top-value-name">CUST000004</span>
                                                        <span class="top-value-count">1</span>
                                                    </div>
                                                    <div class="top-value-item">
                                                        <span class="top-value-name">CUST000005</span>
                                                        <span class="top-value-count">1</span>
                                                    </div></div>
                                                <div class="sampled-note">Based on 980 row sample of 1,000 total rows</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="column-row" onclick="toggleColumnRow(this)" data-name="amount" data-type="float" data-quality="88.4" data-completeness="100.0" data-issues="false">
                                    <div class="column-row-header">
                                        <span class="column-expand-icon">▶</span>
                                        <div class="column-type-icon number">🏷️</div>
                                        <div class="column-info">
                                            <div class="column-name-row">
                                                <span class="column-name">amount</span>
                                                <span class="fibo-badge-mobile" title="Monetary amount (FIBO:MonetaryAmount)">🏷️ Monetary amount (FIBO:MonetaryAmount)</span>
                                            </div>
                                            <div class="column-type">float (98% confidence)</div>
                                        </div>
                                        <div class="column-quick-stats">
                                            <span>100% complete</span>
                                            <span>93.00% unique</span>
                                        </div>
                                        <div class="column-tags">
                                            <span class="column-tag fibo" title="🏦 Semantic type from FIBO (Financial Industry Business Ontology)">Monetary amount (FIBO:MonetaryAmount)</span>
                                        </div>
                                        <span class="column-quality-score good" title="Overall Quality Score: Combines completeness, validity, consistency, and uniqueness metrics">Quality 88%</span>
                                    </div>
                                    <div class="column-details">
                                        <div class="column-details-content">
                                            
            <div class="semantic-summary" style="padding: 10px 12px; background: var(--card-darker); border-radius: 8px; margin-bottom: 12px; border-left: 3px solid var(--primary);">
                <div style="font-size: 0.75em; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 6px;">
                    Field Meaning (FIBO)
                </div>
                
            <span style="display: inline-flex; align-items: center; gap: 4px; padding: 3px 10px; border-radius: 12px; font-size: 0.85em; background: rgba(102, 126, 234, 0.15); color: #818cf8; border: 1px solid rgba(102, 126, 234, 0.3);">
                🏦 Monetary amount (FIBO:MonetaryAmount)
            </span>
        
                
            </div>
        
                                            <div class="column-stats-grid">
                                            <div class="column-stat">
                                                <div class="column-stat-label">Row Count</div>
                                                <div class="column-stat-value">1,000</div>
                                            </div>
                                            <div class="column-stat">
                                                <div class="column-stat-label">Null Count</div>
                                                <div class="column-stat-value">0</div>
                                            </div>
                                            <div class="column-stat">
                                                <div class="column-stat-label">Unique Values</div>
                                                <div class="column-stat-value">930</div>
                                            </div>
                                            <div class="column-stat">
                                                <div class="column-stat-label">Mean</div>
                                                <div class="column-stat-value">101.94</div>
                                            </div>
                                            <div class="column-stat">
                                                <div class="column-stat-label">Median</div>
                                                <div class="column-stat-value">100.53</div>
                                            </div>
                                            <div class="column-stat">
                                                <div class="column-stat-label">Std Dev</div>
                                                <div class="column-stat-value">34.94</div>
                                            </div>
                                            <div class="column-stat">
                                                <div class="column-stat-label">Min</div>
                                                <div class="column-stat-value">5.00</div>
                                            </div>
                                            <div class="column-stat">
                                                <div class="column-stat-label">Max</div>
                                                <div class="column-stat-value">500.00</div>
                                            </div></div>
                                            
                                            <div class="top-values-section">
                                                <div class="top-values-title">Top Values</div>
                                                <div class="top-values-grid">
                                                    <div class="top-value-item">
                                                        <span class="top-value-name">500.0</span>
                                                        <span class="top-value-count">5</span>
                                                    </div>
                                                    <div class="top-value-item">
                                                        <span class="top-value-name">5.0</span>
                                                        <span class="top-value-count">5</span>
                                                    </div>
                                                    <div class="top-value-item">
                                                        <span class="top-value-name">104.48</span>
                                                        <span class="top-value-count">3</span>
                                                    </div>
                                                    <div class="top-value-item">
                                                        <span class="top-value-name">88.46</span>
                                                        <span class="top-value-count">3</span>
                                                    </div>
                                                    <div class="top-value-item">
                                                        <span class="top-value-name">125.55</span>
                                                        <span class="top-value-count">2</span>
                                                    </div></div>
                                                <div class="sampled-note">Top 5 of 930 distinct values; full column scan used</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="column-row" onclick="toggleColumnRow(this)" data-name="status" data-type="string" data-quality="80.0" data-completeness="100.0" data-issues="false">
                                    <div class="column-row-header">
                                        <span class="column-expand-icon">▶</span>
                                        <div class="column-type-icon string">🏷️</div>
                                        <div class="column-info">
                                            <div class="column-name-row">
                                                <span class="column-name">status</span>
                                                <span class="fibo-badge-mobile" title="Category (schema:CategoryCode)">🏷️ Category (schema:CategoryCode)</span>
                                            </div>
                                            <div class="column-type">string (100% confidence)</div>
                                        </div>
                                        <div class="column-quick-stats">
                                            <span>100% complete</span>
                                            <span>0.10% unique</span>
                                        </div>
                                        <div class="column-tags">
                                            <span class="column-tag semantic" title="🌐 Semantic type from Schema.org">Category (schema:CategoryCode)</span>
                                        </div>
                                        <span class="column-quality-score good" title="Overall Quality Score: Combines completeness, validity, consistency, and uniqueness metrics">Quality 80%</span>
                                    </div>
                                    <div class="column-details">
                                        <div class="column-details-content">
                                            
            <div class="semantic-summary" style="padding: 10px 12px; background: var(--card-darker); border-radius: 8px; margin-bottom: 12px; border-left: 3px solid var(--primary);">
                <div style="font-size: 0.75em; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 6px;">
                    Field Meaning (Schema.org)
                </div>
                
            <span style="display: inline-flex; align-items: center; gap: 4px; padding: 3px 10px; border-radius: 12px; font-size: 0.85em; background: rgba(59, 130, 246, 0.15); color: #60a5fa; border: 1px solid rgba(59, 130, 246, 0.3);">
                🏷️ Category (schema:CategoryCode)
            </span>
        
                
            <div style="color: var(--text-secondary); font-size: 0.85em; margin-top: 6px; line-height: 1.4;">
                This field uses a small set of short codes to represent categories, locations, or statuses.
            </div>
        
            </div>
        
                                            <div class="column-stats-grid">
                                            <div class="column-stat">
                                                <div class="column-stat-label">Row Count</div>
                                                <div class="column-stat-value">1,000</div>
                                            </div>
                                            <div class="column-stat">
                                                <div class="column-stat-label">Null Count</div>
                                                <div class="column-stat-value">0</div>
                                            </div>
                                            <div class="column-stat">
                                                <div class="column-stat-label">Unique Values</div>
                                                <div class="column-stat-value">1*</div>
                                            </div>
                                            <div class="column-stat">
                                                <div class="column-stat-label">Length</div>
                                                <div class="column-stat-value">9-9 chars</div>
                                            </div>
                                            <div class="column-stat">
                                                <div class="column-stat-label">Pattern</div>
                                                <div class="column-stat-value">AAAAAAAAA</div>
                                            </div>
                                            <div class="column-stat" style="background: rgba(var(--info-color-rgb), 0.1); border: 1px dashed var(--info-color);" title="Unique values tracked for Top Values (memory optimization for high-cardinality columns)">
                                                <div class="column-stat-label" style="color: var(--info-color);"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:12px;height:12px;vertical-align:-1px;margin-right:2px"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg> Values Tracked</div>
                                                <div class="column-stat-value" style="font-size: 0.75em;">1</div>
                                            </div></div>
                                            
                                            <div class="top-values-section">
                                                <div class="top-values-title">Value Distribution</div>
                                                <div class="top-values-grid">
                                                    <div class="top-value-item">
                                                        <span class="top-value-name">COMPLETED</span>
                                                        <span class="top-value-count">1,000</span>
                                                    </div></div>
                                                <div class="sampled-note">Values tracked: 1 distinct categories</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- 6. RECOMMENDED VALIDATIONS                                      -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <div class="section-accordion expanded" id="section-validations" style="--section-accent: #10b981; --section-accent-dark: #059669;">
            <div class="section-accordion-header" onclick="toggleSectionAccordion(this)">
                <div class="section-accordion-icon">
                    <svg style="width: 20px; height: 20px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-check-square"/></svg>
                </div>
                <div class="section-accordion-content-wrap">
                    <h2 class="section-accordion-title">Validations</h2>
                    <p class="section-accordion-subtitle">Suggested data quality rules</p>
                </div>
                <div class="section-accordion-meta">
                    <div class="section-accordion-badge">Action</div>
                    <span class="section-accordion-chevron"><svg style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-chevron-down"/></svg></span>
                </div>
            </div>
            <div class="section-accordion-content">
                <!-- Validation Suggestions -->
                
                <div class="accordion" data-accordion="suggestions">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <div class="accordion-title-group">
                            <div class="accordion-icon quality"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:16px;height:16px;color:white"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg></div>
                            <div>
                                <div class="accordion-title">Validation Suggestions</div>
                                <div class="accordion-subtitle">9 suggested checks</div>
                            </div>
                        </div>
                        <div class="accordion-meta">
                            <span class="accordion-badge info">9 suggestions</span>
                            <span class="accordion-chevron"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:14px;height:14px"><polyline points="6 9 12 15 18 9"/></svg></span>
                        </div>
                    </div>
                    <div class="accordion-body">
                        <div class="accordion-content">
                            <div class="dual-layer-explanation">
                                <div class="dual-layer-summary">
                                    <div class="dual-layer-summary-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M12 2a7 7 0 0 0-4 12.7V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.3A7 7 0 0 0 12 2z"/></svg> What this means</div>
                                    <div class="dual-layer-summary-text">
                                        Auto-generated validation rules based on profiled column characteristics. Each rule includes ready-to-use YAML configuration for the DataK9 validation framework.
                                    </div>
                                </div>
                                <details class="dual-layer-technical">
                                    <summary><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg> Technical Details</summary>
                                    <div class="dual-layer-technical-content" style="padding: 12px;">
                                        <ul style="margin: 0; padding-left: 20px; color: var(--text-secondary); font-size: 0.85em;">
                                            <li>Suggestions are derived from column statistics, patterns, and anomalies</li>
                                            <li>Higher confidence scores indicate stronger signals from the data</li>
                                            <li>Each YAML snippet can be copied directly into your validation config</li>
                                        </ul>
                                    </div>
                                </details>
                            </div>
                            
                            <div class="suggestion-card high-priority">
                                <div class="suggestion-header">
                                    <div class="suggestion-type">EmptyFileCheck</div>
                                    <div class="suggestion-confidence">100% confidence</div>
                                </div>
                                
                                <div class="suggestion-reason">Prevent empty file loads</div>
                                <div class="suggestion-yaml-container">
                                    <pre class="suggestion-yaml">      - type: "EmptyFileCheck"
        severity: "ERROR"</pre>
                                    <button class="copy-yaml-btn" onclick="copyYaml(`      - type: "EmptyFileCheck"
        severity: "ERROR"`)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:12px;height:12px;vertical-align:-1px;margin-right:3px"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> Copy</button>
                                </div>
                            </div>
                            <div class="suggestion-card ">
                                <div class="suggestion-header">
                                    <div class="suggestion-type">RowCountRangeCheck</div>
                                    <div class="suggestion-confidence">80% confidence</div>
                                </div>
                                
                                <div class="suggestion-reason">Expect approximately 1000 rows based on profile</div>
                                <div class="suggestion-yaml-container">
                                    <pre class="suggestion-yaml">      - type: "RowCountRangeCheck"
        severity: "ERROR"
          min_rows: 500
          max_rows: 2000</pre>
                                    <button class="copy-yaml-btn" onclick="copyYaml(`      - type: "RowCountRangeCheck"
        severity: "ERROR"\n          min_rows: 500\n          max_rows: 2000`)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:12px;height:12px;vertical-align:-1px;margin-right:3px"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> Copy</button>
                                </div>
                            </div>
                            <div class="suggestion-card ">
                                <div class="suggestion-header">
                                    <div class="suggestion-type">UniqueKeyCheck</div>
                                    <div class="suggestion-confidence">80% confidence</div>
                                </div>
                                <div class="suggestion-field">Field: <strong>transaction_id</strong></div>
                                <div class="suggestion-reason">High cardinality suggests unique identifier</div>
                                <div class="suggestion-yaml-container">
                                    <pre class="suggestion-yaml">      - type: "UniqueKeyCheck"
        severity: "WARNING"
          fields:
            - "transaction_id"</pre>
                                    <button class="copy-yaml-btn" onclick="copyYaml(`      - type: "UniqueKeyCheck"
        severity: "WARNING"\n          fields:\n            - "transaction_id"`)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:12px;height:12px;vertical-align:-1px;margin-right:3px"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> Copy</button>
                                </div>
                            </div>
                            <div class="suggestion-card ">
                                <div class="suggestion-header">
                                    <div class="suggestion-type">StringLengthCheck</div>
                                    <div class="suggestion-confidence">75% confidence</div>
                                </div>
                                
                                <div class="suggestion-reason">String length range: 5-13 chars</div>
                                <div class="suggestion-yaml-container">
                                    <pre class="suggestion-yaml">      - type: "StringLengthCheck"
        severity: "WARNING"
          field: "transaction_id"
          min_length: 4
          max_length: 23</pre>
                                    <button class="copy-yaml-btn" onclick="copyYaml(`      - type: "StringLengthCheck"
        severity: "WARNING"\n          field: "transaction_id"\n          min_length: 4\n          max_length: 23`)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:12px;height:12px;vertical-align:-1px;margin-right:3px"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> Copy</button>
                                </div>
                            </div>
                            <div class="suggestion-card ">
                                <div class="suggestion-header">
                                    <div class="suggestion-type">StringLengthCheck</div>
                                    <div class="suggestion-confidence">75% confidence</div>
                                </div>
                                
                                <div class="suggestion-reason">String length range: 10-10 chars</div>
                                <div class="suggestion-yaml-container">
                                    <pre class="suggestion-yaml">      - type: "StringLengthCheck"
        severity: "WARNING"
          field: "customer_id"
          min_length: 9
          max_length: 20</pre>
                                    <button class="copy-yaml-btn" onclick="copyYaml(`      - type: "StringLengthCheck"
        severity: "WARNING"\n          field: "customer_id"\n          min_length: 9\n          max_length: 20`)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:12px;height:12px;vertical-align:-1px;margin-right:3px"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> Copy</button>
                                </div>
                            </div>
                            <div class="suggestion-card high-priority">
                                <div class="suggestion-header">
                                    <div class="suggestion-type">RangeCheck</div>
                                    <div class="suggestion-confidence">90% confidence</div>
                                </div>
                                
                                <div class="suggestion-reason">Price/amount field: must be non-negative</div>
                                <div class="suggestion-yaml-container">
                                    <pre class="suggestion-yaml">      - type: "RangeCheck"
        severity: "WARNING"
          field: "amount"
          min_value: 0
          max_value: null</pre>
                                    <button class="copy-yaml-btn" onclick="copyYaml(`      - type: "RangeCheck"
        severity: "WARNING"\n          field: "amount"\n          min_value: 0\n          max_value: null`)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:12px;height:12px;vertical-align:-1px;margin-right:3px"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> Copy</button>
                                </div>
                            </div>
                            <div class="suggestion-card high-priority">
                                <div class="suggestion-header">
                                    <div class="suggestion-type">ValidValuesCheck</div>
                                    <div class="suggestion-confidence">85% confidence</div>
                                </div>
                                
                                <div class="suggestion-reason">Low cardinality (1 unique values)</div>
                                <div class="suggestion-yaml-container">
                                    <pre class="suggestion-yaml">      - type: "ValidValuesCheck"
        severity: "WARNING"
          field: "status"
          valid_values:
            - "COMPLETED"</pre>
                                    <button class="copy-yaml-btn" onclick="copyYaml(`      - type: "ValidValuesCheck"
        severity: "WARNING"\n          field: "status"\n          valid_values:\n            - "COMPLETED"`)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:12px;height:12px;vertical-align:-1px;margin-right:3px"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> Copy</button>
                                </div>
                            </div>
                            <div class="suggestion-card ">
                                <div class="suggestion-header">
                                    <div class="suggestion-type">StringLengthCheck</div>
                                    <div class="suggestion-confidence">75% confidence</div>
                                </div>
                                
                                <div class="suggestion-reason">String length range: 9-9 chars</div>
                                <div class="suggestion-yaml-container">
                                    <pre class="suggestion-yaml">      - type: "StringLengthCheck"
        severity: "WARNING"
          field: "status"
          min_length: 8
          max_length: 19</pre>
                                    <button class="copy-yaml-btn" onclick="copyYaml(`      - type: "StringLengthCheck"
        severity: "WARNING"\n          field: "status"\n          min_length: 8\n          max_length: 19`)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:12px;height:12px;vertical-align:-1px;margin-right:3px"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> Copy</button>
                                </div>
                            </div>
                            <div class="suggestion-card high-priority">
                                <div class="suggestion-header">
                                    <div class="suggestion-type">MandatoryFieldCheck</div>
                                    <div class="suggestion-confidence">95% confidence</div>
                                </div>
                                <div class="suggestion-field">Field: <strong>transaction_id</strong></div>
                                <div class="suggestion-reason">Fields with >95% completeness: transaction_id, customer_id, amount, status</div>
                                <div class="suggestion-yaml-container">
                                    <pre class="suggestion-yaml">      - type: "MandatoryFieldCheck"
        severity: "ERROR"
          fields:
            - "transaction_id"
            - "customer_id"
            - "amount"
            - "status"</pre>
                                    <button class="copy-yaml-btn" onclick="copyYaml(`      - type: "MandatoryFieldCheck"
        severity: "ERROR"\n          fields:\n            - "transaction_id"\n            - "customer_id"\n            - "amount"\n            - "status"`)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:12px;height:12px;vertical-align:-1px;margin-right:3px"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> Copy</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Full Validation Config -->
                
                <div class="accordion" data-accordion="config" id="section-yaml">
                    <div class="accordion-header" onclick="toggleAccordion(this)">
                        <div class="accordion-title-group">
                            <div class="accordion-icon quality"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:20px;height:20px"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg></div>
                            <div>
                                <div class="accordion-title">YAML / Export</div>
                                <div class="accordion-subtitle">Ready-to-use validation configuration</div>
                            </div>
                        </div>
                        <div class="accordion-meta">
                            <span class="accordion-badge good">Ready</span>
                            <span class="accordion-chevron"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:14px;height:14px"><polyline points="6 9 12 15 18 9"/></svg></span>
                        </div>
                    </div>
                    <div class="accordion-body">
                        <div class="accordion-content">
                            <div class="dual-layer-explanation">
                                <div class="dual-layer-summary">
                                    <div class="dual-layer-summary-label"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:16px;height:16px"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M12 2a7 7 0 0 0-4 12.7V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.3A7 7 0 0 0 12 2z"/></svg> What this means</div>
                                    <div class="dual-layer-summary-text">
                                        Complete validation configuration generated from profile analysis. Copy to a .yaml file and run with: <code style="background: var(--bg-elevated); padding: 2px 6px; border-radius: 4px;">python3 -m validation_framework.cli validate config.yaml</code>
                                    </div>
                                </div>
                                <details class="dual-layer-technical">
                                    <summary><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg> Technical Details</summary>
                                    <div class="dual-layer-technical-content" style="padding: 12px;">
                                        <ul style="margin: 0; padding-left: 20px; color: var(--text-secondary); font-size: 0.85em;">
                                            <li>Run command: <code>python3 -m validation_framework.cli validate config.yaml</code></li>
                                            <li>Configuration includes all suggested validations from the profile</li>
                                            <li>Adjust thresholds and parameters based on your specific requirements</li>
                                        </ul>
                                    </div>
                                </details>
                            </div>
                            <div class="full-config-container">
                                <div class="config-actions">
                                    <button class="copy-config-btn" onclick="copyFullConfig()"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:12px;height:12px;vertical-align:-1px;margin-right:3px"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg> Copy Full Config</button>
                                </div>
                                <pre class="full-config-yaml" id="fullConfigYaml"># Auto-generated validation configuration
# Generated from profile of: transactions.csv
# Generated at: 2025-12-02 12:51:21
# File size: 0.0 MB, Rows: 1,000
# Recommended chunk size: 2,000,000 rows (Using maximum chunk size (2,000,000). Sufficient memory available.)

validation_job:
  name: "Validation for transactions.csv"
  description: "Auto-generated from data profile"

settings:
  chunk_size: 2000000  # Optimized for csv format, 9 validations (complex complexity)
  max_sample_failures: 100

files:
  - name: "transactions"
    path: "examples/sample_data/transactions.csv"
    format: "csv"

    validations:
      - type: "EmptyFileCheck"
        severity: "ERROR"
        # Prevent empty file loads

      - type: "RowCountRangeCheck"
        severity: "ERROR"
        params:
          min_rows: 500
          max_rows: 2000
        # Expect approximately 1000 rows based on profile

      - type: "UniqueKeyCheck"
        severity: "WARNING"
        params:
          fields:
            - "transaction_id"
        # High cardinality suggests unique identifier

      - type: "StringLengthCheck"
        severity: "WARNING"
        params:
          field: "transaction_id"
          min_length: 4
          max_length: 23
        # String length range: 5-13 chars

      - type: "StringLengthCheck"
        severity: "WARNING"
        params:
          field: "customer_id"
          min_length: 9
          max_length: 20
        # String length range: 10-10 chars

      - type: "RangeCheck"
        severity: "WARNING"
        params:
          field: "amount"
          min_value: 0
          max_value: None
        # Price/amount field: must be non-negative

      - type: "ValidValuesCheck"
        severity: "WARNING"
        params:
          field: "status"
          valid_values:
            - "COMPLETED"
        # Low cardinality (1 unique values)

      - type: "StringLengthCheck"
        severity: "WARNING"
        params:
          field: "status"
          min_length: 8
          max_length: 19
        # String length range: 9-9 chars

      - type: "MandatoryFieldCheck"
        severity: "ERROR"
        params:
          fields:
            - "transaction_id"
            - "customer_id"
            - "amount"
            - "status"
        # Fields with &gt;95% completeness: transaction_id, customer_id, amount, status
</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- 7. DATA LINEAGE & PROVENANCE                                    -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        
        <div class="section-accordion expanded" id="section-lineage" style="--section-accent: #8b5cf6; --section-accent-dark: #7c3aed;">
            <div class="section-accordion-header" onclick="toggleSectionAccordion(this)">
                <div class="section-accordion-icon">
                    <svg style="width: 20px; height: 20px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-git-branch"/></svg>
                </div>
                <div class="section-accordion-content-wrap">
                    <h2 class="section-accordion-title">Lineage</h2>
                    <p class="section-accordion-subtitle">Where your data came from</p>
                </div>
                <div class="section-accordion-meta">
                    <div class="section-accordion-badge">CSV_FILE</div>
                    <span class="section-accordion-chevron"><svg style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-chevron-down"/></svg></span>
                </div>
            </div>
            <div class="section-accordion-content">
                <!-- Source Information -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 16px; margin-bottom: 16px;">
                    <div style="background: var(--bg-card); border-radius: 8px; padding: 16px; border: 1px solid var(--border-color);">
                        <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 12px; font-size: 0.9em;">
                            <svg style="width: 14px; height: 14px; vertical-align: -2px; margin-right: 6px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/></svg>
                            Source Details
                        </div>
                        <div style="font-size: 0.8em; line-height: 1.8;">
                            <div style="display: flex; justify-content: space-between; padding: 4px 0; border-bottom: 1px solid var(--border-color);">
                                <span style="color: var(--text-muted);">Path</span>
                                <span style="color: var(--text-primary); font-family: monospace; font-size: 0.85em; max-width: 200px; overflow: hidden; text-overflow: ellipsis;" title="/home/daniel/www/dqa/data-validation-tool/examples/sample_data/transactions.csv">transactions.csv</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 4px 0; border-bottom: 1px solid var(--border-color);">
                                <span style="color: var(--text-muted);">Size</span>
                                <span style="color: var(--text-primary); font-weight: 500;">39.97 KB</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 4px 0; border-bottom: 1px solid var(--border-color);">
                                <span style="color: var(--text-muted);">Modified</span>
                                <span style="color: var(--text-primary);">2025-11-12T14:19:12.654068</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 4px 0;">
                                <span style="color: var(--text-muted);">Type</span>
                                <span style="color: var(--text-primary);">CSV_FILE</span>
                            </div>
                        </div>
                    </div>

                    <div style="background: var(--bg-card); border-radius: 8px; padding: 16px; border: 1px solid var(--border-color);">
                        <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 12px; font-size: 0.9em;">
                            <svg style="width: 14px; height: 14px; vertical-align: -2px; margin-right: 6px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0110 0v4"/></svg>
                            Integrity Verification
                        </div>
                        <div style="font-size: 0.8em;">
                            <div style="color: var(--text-muted); margin-bottom: 4px;">SHA-256 Hash</div>
                            <div style="background: rgba(0,0,0,0.3); padding: 8px 12px; border-radius: 4px; font-family: monospace; font-size: 0.85em; color: #a78bfa; word-break: break-all;" title="063c42ff6ad12a30c1b069f2c6eda517fea491dccf40a784e7ed27cf4d54ab3f">063c42ff6ad12a30c1b069f2c6eda517fea491dccf40a784e7ed27cf4d54ab3f</div>
                            <div style="margin-top: 8px; color: var(--text-muted); font-size: 0.75em;">Use this hash to verify data integrity and detect tampering</div>
                        </div>
                    </div>
                </div>

                <!-- Processing Info -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 16px;">
                    <div style="background: var(--bg-card); border-radius: 8px; padding: 16px; border: 1px solid var(--border-color);">
                        <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 12px; font-size: 0.9em;">
                            <svg style="width: 14px; height: 14px; vertical-align: -2px; margin-right: 6px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                            Processing Record
                        </div>
                        <div style="font-size: 0.8em; line-height: 1.8;">
                            <div style="display: flex; justify-content: space-between; padding: 4px 0; border-bottom: 1px solid var(--border-color);">
                                <span style="color: var(--text-muted);">Profiled At</span>
                                <span style="color: var(--text-primary);">2025-12-02T12:51:22.040148</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 4px 0; border-bottom: 1px solid var(--border-color);">
                                <span style="color: var(--text-muted);">Profiler Version</span>
                                <span style="color: var(--text-primary);">DataK9 v1.55</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 4px 0;">
                                <span style="color: var(--text-muted);">Host</span>
                                <span style="color: var(--text-primary);">open-codeserver</span>
                            </div>
                        </div>
                    </div>

                    <div style="background: var(--bg-card); border-radius: 8px; padding: 16px; border: 1px solid var(--border-color);">
                        <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 12px; font-size: 0.9em;">
                            <svg style="width: 14px; height: 14px; vertical-align: -2px; margin-right: 6px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
                            Analysis Applied
                        </div>
                        <div style="font-size: 0.8em;">
                            <span style="display: inline-block; background: rgba(59, 130, 246, 0.15); color: #60a5fa; padding: 4px 10px; border-radius: 4px; font-size: 0.75em; margin: 2px 4px 2px 0; font-weight: 500;">Basic Statistics</span><span style="display: inline-block; background: rgba(59, 130, 246, 0.15); color: #60a5fa; padding: 4px 10px; border-radius: 4px; font-size: 0.75em; margin: 2px 4px 2px 0; font-weight: 500;">Type Inference</span><span style="display: inline-block; background: rgba(59, 130, 246, 0.15); color: #60a5fa; padding: 4px 10px; border-radius: 4px; font-size: 0.75em; margin: 2px 4px 2px 0; font-weight: 500;">Pattern Detection</span><span style="display: inline-block; background: rgba(59, 130, 246, 0.15); color: #60a5fa; padding: 4px 10px; border-radius: 4px; font-size: 0.75em; margin: 2px 4px 2px 0; font-weight: 500;">Temporal Analysis</span><span style="display: inline-block; background: rgba(59, 130, 246, 0.15); color: #60a5fa; padding: 4px 10px; border-radius: 4px; font-size: 0.75em; margin: 2px 4px 2px 0; font-weight: 500;">Pii Detection</span><span style="display: inline-block; background: rgba(59, 130, 246, 0.15); color: #60a5fa; padding: 4px 10px; border-radius: 4px; font-size: 0.75em; margin: 2px 4px 2px 0; font-weight: 500;">Ml Analysis</span><span style="display: inline-block; background: rgba(59, 130, 246, 0.15); color: #60a5fa; padding: 4px 10px; border-radius: 4px; font-size: 0.75em; margin: 2px 4px 2px 0; font-weight: 500;">Semantic Classification</span>
                        </div>
                    </div>
                </div>

                

                <!-- Export for Audit -->
                <div style="margin-top: 16px; padding: 12px; background: rgba(167, 139, 250, 0.08); border-radius: 6px; border: 1px dashed rgba(167, 139, 250, 0.3);">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div style="font-size: 0.85em; font-weight: 500; color: var(--text-primary);">
                                <svg style="width: 14px; height: 14px; vertical-align: -2px; margin-right: 6px;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"/><path d="M17 21v-8H7v8M7 3v5h8"/></svg>
                                Audit Export
                            </div>
                            <div style="font-size: 0.75em; color: var(--text-muted);">Full lineage data is included in JSON output for audit trails and compliance reporting</div>
                        </div>
                        <span style="background: rgba(167, 139, 250, 0.2); color: #a78bfa; padding: 4px 10px; border-radius: 4px; font-size: 0.7em; font-weight: 600;">JSON EXPORT</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- 13. GLOSSARY SECTION                                            -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <div class="section-accordion expanded" id="section-glossary" style="--section-accent: #64748b; --section-accent-dark: #475569;">
            <div class="section-accordion-header" onclick="toggleSectionAccordion(this)">
                <div class="section-accordion-icon">
                    <svg style="width: 20px; height: 20px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-book-open"/></svg>
                </div>
                <div class="section-accordion-content-wrap">
                    <h2 class="section-accordion-title">Glossary</h2>
                    <p class="section-accordion-subtitle">Key terms explained</p>
                </div>
                <div class="section-accordion-meta">
                    <div class="section-accordion-badge">Reference</div>
                    <span class="section-accordion-chevron"><svg style="width: 16px; height: 16px; vertical-align: -2px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round;"><use href="#icon-chevron-down"/></svg></span>
                </div>
            </div>
            <div class="section-accordion-content">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 16px;">
                    <!-- Data Quality Metrics -->
                    <div style="background: var(--bg-card); border-radius: 8px; padding: 16px; border-left: 3px solid #3b82f6;">
                        <h4 style="margin: 0 0 12px 0; font-size: 0.9em; color: #3b82f6; text-transform: uppercase; letter-spacing: 0.5px;">Quality Metrics</h4>
                        <dl style="margin: 0; font-size: 0.85em;">
                            <dt style="font-weight: 600; color: var(--text-primary); margin-top: 8px;">Completeness</dt>
                            <dd style="margin: 4px 0 0 0; color: var(--text-secondary);">Percentage of non-null values in a field. Higher is better for required fields.</dd>

                            <dt style="font-weight: 600; color: var(--text-primary); margin-top: 12px;">Validity</dt>
                            <dd style="margin: 4px 0 0 0; color: var(--text-secondary);">Percentage of values that match expected format/type. Based on pattern consistency.</dd>

                            <dt style="font-weight: 600; color: var(--text-primary); margin-top: 12px;">Uniqueness</dt>
                            <dd style="margin: 4px 0 0 0; color: var(--text-secondary);">Ratio of distinct values to total values. Important for ID fields (should be 100%).</dd>

                            <dt style="font-weight: 600; color: var(--text-primary); margin-top: 12px;">Consistency</dt>
                            <dd style="margin: 4px 0 0 0; color: var(--text-secondary);">How well values follow a single pattern/format. Measures data standardization.</dd>
                        </dl>
                    </div>

                    <!-- Statistical Terms -->
                    <div style="background: var(--bg-card); border-radius: 8px; padding: 16px; border-left: 3px solid #8b5cf6;">
                        <h4 style="margin: 0 0 12px 0; font-size: 0.9em; color: #8b5cf6; text-transform: uppercase; letter-spacing: 0.5px;">Statistical Terms</h4>
                        <dl style="margin: 0; font-size: 0.85em;">
                            <dt style="font-weight: 600; color: var(--text-primary); margin-top: 8px;">IQR (Interquartile Range)</dt>
                            <dd style="margin: 4px 0 0 0; color: var(--text-secondary);">Range between 25th and 75th percentiles. Values beyond 1.5×IQR are outliers.</dd>

                            <dt style="font-weight: 600; color: var(--text-primary); margin-top: 12px;">Cardinality</dt>
                            <dd style="margin: 4px 0 0 0; color: var(--text-secondary);">Number of unique values. Low cardinality (≤10) suggests categorical data.</dd>

                            <dt style="font-weight: 600; color: var(--text-primary); margin-top: 12px;">Skewness</dt>
                            <dd style="margin: 4px 0 0 0; color: var(--text-secondary);">Measure of distribution asymmetry. Positive = right tail, negative = left tail.</dd>

                            <dt style="font-weight: 600; color: var(--text-primary); margin-top: 12px;">Kurtosis</dt>
                            <dd style="margin: 4px 0 0 0; color: var(--text-secondary);">Measure of distribution "tailedness". High = more outliers than normal distribution.</dd>
                        </dl>
                    </div>

                    <!-- ML/Anomaly Terms -->
                    <div style="background: var(--bg-card); border-radius: 8px; padding: 16px; border-left: 3px solid #ef4444;">
                        <h4 style="margin: 0 0 12px 0; font-size: 0.9em; color: #ef4444; text-transform: uppercase; letter-spacing: 0.5px;">Anomaly Detection</h4>
                        <dl style="margin: 0; font-size: 0.85em;">
                            <dt style="font-weight: 600; color: var(--text-primary); margin-top: 8px;">Isolation Forest</dt>
                            <dd style="margin: 4px 0 0 0; color: var(--text-secondary);">ML algorithm that isolates anomalies by random partitioning. Unusual points are easier to isolate.</dd>

                            <dt style="font-weight: 600; color: var(--text-primary); margin-top: 12px;">Reconstruction Error</dt>
                            <dd style="margin: 4px 0 0 0; color: var(--text-secondary);">How poorly a model recreates a data point. High error = unusual pattern combination.</dd>

                            <dt style="font-weight: 600; color: var(--text-primary); margin-top: 12px;">Benford's Law</dt>
                            <dd style="margin: 4px 0 0 0; color: var(--text-secondary);">Natural distribution of leading digits. Real-world data follows this; deviations may indicate fraud.</dd>

                            <dt style="font-weight: 600; color: var(--text-primary); margin-top: 12px;">DBSCAN Clustering</dt>
                            <dd style="margin: 4px 0 0 0; color: var(--text-secondary);">Groups similar records together. Points not fitting any cluster are labeled "noise" (potential anomalies).</dd>
                        </dl>
                    </div>

                    <!-- Semantic Terms -->
                    <div style="background: var(--bg-card); border-radius: 8px; padding: 16px; border-left: 3px solid #10b981;">
                        <h4 style="margin: 0 0 12px 0; font-size: 0.9em; color: #10b981; text-transform: uppercase; letter-spacing: 0.5px;">Semantic Analysis</h4>
                        <dl style="margin: 0; font-size: 0.85em;">
                            <dt style="font-weight: 600; color: var(--text-primary); margin-top: 8px;">Semantic Type</dt>
                            <dd style="margin: 4px 0 0 0; color: var(--text-secondary);">The meaning/purpose of data (e.g., Email, Currency, Date) beyond its technical type.</dd>

                            <dt style="font-weight: 600; color: var(--text-primary); margin-top: 12px;">PII (Personally Identifiable Information)</dt>
                            <dd style="margin: 4px 0 0 0; color: var(--text-secondary);">Data that can identify an individual: names, emails, SSN, phone numbers, addresses.</dd>

                            <dt style="font-weight: 600; color: var(--text-primary); margin-top: 12px;">Schema.org</dt>
                            <dd style="margin: 4px 0 0 0; color: var(--text-secondary);">Web vocabulary for structured data. Used for standardized semantic type mapping.</dd>

                            <dt style="font-weight: 600; color: var(--text-primary); margin-top: 12px;">FIBO (Financial Industry Business Ontology)</dt>
                            <dd style="margin: 4px 0 0 0; color: var(--text-secondary);">Standard vocabulary for financial concepts. Used for finance-specific semantic types.</dd>
                        </dl>
                    </div>
                </div>
            </div>
        </div>
    </main>
    </div><!-- end dq-main-layout -->

    <script>

        // Accordion toggle - uses 'collapsed' class (content visible by default)
        function toggleAccordion(header) {
            const accordion = header.closest('.accordion');
            accordion.classList.toggle('collapsed');
        }

        // Section accordion toggle - uses 'expanded' class (content hidden by default)
        function toggleSectionAccordion(header) {
            const section = header.closest('.section-accordion');
            section.classList.toggle('expanded');
        }

        // Safari-compatible: Sections start expanded to ensure content renders, then collapse after load
        document.addEventListener('DOMContentLoaded', function() {
            // Small delay to ensure all content (charts, etc.) has rendered
            setTimeout(function() {
                document.querySelectorAll('.section-accordion.expanded').forEach(function(section) {
                    section.classList.remove('expanded');
                });
            }, 150);  // 150ms delay for Safari to paint content before hiding
        });

        // Column row toggle
        function toggleColumnRow(row) {
            row.classList.toggle('expanded');
        }

        // ======================================================
        // EXPAND ALL TOGGLE
        // ======================================================
        let allExpanded = false;  // Will be collapsed after initial render (Safari workaround)

        function toggleExpandAll() {
            const btn = document.getElementById('expandAllBtn');
            allExpanded = !allExpanded;

            // Update button appearance
            btn.classList.toggle('expanded', allExpanded);
            btn.innerHTML = allExpanded
                ? '<span class="expand-icon">-</span> Collapse All'
                : '<span class="expand-icon">+</span> Expand All';

            // Toggle all accordions (using 'collapsed' class)
            document.querySelectorAll('.accordion').forEach(acc => {
                if (allExpanded) {
                    acc.classList.remove('collapsed');
                } else {
                    acc.classList.add('collapsed');
                }
            });

            // Toggle all column rows
            document.querySelectorAll('.column-row').forEach(row => {
                if (allExpanded) {
                    row.classList.add('expanded');
                } else {
                    row.classList.remove('expanded');
                }
            });

            // Toggle all <details> elements
            document.querySelectorAll('details').forEach(details => {
                details.open = allExpanded;
            });

            // Toggle all technical sections
            document.querySelectorAll('.insight-technical').forEach(section => {
                if (allExpanded) {
                    section.classList.add('open');
                } else {
                    section.classList.remove('open');
                }
            });

            // Toggle all section accordions
            document.querySelectorAll('.section-accordion').forEach(section => {
                if (allExpanded) {
                    section.classList.add('expanded');
                } else {
                    section.classList.remove('expanded');
                }
            });

            // Toggle plain/tech view sections
            document.querySelectorAll('.plain-view, .tech-view').forEach(view => {
                view.style.display = allExpanded ? 'block' : '';
            });
        }

        // ======================================================
        // PDF EXPORT
        // ======================================================
        function exportToPDF() {
            const btn = document.getElementById('exportPdfBtn');
            const originalText = btn.innerHTML;

            // Show loading state
            btn.classList.add('exporting');
            btn.innerHTML = '<span class="pdf-icon">⏳</span> Preparing...';

            // First, expand all sections to ensure nothing is hidden
            // Expand all accordions (remove 'collapsed' class to show content)
            document.querySelectorAll('.accordion').forEach(acc => {
                acc.classList.remove('collapsed');
            });

            // Expand all column rows
            document.querySelectorAll('.column-row').forEach(row => {
                row.classList.add('expanded');
            });

            // Open all <details> elements
            document.querySelectorAll('details').forEach(details => {
                details.open = true;
            });

            // Expand all technical sections
            document.querySelectorAll('.insight-technical').forEach(section => {
                section.classList.add('open');
            });

            // Expand all section accordions
            document.querySelectorAll('.section-accordion').forEach(section => {
                section.classList.add('expanded');
            });

            // Switch all dual-view tabs to show both Plain English content
            // (Technical is still available in print via CSS)
            document.querySelectorAll('.plain-view').forEach(view => {
                view.style.display = 'block';
            });
            document.querySelectorAll('.tech-view').forEach(view => {
                view.style.display = 'block';
            });

            // Update expand button state
            const expandBtn = document.getElementById('expandAllBtn');
            allExpanded = true;
            expandBtn.classList.add('expanded');
            expandBtn.innerHTML = '<span class="expand-icon">-</span> Collapse All';

            // Small delay to let DOM update, then trigger print
            setTimeout(() => {
                // Create print-specific styles
                const printStyle = document.createElement('style');
                printStyle.id = 'pdf-print-style';
                printStyle.textContent = `
                    @media print {
                        * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                        body { background: white !important; }
                        .page { max-width: none !important; padding: 20px !important; }
                        .accordion-content { display: block !important; max-height: none !important; }
                        .column-details { display: block !important; max-height: none !important; }
                        .insight-technical { display: block !important; max-height: none !important; }
                        .plain-view, .tech-view { display: block !important; }
                        .dual-view-tabs { display: none !important; }
                        .nav-btn, .expand-all-btn, .export-pdf-btn { display: none !important; }
                        canvas { max-width: 100% !important; height: auto !important; }
                    }
                `;
                document.head.appendChild(printStyle);

                // Trigger print dialog (saves as PDF)
                window.print();

                // Clean up after print
                setTimeout(() => {
                    const style = document.getElementById('pdf-print-style');
                    if (style) style.remove();

                    // Restore button
                    btn.classList.remove('exporting');
                    btn.innerHTML = originalText;
                }, 500);
            }, 300);
        }

        // ======================================================
        // SIDEBAR NAVIGATION
        // ======================================================
        const sidebar = document.getElementById('dqSidebar');
        const backdrop = document.getElementById('sidebarBackdrop');
        const navLinks = document.querySelectorAll('.dq-nav-link');

        // Section IDs mapped to navigation
        const sections = {
            'overview': document.getElementById('section-overview') || document.getElementById('section-summary'),
            'engine': document.getElementById('section-engine'),
            'structure': document.getElementById('section-structure'),
            'columns': document.getElementById('section-columns'),
            'distributions': document.getElementById('section-distributions'),
            'missingness': document.getElementById('section-missingness'),
            'anomalies': document.getElementById('section-anomalies'),
            'temporal': document.getElementById('section-temporal'),
            'correlations': document.getElementById('section-correlations'),
            'validations': document.getElementById('section-validations'),
            'yaml': document.getElementById('section-yaml'),
            'nextsteps': document.getElementById('section-nextsteps'),
            'glossary': document.getElementById('section-glossary')
        };

        // Toggle sidebar for mobile
        function toggleSidebar() {
            sidebar.classList.toggle('open');
            backdrop.classList.toggle('open');
        }

        // Close sidebar on mobile when clicking a link
        function closeSidebarOnMobile() {
            if (window.innerWidth <= 1024) {
                sidebar.classList.remove('open');
                backdrop.classList.remove('open');
            }
        }

        // Handle nav link clicks
        navLinks.forEach(link => {
            link.addEventListener('click', function() {
                const sectionId = this.dataset.section;
                const section = sections[sectionId];

                // Update active state
                navLinks.forEach(l => l.classList.remove('active'));
                this.classList.add('active');

                if (section) {
                    // Calculate offset for mobile (account for mobile toggle button)
                    const isMobile = window.innerWidth <= 1024;
                    const offset = isMobile ? 70 : 20; // Mobile needs more offset for floating button

                    // Smooth scroll with offset
                    const targetPosition = section.getBoundingClientRect().top + window.pageYOffset - offset;
                    window.scrollTo({
                        top: targetPosition,
                        behavior: 'smooth'
                    });
                }

                closeSidebarOnMobile();
            });
        });

        // Update nav on scroll (highlight active section)
        let scrollTimeout;
        window.addEventListener('scroll', function() {
            clearTimeout(scrollTimeout);
            scrollTimeout = setTimeout(function() {
                let currentSection = 'overview';
                const scrollPos = window.scrollY + 150;

                for (const [name, el] of Object.entries(sections)) {
                    if (el && el.offsetTop <= scrollPos) {
                        currentSection = name;
                    }
                }

                navLinks.forEach(link => {
                    link.classList.toggle('active', link.dataset.section === currentSection);
                });
            }, 50);
        });

        // ======================================================
        // COLUMN SEARCH AND FILTER
        // ======================================================
        let currentFilter = 'all';
        let currentSort = 'name';

        function filterColumns() {
            const query = document.getElementById('columnSearch')?.value?.toLowerCase() || '';
            const rows = document.querySelectorAll('.column-row');

            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                const type = row.dataset?.type || '';
                const hasIssues = row.dataset?.issues === 'true';

                // Apply text search
                let showBySearch = !query || text.includes(query);

                // Apply filter
                let showByFilter = true;
                switch(currentFilter) {
                    case 'issues':
                        showByFilter = hasIssues;
                        break;
                    case 'numeric':
                        showByFilter = ['integer', 'float'].includes(type);
                        break;
                    case 'string':
                        showByFilter = type === 'string';
                        break;
                    case 'date':
                        showByFilter = ['date', 'datetime'].includes(type);
                        break;
                    default:
                        showByFilter = true;
                }

                row.style.display = (showBySearch && showByFilter) ? '' : 'none';
            });
        }

        function filterByType(type) {
            currentFilter = type;

            // Update button states
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.toggle('active', btn.textContent.toLowerCase().includes(type) ||
                    (type === 'all' && btn.textContent === 'All'));
            });

            filterColumns();
        }

        function sortColumns() {
            const sortBy = document.getElementById('columnSort')?.value || 'name';
            currentSort = sortBy;

            const container = document.querySelector('.column-explorer .accordion-content');
            if (!container) return;

            const rows = Array.from(container.querySelectorAll('.column-row'));

            rows.sort((a, b) => {
                switch(sortBy) {
                    case 'quality':
                        return parseFloat(b.dataset?.quality || 0) - parseFloat(a.dataset?.quality || 0);
                    case 'completeness':
                        return parseFloat(b.dataset?.completeness || 0) - parseFloat(a.dataset?.completeness || 0);
                    case 'issues':
                        const aIssues = a.dataset?.issues === 'true' ? 1 : 0;
                        const bIssues = b.dataset?.issues === 'true' ? 1 : 0;
                        return bIssues - aIssues;
                    default:
                        return (a.dataset?.name || '').localeCompare(b.dataset?.name || '');
                }
            });

            rows.forEach(row => container.appendChild(row));
        }

        // ======================================================
        // EXPORT ANOMALIES TO CSV
        // ======================================================
        function exportAnomalies() {
            // Gather all issues from the report
            const issues = [];

            // Collect column issues
            document.querySelectorAll('.column-row').forEach(row => {
                const colName = row.dataset?.name || 'Unknown';
                const quality = row.dataset?.quality || 'N/A';
                row.querySelectorAll('.issue-item, .alert-item').forEach(issue => {
                    issues.push({
                        column: colName,
                        quality_score: quality,
                        issue_type: 'Column Issue',
                        description: issue.textContent.trim()
                    });
                });
            });

            // Collect ML findings
            document.querySelectorAll('.ml-finding-card').forEach(card => {
                const title = card.querySelector('.finding-title')?.textContent || 'ML Finding';
                card.querySelectorAll('.anomaly-item, .alert-text').forEach(item => {
                    issues.push({
                        column: 'ML Analysis',
                        quality_score: 'N/A',
                        issue_type: title,
                        description: item.textContent.trim()
                    });
                });
            });

            // Collect alerts
            document.querySelectorAll('.alert-badge').forEach(alert => {
                issues.push({
                    column: 'Alert',
                    quality_score: 'N/A',
                    issue_type: alert.classList.contains('critical') ? 'Critical' :
                               alert.classList.contains('warning') ? 'Warning' : 'Info',
                    description: alert.textContent.trim()
                });
            });

            if (issues.length === 0) {
                alert('No issues found to export.');
                return;
            }

            // Generate CSV
            const headers = ['Column', 'Quality Score', 'Issue Type', 'Description'];
            const csvRows = [headers.join(',')];

            issues.forEach(issue => {
                const row = [
                    '"' + (issue.column || '').replace(/"/g, '""') + '"',
                    issue.quality_score,
                    '"' + (issue.issue_type || '').replace(/"/g, '""') + '"',
                    '"' + (issue.description || '').replace(/"/g, '""') + '"'
                ];
                csvRows.push(row.join(','));
            });

            const csvContent = csvRows.join('\n');

            // Download CSV
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'data_quality_issues.csv';
            link.click();

            // Update button to show success
            const btn = event?.target;
            if (btn) {
                const originalText = btn.textContent;
                btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:12px;height:12px;vertical-align:-1px"><polyline points="20 6 9 17 4 12"/></svg> Exported!';
                btn.style.background = '#10b981';
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '';
                }, 1500);
            }
        }

        // ======================================================
        // HEATMAP CLICK TO SCROLL
        // ======================================================
        document.querySelectorAll('.heatmap-cell').forEach(cell => {
            cell.addEventListener('click', function() {
                const colName = this.title.split(':')[0];
                const row = document.querySelector(`.column-row[data-name="${colName}"]`);
                if (row) {
                    row.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    row.classList.add('expanded');
                    setTimeout(() => row.style.outline = '2px solid var(--accent)', 300);
                    setTimeout(() => row.style.outline = '', 1500);
                }
            });
        });

        // Copy YAML to clipboard
        function copyYaml(yamlContent) {
            navigator.clipboard.writeText(yamlContent).then(() => {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:12px;height:12px;vertical-align:-1px"><polyline points="20 6 9 17 4 12"/></svg> Copied!';
                btn.style.background = '#10b981';
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '';
                }, 1500);
            });
        }

        // Copy full config to clipboard
        function copyFullConfig() {
            const yamlEl = document.getElementById('fullConfigYaml');
            if (yamlEl) {
                navigator.clipboard.writeText(yamlEl.textContent).then(() => {
                    const btn = event.target;
                    const originalText = btn.textContent;
                    btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:12px;height:12px;vertical-align:-1px"><polyline points="20 6 9 17 4 12"/></svg> Copied!';
                    setTimeout(() => {
                        btn.textContent = originalText;
                    }, 1500);
                });
            }
        }

        // Initialize charts when library is ready
        function initCharts() {
            if (typeof Chart === 'undefined') {
                setTimeout(initCharts, 100);
                return;
            }

            // Chart defaults
            const chartDefaults = {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
                legend: {
                    labels: {
                        color: '#94a3b8',
                        font: { size: 11 }
                    }
                }
            }
        };

        // Type Distribution Chart
        new Chart(document.getElementById('typeChart'), {
            type: 'doughnut',
            data: {
                labels: ["String (3)", "Float (1)"],
                datasets: [{
                    data: [3, 1],
                    backgroundColor: [
                        'rgba(139, 92, 246, 0.8)',
                        'rgba(59, 130, 246, 0.8)',
                        'rgba(16, 185, 129, 0.8)',
                        'rgba(245, 158, 11, 0.8)',
                        'rgba(239, 68, 68, 0.8)'
                    ],
                    borderColor: 'transparent',
                    borderWidth: 0
                }]
            },
            options: {
                ...chartDefaults,
                cutout: '65%',
                plugins: {
                    legend: {
                        position: 'right',
                        labels: { color: '#94a3b8', padding: 16 }
                    }
                }
            }
        });

        // Quality by Column Chart
        new Chart(document.getElementById('qualityChart'), {
            type: 'bar',
            data: {
                labels: ["transactio", "customer_i", "amount", "status"],
                datasets: [{
                    label: 'Quality Score',
                    data: [100.0, 99.4, 88.39999999999999, 80.02000000000001],
                    backgroundColor: function(context) {
                        const value = context.raw;
                        if (value >= 80) return 'rgba(16, 185, 129, 0.8)';
                        if (value >= 70) return 'rgba(59, 130, 246, 0.8)';
                        if (value >= 60) return 'rgba(245, 158, 11, 0.8)';
                        return 'rgba(239, 68, 68, 0.8)';
                    },
                    borderRadius: 4
                }]
            },
            options: {
                ...chartDefaults,
                plugins: { legend: { display: false } },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100,
                        grid: { color: 'rgba(148, 163, 184, 0.1)' },
                        ticks: {
                            color: '#64748b',
                            callback: value => value + '%'
                        }
                    },
                    x: {
                        grid: { display: false },
                        ticks: {
                            color: '#64748b',
                            maxRotation: 45,
                            font: { size: 9 }
                        }
                    }
                }
            }
        });

        // Bubble Chart - with padding to prevent overflow
        new Chart(document.getElementById('bubbleChart'), {
            type: 'bubble',
            data: {
                datasets: [{
                    label: 'Columns',
                    data: [{"x": 100.0, "y": 100.0, "r": 5, "label": "transaction_id"}, {"x": 100.0, "y": 100.0, "r": 5, "label": "customer_id"}, {"x": 93.0, "y": 100.0, "r": 5, "label": "amount"}, {"x": 0.1, "y": 100.0, "r": 5, "label": "status"}],
                    backgroundColor: function(context) {
                        const y = context.raw?.y;
                        if (!y) return 'rgba(148, 163, 184, 0.5)';
                        if (y >= 95) return 'rgba(16, 185, 129, 0.6)';
                        if (y >= 90) return 'rgba(59, 130, 246, 0.6)';
                        return 'rgba(245, 158, 11, 0.6)';
                    },
                    // Limit bubble radius to prevent overflow
                    radius: function(context) {
                        const r = context.raw?.r;
                        return Math.min(r || 5, 25);  // Cap at 25px radius
                    }
                }]
            },
            options: {
                ...chartDefaults,
                responsive: true,
                maintainAspectRatio: true,
                layout: {
                    padding: { top: 20, right: 20, bottom: 10, left: 10 }  // Padding for bubbles
                },
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.raw.label + ': ' + context.raw.y + '% validity';
                            }
                        }
                    }
                },
                scales: {
                    x: {
                        title: { display: true, text: 'Uniqueness %', color: '#64748b' },
                        min: Math.max(0, Math.min(...[100.0, 100.0, 93.0, 0.1]) - 10),
                        max: 105,
                        grid: { color: 'rgba(148, 163, 184, 0.1)' },
                        ticks: { color: '#64748b' }
                    },
                    y: {
                        title: { display: true, text: 'Validity %', color: '#64748b' },
                        min: Math.max(0, Math.min(...[100.0, 100.0, 100.0, 100.0]) - 10),
                        max: 105,
                        grid: { color: 'rgba(148, 163, 184, 0.1)' },
                        ticks: { color: '#64748b' }
                    }
                }
            }
        });
        } // end initCharts

        // Call initCharts when page is ready
        if (document.readyState === 'complete') {
            initCharts();
        } else {
            window.addEventListener('load', initCharts);
        }

        // Collapse all accordions after page load (Safari-friendly: render first, then collapse)
        function collapseAllAccordions() {
            document.querySelectorAll('.accordion').forEach(acc => {
                acc.classList.add('collapsed');
            });
            document.querySelectorAll('.insight-widget').forEach(widget => {
                widget.classList.add('collapsed');
            });
        }
        // Run after DOM is ready but content has rendered
        if (document.readyState === 'complete') {
            setTimeout(collapseAllAccordions, 100);
        } else {
            window.addEventListener('load', () => setTimeout(collapseAllAccordions, 100));
        }

        // Word Cloud - wait for library to load
        function initWordCloud() {
            const wordCloudContainer = document.getElementById('wordCloudContainer');
            if (!wordCloudContainer) return;

            if (typeof WordCloud === 'undefined') {
                // Library not loaded yet, retry in 100ms
                setTimeout(initWordCloud, 100);
                return;
            }

            const wordCloudData = [["COMPLETED", 1000]];
            if (wordCloudData.length > 0) {
                // Get container dimensions for better sizing
                const containerWidth = wordCloudContainer.offsetWidth || 500;
                const containerHeight = wordCloudContainer.offsetHeight || 350;

                // Normalize weights to a reasonable range for display
                const maxWeight = Math.max(...wordCloudData.map(w => w[1]));
                const minWeight = Math.min(...wordCloudData.map(w => w[1]));
                const range = maxWeight - minWeight || 1;
                const normalizedData = wordCloudData.map(w => [
                    w[0],
                    ((w[1] - minWeight) / range) * 100 + 10  // Scale 10-110 for better distribution
                ]);

                WordCloud(wordCloudContainer, {
                    list: normalizedData,
                    gridSize: Math.max(2, Math.floor(containerWidth / 100)),  // Dynamic grid based on width
                    weightFactor: function(size) {
                        // Dynamic sizing based on container, better space utilization
                        const baseSize = Math.min(containerWidth, containerHeight) / 12;
                        return Math.max(12, (size / 100) * baseSize);
                    },
                    fontFamily: 'system-ui, -apple-system, sans-serif',
                    color: function(word, weight) {
                        if (weight > 80) return '#8b5cf6';
                        if (weight > 50) return '#60a5fa';
                        if (weight > 25) return '#10b981';
                        return '#94a3b8';
                    },
                    backgroundColor: 'transparent',
                    rotateRatio: 0.3,  // Slightly more rotation for better packing
                    rotationSteps: 3,
                    shuffle: true,
                    drawOutOfBound: false,
                    shrinkToFit: true,
                    minSize: 10,  // Minimum font size
                    ellipticity: 0.8  // Slightly elliptical for better horizontal fit
                });
            }
        }
        // Initialize word cloud after page load
        if (document.readyState === 'complete') {
            initWordCloud();
        } else {
            window.addEventListener('load', initWordCloud);
        }

    </script>
</body>
</html>